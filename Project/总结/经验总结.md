# ä¸€ã€experience

# ğŸ§¨ğŸ§¨JavaEEğŸ§¨ğŸ§¨

# ğŸˆğŸˆç»éªŒæ€»ç»“ğŸˆğŸˆ

## 1ã€ç±»ä¸å¯¹è±¡

- ç±»æ˜¯å¯¹äº‹åŠ¡æ™®éçŠ¶æ€å’Œè¡Œä¸ºçš„æŠ½è±¡
- å¯¹è±¡æ˜¯å¯¹æŠ½è±¡ç»“æœçš„å…·ä½“è¡¨ç°çš„ä¸€ä¸ªå®ä¾‹
- ç±»å¯ä»¥å½“æˆä¸€ä¸ªæ¨¡ç‰ˆï¼Œåˆ›å»ºå‡ºå¾ˆå¤šå±æ€§å’Œè¡Œä¸ºä¸Šæœ‰å·®åˆ«çš„å®ä¾‹



## 2ã€å°è£…

å°è£…å°±æ˜¯æŠŠè¿‘ä¼¼çš„å†…å®¹é›†æˆåœ¨ä¸€èµ·ï¼Œå¯¹å¤–æä¾›æœåŠ¡å’Œæ•°æ®



## 3ã€ç»§æ‰¿

ç»§æ‰¿ç”¨æ¥åšç±»å‹æ‰©å±•çš„ï¼Œæ‰©å±•ç±»ä¸ä»…å¯ä»¥è·å¾—åŸæ¥ç±»çš„ç‰¹æ€§ï¼Œè¿˜èƒ½æ‰©å±•è‡ªå·±çš„ç‰¹æ€§



## 4ã€å­ç±»å’Œçˆ¶ç±»ä¹‹é—´æ„é€ æ–¹æ³•

1.

| æƒ…å†µ | çˆ¶ç±» | å­ç±» | è¾“å‡ºæƒ…å†µ       |
| ---- | ---- | ---- | -------------- |
| æ— å‚ | âœ”    | âœ”    | å…ˆè¾“å‡ºçˆ¶ç±»æ— å‚ |
| æœ‰å‚ |      |      | å†è¾“å‡ºå­ç±»æ— å‚ |

2.

| æƒ…å†µ | çˆ¶ç±» | å­ç±» | è¾“å‡ºæƒ…å†µ       |
| ---- | ---- | ---- | -------------- |
| æ— å‚ | âœ”    |      | å…ˆè¾“å‡ºçˆ¶ç±»æ— å‚ |
| æœ‰å‚ |      | âœ”    | å†è¾“å‡ºå­ç±»æœ‰å‚ |

3.

| æƒ…å†µ | çˆ¶ç±» | å­ç±» | è¾“å‡ºæƒ…å†µ                  |
| ---- | ---- | ---- | ------------------------- |
| æ— å‚ |      | âœ”    | æŠ¥é”™                      |
| æœ‰å‚ | âœ”    |      | æ”¹é”™æ–¹å¼ï¼š1ã€åˆ›å»ºçˆ¶ç±»æ— å‚ |

~~~java
æ”¹é”™æ–¹å¼2ã€åœ¨å­ç±»æ— å‚æ„é€ é‡Œé¢ä½¿ç”¨çˆ¶ç±»æœ‰å‚
    class Super{
        public Super(int i){}
    }
    class Sub extends Super{
        public Sub(){
            super(10);
        }
    }
~~~



4.

| æƒ…å†µ | çˆ¶ç±» | å­ç±» | è¾“å‡ºæƒ…å†µ       |
| ---- | ---- | ---- | -------------- |
| æ— å‚ |      |      | å…ˆè¾“å‡ºçˆ¶ç±»æœ‰å‚ |
| æœ‰å‚ | âœ”    | âœ”    | å†è¾“å‡ºå­ç±»æœ‰å‚ |

5.

| æƒ…å†µ | çˆ¶ç±» | å­ç±» | è¾“å‡ºæƒ…å†µ       |
| ---- | ---- | ---- | -------------- |
| æ— å‚ | âœ”    | âœ”    | å…ˆè¾“å‡ºçˆ¶ç±»æ— å‚ |
| æœ‰å‚ | âœ”    |      | å†è¾“å‡ºå­ç±»æ— å‚ |

6.

| æƒ…å†µ | çˆ¶ç±» | å­ç±»                        | è¾“å‡ºæƒ…å†µ       |
| ---- | ---- | --------------------------- | -------------- |
| æ— å‚ | âœ”    |                             | å…ˆè¾“å‡ºçˆ¶ç±»æ— å‚ |
| æœ‰å‚ | âœ”    | âœ”ï¼ˆæ— superæˆ–è€…æœ‰superï¼ˆï¼‰ï¼‰ | å†è¾“å‡ºå­ç±»æœ‰å‚ |

6.

| æƒ…å†µ | çˆ¶ç±»       | å­ç±»              | è¾“å‡ºæƒ…å†µ       |
| ---- | ---------- | ----------------- | -------------- |
| æ— å‚ | âœ”          |                   | å…ˆè¾“å‡ºçˆ¶ç±»æœ‰å‚ |
| æœ‰å‚ | âœ”ï¼ˆint iï¼‰ | âœ”ï¼ˆæœ‰superï¼ˆiï¼‰ï¼‰ | å†è¾“å‡ºå­ç±»æœ‰å‚ |

7.

| æƒ…å†µ | çˆ¶ç±» | å­ç±» | è¾“å‡ºæƒ…å†µ         |
| ---- | ---- | ---- | ---------------- |
| æ— å‚ | âœ”    | âœ”    | ç»¼åˆä¸Šè¿°         |
| æœ‰å‚ | âœ”    | âœ”    | è§†ä½¿ç”¨æƒ…å†µè€Œè¾“å‡º |



## 5ã€çˆ¶å­ç±»ä¸­å„ä¸ªèµ„æºçš„åˆå§‹åŒ–é¡ºåº 

 é™æ€ä¼˜å…ˆï¼Œç„¶åæ˜¯çˆ¶ç±»å‹ä¼˜å…ˆ

```java
// 1ã€çˆ¶äº²çš„é™æ€å±æ€§ (1)
// 2ã€å­ç±»çš„é™æ€å±æ€§ (1)
// 3ã€åˆå§‹åŒ–çˆ¶äº²ä¸­çš„å±æ€§
// 4ã€æ„é€ çˆ¶äº²å®ä¾‹
// 5ã€åˆå§‹åŒ–å­ç±»ä¸­çš„å±æ€§
// 6ã€æ„é€ å­ç±»å®ä¾‹
```


## 6ã€å­ç±»å’Œçˆ¶ç±»ä¸­è°ƒç”¨æ–¹æ³•çš„é¡ºåº

```java
Super s=new Super();	//çˆ¶ç±»
Sub b=new Sub();		//å­ç±»
```

- é‡‡ç”¨**å°±è¿‘åŸåˆ™**
- æ³¨æ„ï¼šçˆ¶ç±»çš„é™æ€æ–¹æ³•ä¸èƒ½è¢«å­ç±»é‡å†™ï¼Œåªå¯ä»¥ç»§æ‰¿ï¼Œå³ä½¿å­ç±»ä¸­çš„é™æ€æ–¹æ³•ä¸çˆ¶ç±»ä¸­çš„é™æ€æ–¹æ³•å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ–¹æ³•
- åˆ›å»ºçš„å¯¹è±¡æ˜¯å­ç±»æ—¶ï¼Œçˆ¶ç±»å’Œå­ç±»éƒ½æœ‰è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå°±ç”¨å­ç±»çš„æ–¹æ³•
- åˆ›å»ºçš„å¯¹è±¡æ˜¯å­ç±»æ—¶ï¼Œçˆ¶ç±»æœ‰è¯¥æ–¹æ³•ï¼Œå­ç±»æ²¡æœ‰ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•
- åˆ›å»ºçš„å¯¹è±¡æ˜¯çˆ¶ç±»æ—¶ï¼Œåªèƒ½ä½¿ç”¨çˆ¶ç±»çš„æ–¹æ³•



## 7ã€å¤šæ€

- å¤šæ€

  > ç®€å•åœ°è¯´å°±æ˜¯ï¼šçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘äº†å­ç±»å¯¹è±¡ï¼Œæ¥å£çš„å¼•ç”¨æŒ‡å‘äº†å…¶æ¥å£çš„å®ç°ç±»å¯¹è±¡
  >
  > - **ä¸€ä¸ªè¡Œä¸ºï¼Œåœ¨ä¸åŒæ¡ä»¶ä¸‹ï¼Œæœ‰ä¸åŒçš„æ‰§è¡Œæ•ˆæœ**
  > - åœ¨å®šä¹‰æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå‚æ•°ç±»å‹å®šä¹‰çš„æ›´ä¸ºæŠ½è±¡ä¸€äº›ï¼Œè¿™æ ·å®ƒå°±èƒ½æ¥å—æ‰€æœ‰çš„è‡ªç±»å‹å®ä¾‹ï¼Œä»¥æ­¤æ¥æé«˜ç¨‹åºçš„å…¼å®¹æ€§
  > - è¡¨ç°ï¼šé‡å†™æ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ï¼Œé‡è½½æ˜¯ä¸€ç±»ä¸­å¤šæ€æ€§çš„è¡¨ç°

- **å¤šæ€çš„ä¸‰å¤§å¿…è¦æ¡ä»¶ï¼ˆå®ç°ï¼‰**

  1.éœ€è¦æœ‰ç»§æ‰¿ï¼ˆç»§æ‰¿ç±»ï¼Œç»§æ‰¿æŠ½è±¡ç±»ï¼Œå®ç°æ¥å£ï¼‰
  2.éœ€è¦æœ‰é‡å†™
  3.çˆ¶ç±»å‹çš„å¼•ç”¨æ‰§è¡Œå­ç±»å‹



- **èƒ½åšä»€ä¹ˆçœ‹å·¦è¾¹ï¼Œå…·ä½“åšä»€ä¹ˆçœ‹å³è¾¹**
  - çˆ¶ç±»ä¸­æœ‰è€Œå­ç±»æ²¡æœ‰çš„æ–¹æ³•ï¼Œä½¿ç”¨çˆ¶ç±»
  - çˆ¶ç±»å’Œå­ç±»éƒ½æœ‰è¯¥æ–¹æ³•æ—¶ï¼Œä½¿ç”¨å­ç±»é‡å†™çš„æ–¹æ³•



- **ä½¿ç”¨åœºæ™¯**

1ã€é€šè¿‡æ–¹æ³•çš„å‚æ•°ä¼ é€’å½¢æˆå¤šæ€

~~~java
public static void draw(Super s){    
    s.show(); 
} 
draw(new Sub); 
~~~

2ã€çˆ¶ç±»å‹å¼•ç”¨æ‰§è¡Œå­ç±»å‹

~~~java
Super s=new Sub();
~~~

3ã€é€šè¿‡æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å½¢æˆå¤šæ€

~~~java
public static Super draw(){    
    retrun new Sub; 
} 
Super s=Super.draw();
~~~



- åŒä¸€ä¸ªç±»ä¸­è¿›è¡Œæ–¹æ³•é‡è½½

  > æ–¹æ³•çš„é‡è½½ï¼šéœ€å‚æ•°ä¸åŒã€å‚æ•°ä¸ªæ•°ä¸åŒ

~~~java
public void init(String name,int i){
        
}
    
public void init(int i,String name){
        
}
    
public void init(){
        
}
    
public int init(){
        
}
~~~





## 8ã€å­¦ç”Ÿç³»ç»Ÿç»“æ„åˆ†æ

Main	--ä¸»å‡½æ•°å…¥å£

StudentManager	--ç®¡å®¶å©†ï¼šå®šä¸ºå±äºé«˜å±‚ç®¡ç†ï¼Œä¸»è¦è´Ÿè´£å®‰æ’å’Œåè°ƒå·¥ä½œçš„

StudentContainerã€Console	--æ§åˆ¶å°ã€æ•°æ®å®¹å™¨ï¼šä¸­å±‚ç®¡ç†ï¼Œæä¾›ç‰¹å®šçš„æœåŠ¡ã€æ•°æ®ï¼Œè¿™ä¸¤è€…éƒ½ç›´æ¥ä¸ç®¡å®¶å©†å¯¹æ¥

è‡ªæˆ‘æ„Ÿè§‰ï¼šç²¾ç›Šæ±‚ç²¾ï¼Œå…ˆåˆ—å‡ºStudentManageråˆ—å‡ºå¤§æ¦‚æ­¥éª¤ï¼Œå†é€šè¿‡ä¸‹å±‚å®ç°å…·ä½“æ–¹æ³•



## 9ã€ç±»å‹å‡†æ¢

- ä¸»è¦åˆ†ä¸ºå‘ä¸Šï¼ˆè‡ªåŠ¨ï¼‰å’Œå‘ä¸‹è½¬å‹ï¼ˆéœ€è¦åœ¨å˜é‡å‰é¢åŠ ä»¥ç±»å‹ä¿®é¥°ï¼‰

  ~~~java
  //å­ç±»è½¬çˆ¶ç±»(å‘ä¸Šè½¬å‹)
  Sub a=new Sub();
  Super s=a;
  //çˆ¶ç±»è½¬å­ç±»(å‘ä¸‹è½¬å‹)
  Super a=new Super();
  Sub b=(Sub)a;
  ~~~

  

- å¯¹äºåŸºæœ¬ç±»å‹è€Œè¨€ï¼Œæ¯”å¦‚æ•°å­—ï¼Œå¯ä»¥æŠŠé•¿åº¦å°çš„ç±»å‹è‡ªåŠ¨è½¬æ¢æˆé•¿åº¦å¤§çš„ï¼Œç›¸åï¼Œé•¿åº¦å¤§çš„ä¹Ÿå¯ä»¥å¼ºåˆ¶ç±»å‹è½¬åŒ–ä¸ºé•¿åº¦å°çš„

  ~~~java
  byte(1å­—èŠ‚)->short(2å­—èŠ‚)->int(4å­—èŠ‚)->long(8å­—èŠ‚)->float(4å­—èŠ‚)->double(8å­—èŠ‚)
      	^
      	|
         char(2å­—èŠ‚)
  ~~~

  

- å½“æŠŠå­ç±»å‹è½¬æ¢ä¸ºçˆ¶ç±»å‹çš„æ—¶å€™ï¼Œè¿™ä¸ªå®ä¾‹çš„è¡Œä¸ºä¼šå˜æˆå®ƒåªèƒ½è°ƒç”¨çˆ¶ç±»å‹å£°æ˜çš„é‚£äº›æ–¹æ³•ï¼ˆèƒ½åšä»€ä¹ˆçœ‹å·¦è¾¹çš„ç±»å‹ï¼Œå…·ä½“æ€ä¹ˆåšï¼Œçœ‹å³è¾¹æ˜¯ä»€ä¹ˆæ ·çš„å®ä¾‹ï¼‰

  - ç”¨æ³•ç±»ä¼¼å¦‚å¤šæ€

  

- å˜é‡å instanceof ç±»å‹ï¼šå‰è€…æ˜¯åè€…è¿™ä¸ªç±»å‹çš„ä¸€ä¸ªå®ä¾‹å—ï¼Ÿ

~~~java
Super n=new Sub();
 n instanceof Sub	ç»“æœï¼štrue
~~~



## 10ã€å¦‚ä½•æ¯”è¾ƒå¯¹è±¡

- å¦‚ä½•æ¯”è¾ƒå¯¹è±¡
  - ==ç”¨æ¥æ¯”è¾ƒä¸¤è€…çš„åœ°å€(å¼•ç”¨)ï¼ŒåŸºæœ¬ç±»å‹ç›´æ¥æ¯”è¾ƒå€¼
  - æˆ‘ä»¬å¦‚æœè¦å®ç°"å½“è¿™ä¸ªå¯¹è±¡ä¸­æŸäº›ä¸ªå±æ€§å€¼ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡"ï¼Œå¯ä»¥ä½¿ç”¨equals
  - é‡å†™Objectçš„equalsæ–¹æ³•ï¼ˆé»˜è®¤æ¯”è¾ƒçš„æ˜¯åœ°å€ï¼‰
  - æ¯”å¦‚ç”¨æˆ·åœ¨æ³¨å†Œè®ºå›çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åå°çš„Userä¸­ï¼Œå¢åŠ æ‰‹æœºå·ç  + æ€§åˆ« + ç”¨æˆ·å



## 11ã€staticä¿®é¥°ç¬¦çš„ä½¿ç”¨	

- ä¿®é¥°å˜é‡ï¼šstaticä¿®é¥°çš„å˜é‡ä¸ä¾èµ–ç±»çš„å®ä¾‹è€Œå­˜åœ¨ï¼Œä¸€èˆ¬ç›´æ¥é€šè¿‡ç±»åè¿›è¡Œè°ƒç”¨ï¼Œå®ƒæ˜¯è¿™ä¸ªç±»çš„å®ä¾‹æ‰€æœ‰å…±æœ‰çš„ï¼ˆå®ƒåªæœ‰ä¸€ä»½ï¼‰

  ~~~java
  å¦‚ï¼špublic static int a=5ï¼›
  
  ä¼šåœ¨å†…å­˜ä¸­åªå¼€è¾Ÿä¸€ä¸ªç©ºé—´ï¼Œè¡¨åè¿™æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä¸ä¼šå†åˆ›å»ºæ–°çš„ç©ºé—´ï¼Œstaticä¿®é¥°çš„intç­‰ç±»å‹çš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚
  ~~~

- ä¿®é¥°æ–¹æ³•ï¼šé™æ€æ–¹æ³•åªèƒ½å¼•ç”¨é™æ€å˜é‡å’Œé™æ€æ–¹æ³•

- **staticä¸€èˆ¬éƒ½"åªæ‰§è¡Œä¸€æ¬¡"æˆ–è€…"åªæœ‰ä¸€ä»½"**

- é™æ€ä»£ç å—ï¼šåªæ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”æ—¶é—´ç‚¹åœ¨æ„é€ å™¨ä¹‹å‰ï¼Œåœ¨é™æ€å±æ€§åˆå§‹åŒ–ä¹‹å



## 12ã€finalä¿®é¥°ç¬¦çš„ä½¿ç”¨

- è¢«finalä¿®é¥°çš„å˜é‡ï¼Œå…·æœ‰"ä¸å¯æ”¹å˜"çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨æ„é€ å™¨ä¸­è¿›è¡Œç¬¬ä¸€æ¬¡**èµ‹å€¼åˆå§‹åŒ–**,**å¿…é¡»å¯¹æ¯ä¸ªæ„é€ å™¨(æ— å‚å’Œæœ‰å‚)é‡Œé¢è¿›è¡ŒåŒæ ·çš„èµ‹å€¼æ“ä½œ**

- ä¿®é¥°åŸºæœ¬ç±»å‹ï¼šå…¶å€¼ä¸å¯ä»¥å†è¿›è¡Œä¿®æ”¹

- ä¿®é¥°å¼•ç”¨ç±»å‹ï¼šå¯ä»¥æ”¹ - åœ°å€æ²¡æœ‰å˜ï¼ˆä½†å‡¡æ˜¯newäº†ï¼Œåœ°å€ä¸€å®šæ”¹å˜äº†ï¼Œå¦‚æœé€šè¿‡setterè¿›è¡Œä¿®æ”¹ï¼Œåœ°å€æ²¡æœ‰æ”¹å˜ï¼‰

  ~~~java
  MyClass m=new MyClass();
  m=new Myclass;
  ç»“æœï¼šæŠ¥é”™
  ~~~

- ä¿®é¥°ç±»ï¼šè¿™æ˜¯è¿™ä¸ªç±»çš„æœ€ç»ˆç‰ˆï¼Œä¸èƒ½è¢«æ‰©å±•å’Œç»§æ‰¿

- ä¿®é¥°æ–¹æ³•ï¼šè¿™æ˜¯è¿™ä¸ªæ–¹æ³•çš„æœ€ç»ˆç‰ˆï¼Œä¸èƒ½è¢«é‡å†™



## 13ã€abstractä¿®é¥°ç¬¦çš„ä½¿ç”¨

- ä¿®é¥°ç±»ï¼šå¯¹äºabstractæ–¹æ³•ï¼Œåªå…è®¸å£°æ˜ï¼Œä¸å…è®¸å®ç°ï¼ˆæ²¡æœ‰æ–¹æ³•ä½“ï¼‰

  - ç±»é‡Œé¢å¯ä»¥æœ‰æŠ½è±¡çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•ï¼ˆæƒ…å†µè¾ƒå°‘ï¼‰

  - ç±»é‡Œé¢æœ‰æŠ½è±¡æ–¹æ³•ï¼Œå®ƒå°±ä¸€å®šæ˜¯æŠ½è±¡ç±»

  - ä»ç”¨æ³•ä¸Šï¼Œä¸»è¦æ˜¯ç”¨æ¥è¢«ç»§æ‰¿çš„ï¼Œå®ƒçš„å­ç±»å¿…é¡»è¦å®ç°çˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå¦åˆ™å®ƒè‡ªå·±ä¹Ÿå¿…é¡»å£°æ˜ä¸ºabstract class

- ä¿®é¥°æ–¹æ³•ï¼š ä¼šä½¿è¿™ä¸ªæ–¹æ³•å˜æˆæŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åªæœ‰å£°æ˜ï¼ˆå®šä¹‰ï¼‰è€Œæ²¡æœ‰å®ç°ï¼Œå®ç°éƒ¨åˆ†ä»¥â€ï¼›â€ä»£æ›¿ã€‚éœ€è¦å­ç±»ç»§æ‰¿å®ç°ï¼ˆè¦†ç›–ï¼‰
- æŠ½è±¡ç±»æ˜¯å¯ä»¥ç»§æ‰¿æ™®é€šç±»



## 14ã€finalã€staticã€abstractçš„å…±å­˜

- finalã€abstract ä¸èƒ½å…±å­˜ï¼ˆæ— è®ºåœ¨ç±»ã€æ–¹æ³•ã€å±æ€§ã€å±€éƒ¨å˜é‡ä¸Šéƒ½ä¸èƒ½å…±å­˜ï¼‰
  - åŸå› 1:ä¿®é¥°ç±»ï¼šfinalç±»è¡¨ç¤ºå®Œç¾ä¸éœ€è¦ç»§æ‰¿é‡å†™ï¼Œabstractç±»è¡¨ç¤ºè¦å­ç±»ç»§æ‰¿ã€‚
  - åŸå› 2:ä¿®é¥°æ–¹æ³•æ—¶ï¼šfinalè¡¨ç¤ºå®Œç¾ä¸éœ€è¦é‡å†™ï¼Œåªèƒ½å­ç±»ç»§æ‰¿ä½¿ç”¨ï¼Œè€Œabstractä¸­çš„æ–¹æ³•æ²¡æœ‰ä¸œè¥¿ï¼Œæ‰€ä»¥å¹¶ä¸å®Œç¾ã€‚ä»¥ä¸Šä¸¤ç‚¹éƒ½æ˜¯å†²çªçš„ã€‚æ•…ä¸æˆç«‹ã€‚
- staticã€abstract ä¸èƒ½å…±å­˜ï¼ˆæ— è®ºåœ¨ç±»ã€æ–¹æ³•ã€å±æ€§ã€å±€éƒ¨å˜é‡ä¸Šéƒ½ä¸èƒ½å…±å­˜ï¼‰
- final static fieldï¼šå®šä¹‰çš„å¯¹è±¡æ—¢è¦å®ƒæ˜¯é™æ€çš„ï¼Œä¹Ÿè¦æ±‚å®ƒçš„å€¼ä¸èƒ½å†è¢«ä¿®æ”¹ã€‚
- final static methodï¼šè¯¥ç±»æˆå‘˜æ–¹æ³•ä¸èƒ½è¢« overrideï¼ˆé‡å†™ï¼‰



## 15ã€æ¥å£

> å®šä¹‰

- æ¥å£ï¼šä¸»è¦æ˜¯ç”¨æ¥å°è£…ä¸€æ½å­æŠ½è±¡æ–¹æ³•çš„ï¼Œå®ƒä¾§é‡åœ¨äºå¯¹è¡Œä¸ºçš„ä¸€ç§æŠ½è±¡ï¼ˆåŠ¨è¯ï¼‰

- æ¥å£å¯ä»¥çœ‹ä½œä¸€ä¸ªç‰¹æ®Šçš„æŠ½è±¡ç±»ï¼Œä½†æ˜¯ä¸¤ä¸ªæ˜¯ä¸åŒçš„æ¦‚å¿µï¼Œç±»æè¿°å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ¥å£åˆ™åŒ…å«ç±»è¦å®ç°çš„æ–¹æ³•ã€‚\

- æ¥å£ä¸­ä¸èƒ½æœ‰å…·ä½“çš„æ–¹æ³•å®ç°ï¼Œå®ƒåªæ˜¯ä¸€ç§è¡Œä¸ºçš„è§„çº¦ï¼ˆè§„èŒƒå’Œçº¦å®šï¼‰

> è¯­æ³•ç‰¹ç‚¹

- æ¥å£çš„å®ç°ç±»å¿…é¡»å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œåªè¦æœ‰ä¸€ä¸ªæ²¡æœ‰å®ç°ï¼Œè¿™ä¸ªç±»æœ¬èº«å¿…é¡»å£°æ˜ä¸ºabstract class

- æ¥å£å®šä¹‰å±æ€§ï¼Œé»˜è®¤æ˜¯public final staticï¼Œå¹¶ä¸”è¦å¯¹å…¶åˆå§‹åŒ–

- æ¥å£å®šä¹‰æ–¹æ³•ï¼Œé»˜è®¤æ˜¯public abstract

- JDK8 æ–°ç‰¹æ€§ï¼šæ¥å£ä¸­å…¶å®å¯ä»¥å®šä¹‰å…·ä½“æ–¹æ³•ï¼ˆé»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªï¼‰ï¼Œå‰é¢å¿…é¡»åŠ defaultä¿®é¥°

- æ¥å£å’Œå…¶ä»–ç±»å‹ä¹‹é—´çš„å…³ç³»ï¼š
  - æ¥å£å’Œå®ç°ç±»ä¹‹é—´çš„æ˜¯implementsï¼Œå¯ä»¥å®ç°å¤šä¸ªæ¥å£
  - æ¥å£å’Œæ¥å£ä¹‹é—´æ˜¯extends

> ä½œç”¨

- **ä¸»è¦æ˜¯ä¸ºäº†è§£è€¦**

å³å…·ä½“æŸä¸€ä¸ªç±»å‹å’Œç›¸åº”è¡Œä¸ºä¹‹é—´çš„å…³ç³»

~~~java
new User("Jack").eat();
new Animal("Pony").eat();
~~~

- å½¢æˆå¤šæ€

~~~java
void run(IEat eat)
~~~

- æ¥å£æœ€ç»ˆå½¢æˆäº†ä¸€ç§è·¨ç•Œç±»å‹



## 16ã€æ¥å£å†…é»˜è®¤ä¿®é¥°ç¬¦

```java
public interface Wifi {
// public abstract class Wifi {
    // ä¸æ˜¯æŸæŸå®ä¾‹çš„æˆå‘˜å˜é‡ï¼Œè€Œæ˜¯å¤§å®¶å…±æœ‰
    // é»˜è®¤ä¿®é¥°ç¬¦ä¸ºpublic final static
    public final static int frequency = 100;

    // é»˜è®¤ä¿®é¥°ç¬¦ä¸ºpublic abstract
    public abstract void connect();

}
```

- **å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„è®¿é—®æƒé™ä¸èƒ½å°äºåŸè®¿é—®æƒé™ï¼Œåœ¨æ¥å£ä¸­ï¼Œæ–¹æ³•çš„é»˜è®¤æƒé™å°±æ˜¯publicï¼Œæ‰€ä»¥å­ç±»é‡å†™ååªèƒ½æ˜¯public**



## 17ã€æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«

1ã€æ¥å£å’ŒæŠ½è±¡ç±»çš„æ¦‚å¿µæ˜¯ä¸ä¸€æ ·çš„ã€‚**æ¥å£æ˜¯å¯¹åŠ¨ä½œçš„æŠ½è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯è¿™ä¸ªå¯¹è±¡èƒ½åšä»€ä¹ˆ**ï¼Œæ¯”å¦‚äººå¯ä»¥åƒä¸œè¥¿ã€ç‹—ä¹Ÿå¯ä»¥åƒä¸œè¥¿ï¼Œåªè¦æœ‰ç›¸åŒçš„è¡Œä¸ºï¼›**æŠ½è±¡ç±»æ˜¯å¯¹æ ¹æºçš„æŠ½è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯è¿™ä¸ªå¯¹è±¡æ˜¯ä»€ä¹ˆ**ï¼Œæ¯”å¦‚ç”·äººæ˜¯äººã€å¥³äººä¹Ÿæ˜¯äºº

2ã€**å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œåªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»**

3ã€æ¥å£ä¸­åªèƒ½å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼ˆé™¤defaultæ–¹æ³•ï¼‰ï¼ŒæŠ½è±¡ç±»ä¸­å¯ä»¥æœ‰æ™®é€šæ–¹æ³•ï¼ˆç¬¬10ä¸ªæ€»ç»“æœ€åä¸€ç‚¹å¯ä»¥ç»§æ‰¿æ™®é€šç±»çš„åŸå› ï¼‰

4ã€æ¥å£ä¸­åªèƒ½æœ‰é™æ€çš„ä¸èƒ½è¢«æ”¹å˜çš„æ•°æ®æˆå‘˜ï¼ŒæŠ½è±¡ç±»å¯ä»¥æœ‰æ™®é€šçš„æ•°æ®æˆå‘˜



## 18ã€æŠ½è±¡ç±»å®ç°æ¥å£ï¼Œå­ç±»ç»§æ‰¿æŠ½è±¡ç±»çš„å…³ç³»

- ä¸€ä¸ªç±»å®ç°ä¸€ä¸ªæ¥å£ï¼Œåˆ™è¯¥ç±»å¿…é¡»å®ç°è¯¥æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•
- ä¸€ä¸ªæŠ½è±¡ç±»å®ç°ä¸€ä¸ªæ¥å£ï¼Œç„¶åè¯¥**æŠ½è±¡ç±»å¯ä»¥å®ç°è¯¥æ¥å£ä¸­ä»»æ„æ•°é‡çš„æ–¹æ³•**

- ï¼ˆä½œä¸š4ç¬¬äºŒé¢˜ï¼‰ä¸€ä¸ªç±»ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè¿™ä¸ªæŠ½è±¡ç±»å®ç°ä¸€ä¸ªæ¥å£ï¼Œç„¶ååœ¨è¿™ä¸ªå­ç±»ä¸­ï¼Œ**å¿…é¡»å®ç°æŠ½è±¡ç±»ä¸­æœªå®ç°çš„æ¥å£æ–¹æ³•å’ŒæŠ½è±¡çš„ä¿®æ”¹åçš„æŠ½è±¡æ–¹æ³•**. è‡³äºå·²ç»å®ç°çš„æ¥å£æ–¹æ³•æˆ–éæŠ½è±¡æ–¹æ³•ï¼Œå¯ä»¥é‡æ–°å®ç°æˆ–ä¸å®ç°



## 19ã€é‡å†™equalså’ŒhashCodeçš„åŸå› 

- æ²¡æœ‰é‡å†™hashCodeæ–¹æ³•ï¼Œé‡å†™äº†equalsï¼Œé‚£ä¹ˆå¯¹è±¡è°ƒç”¨hashCodeæ–¹æ³•æ˜¯æ ¹æ®å¯¹è±¡çš„åœ°å€å€¼æ¥ç”Ÿæˆçš„å“ˆå¸Œå€¼,ä¸¤ä¸ªå¯¹è±¡å†…å®¹ä¸€å®šç›¸åŒ,å“ˆå¸Œå€¼ä¸ä¸€å®šä¸åŒ

- é‡å†™äº†hashCodeæ–¹æ³•ï¼Œæ²¡æœ‰é‡å†™equalsï¼Œé‚£ä¹ˆå¯¹è±¡è°ƒç”¨hashCodeæ–¹æ³•æ˜¯æ ¹æ®å¯¹è±¡çš„å†…å®¹æ¥ç”Ÿæˆçš„å“ˆå¸Œå€¼ï¼Œä¸¤ä¸ªå¯¹è±¡å“ˆå¸Œå€¼ç›¸åŒ,å†…å®¹ä¸ä¸€å®šç›¸åŒ

- é‡å†™äº†equalså’ŒhashCode,ä¸¤ä¸ªå¯¹è±¡å†…å®¹ç›¸åŒ,åˆ™å“ˆå¸Œå€¼ä¸€å®šç›¸åŒ,

- **é‡å†™hashcodeæ˜¯ä¸ºäº†ä¿è¯ä¸¤ä¸ªå¯¹è±¡å†…å®¹ç›¸ç­‰ï¼ˆequalsï¼‰æ—¶å“ˆå¸Œè¡¨keyå”¯ä¸€çš„åŸåˆ™**

- **å®é™…ä¸Šé‡å†™äº†hashcodeçš„ä¸¤ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€è¿˜æ˜¯ä¸ç›¸åŒçš„**

  




## 20ã€ArrayListä¸LinkedList

- ArrayList
  - åŸºäºæ•°ç»„å®ç°çš„ï¼Œå…·å¤‡äº†æ•°ç»„æ‰€æœ‰çš„ä¼˜ç‚¹
  - åŠ¨æ€æ‰©å®¹
  - éšæœºæŸ¥æ‰¾ï¼ˆç»™å®šä¸€ä¸ªä¸‹æ ‡æŸ¥æ‰¾ï¼‰å¿«ï¼Œæ’å…¥åˆ é™¤æ…¢

- LinkedList
  - åŸºäºNodeï¼ˆèŠ‚ç‚¹ï¼‰æ¥å®ç°çš„è™šæ‹Ÿå®¹å™¨ï¼ˆæ²¡æœ‰å…·ä½“çš„è¾¹ç•Œï¼‰ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šä»"å‰"å’Œ"å"ä¸¤ä¸ªæ–¹å‘è®°ä½ä¸´è¿‘èŠ‚ç‚¹çš„ä¿¡æ¯
  - ç†è§£åŒé“¾è¡¨çš„æ“ä½œ
  - éšæœºè®¿é—®æ…¢ï¼Œæ’å…¥ã€åˆ é™¤å¿«

- ä¸ªäººå®ç°LinkedListä»£ç ï¼ˆå•å‘å’ŒåŒå‘ï¼‰

  - å•å‘å®ç°ï¼ˆåªæœ‰nextï¼Œæ²¡æœ‰preï¼‰

~~~java
    package com.zouzhao.linklist;
    
    import java.util.Stack;
    
    public class SingleLinkedListDemo {
        public static void main(String[] args) {
            HeroNode node1 = new HeroNode(1,"å®‹æ±Ÿ","åŠæ—¶é›¨");
            HeroNode node2=new HeroNode(2,"æ—å†²","è±¹å­å¤´");
            HeroNode node3 = new HeroNode(3, "æé€µ", "é»‘æ—‹é£");
            HeroNode node4=new HeroNode(4,"123","456");
    
            SingleLinkedList singleLinkedList = new SingleLinkedList();
            /*singleLinkedList.addHeroNode(node1);
            singleLinkedList.addHeroNode(node2);
            singleLinkedList.addHeroNode(node3);
            singleLinkedList.addHeroNode(node4);
    */
    
            //æœ‰åºæ·»åŠ 
            singleLinkedList.add2(node2);
            singleLinkedList.add2(node4);
            singleLinkedList.add2(node1);
            singleLinkedList.add2(node3);
    
            singleLinkedList.list();
    
            //æ›¿æ¢ï¼Œæ›´æ–°
            System.out.println("æ›¿æ¢ï¼Œæ›´æ–°");
            HeroNode newNode1=new HeroNode(4,"å´ç”¨","æ™ºå¤šæ˜Ÿ");
            HeroNode newNode2 = new HeroNode(5, "123", "123");
    
            singleLinkedList.update(newNode1);
            singleLinkedList.list();
    
            singleLinkedList.update(newNode2);
            singleLinkedList.list();
    
    
            //åˆ é™¤
            System.out.println("åˆ é™¤");
            singleLinkedList.del(2);
            singleLinkedList.list();
            System.out.println();
            singleLinkedList.del(4);
            singleLinkedList.list();
            System.out.println();
            singleLinkedList.del(4);
            singleLinkedList.list();
            System.out.println();
    
            //å¾—å‡ºæœ‰æ•ˆèŠ‚ç‚¹
            System.out.println("æœ‰æ•ˆèŠ‚ç‚¹");
            System.out.println(getLength(singleLinkedList.head));
    
            System.out.println("è¿”å›é“¾è¡¨å€’æ•°ç¬¬kä¸ªç»“ç‚¹");
            System.out.println(findLastIndexNode(singleLinkedList.head, -2));
            System.out.println(findLastIndexNode(singleLinkedList.head, 2));
    
            System.out.println("åŸæœ¬çš„é“¾è¡¨");
            singleLinkedList.list();
            System.out.println("åè½¬åˆ—è¡¨");
            reversetList(singleLinkedList.head);
            singleLinkedList.list();
            System.out.println("2æ¬¡åè½¬åˆ—è¡¨åˆ©ç”¨stack");
           reversetListByStack(singleLinkedList.head);
            singleLinkedList.list();
    
            System.out.println("ä»å°¾åˆ°å¤´æ‰“å°");
            reversePrint(singleLinkedList.head);
    
            //å¤åŸ
            System.out.println("");
            System.out.println("å¤åŸ");
            /*HeroNode node1 = new HeroNode(1,"å®‹æ±Ÿ","åŠæ—¶é›¨");
            HeroNode node2=new HeroNode(2,"æ—å†²","è±¹å­å¤´");
            HeroNode node3 = new HeroNode(3, "æé€µ", "é»‘æ—‹é£");
            HeroNode node4=new HeroNode(4,"123","456");*/
            HeroNode node5= new HeroNode(5,"å®‹æ±Ÿ","åŠæ—¶é›¨");
            HeroNode node6=new HeroNode(6,"æ—å†²","è±¹å­å¤´");
            HeroNode node7 = new HeroNode(7, "æé€µ", "é»‘æ—‹é£");
            HeroNode node8=new HeroNode(8,"123","456");
            singleLinkedList.add2(node5);
            singleLinkedList.add2(node6);
            singleLinkedList.add2(node1);
            singleLinkedList.add2(node3);
    
            SingleLinkedList singleLinkedList2 = new SingleLinkedList();
            singleLinkedList2.add2(node2);
            singleLinkedList2.add2(node7);
            singleLinkedList2.add2(node4);
            singleLinkedList2.add2(node8);
    
            System.out.println("å•é“¾è¡¨1");
            singleLinkedList.list();
            System.out.println("å•é“¾è¡¨2");
            singleLinkedList2.list();
    
            System.out.println("åˆå¹¶ä¸¤ä¸ªæœ‰åºçš„å•é“¾è¡¨ï¼Œåˆå¹¶ä¹‹åçš„é“¾è¡¨ä¾ç„¶æœ‰åºã€è¯¾åç»ƒä¹ .ã€‘");
            lindedList1AndLinkedList2(singleLinkedList.head,singleLinkedList2.head);
            singleLinkedList.list();
        }
    
        /**
         *
         * @param head
         * @return é“¾è¡¨æœ‰æ•ˆèŠ‚ç‚¹ä¸ªæ•°
         */
        public static int getLength(HeroNode head){
            if(head.next==null)return 0;//é“¾è¡¨ä¸ºç©º
            HeroNode temp=head.next;
            int count=0;
            while(true){
                if(temp==null)break;
                else count++;
                temp=temp.next;
            }
            return  count;
        }
    
        /**
         *
         * @param head
         * @param index
         * @return è¿”å›é“¾è¡¨å€’æ•°ç¬¬kä¸ªç»“ç‚¹
         */
        public static HeroNode findLastIndexNode(HeroNode head,int index){
            //é“¾è¡¨ä¸ºç©º
            if(head.next==null) return null;
    
            int length=getLength(head);
            //indexå¿…é¡»åœ¨å–å€¼èŒƒå›´å†…
            if(index<=0||index>length)return null;
    
            HeroNode temp=head.next;
            for(int i=0;i<length-index;i++){
                temp=temp.next;
            }
            return temp;
        }
    
        /**
         *
         * @param head
         * åè½¬é“¾è¡¨
         */
        public static void reversetList(HeroNode head){
            //åˆ¤æ–­é“¾è¡¨ä¸ºç©ºæˆ–è€…åªæœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œä¸éœ€è¦åè½¬
            if(head.next==null||head.next.next==null) return;
            //åè½¬
            HeroNode temp,next,reverseHead;
            reverseHead=new HeroNode(0,"","");
            temp=head.next;
            while(true){
                if(temp==null)break;
                next=temp.next;
                //å…ˆè¿åé¢å†è¿å‰é¢
                temp.next=reverseHead.next;
                reverseHead.next=temp;
    
                temp=next;
            }
            //å°†ç»“æœè½¬ç§»ç»™åŸé“¾è¡¨
            head.next=reverseHead.next;
        }
    
        /**
         *
         * @param head
         * åè½¬é“¾è¡¨ åˆ©ç”¨æ ˆ
         */
        public static void reversetListByStack(HeroNode head){
            //åˆ¤æ–­æ˜¯å¦ä¸ºç©ºæˆ–è€…ä¸€ä¸ªç»“ç‚¹
            if(head.next==null||head.next.next==null)return;
            //åè½¬é“¾è¡¨
            HeroNode reversetListHead=new HeroNode(0,"","");
            //å‹æ ˆ
            Stack<HeroNode> nodeStack = new Stack<>();
            HeroNode temp=head.next;
    
            while (true){
                if(temp==null)break;
                nodeStack.push(temp);
                temp=temp.next;
            }
            HeroNode uaa=reversetListHead;
            while(nodeStack.size()>0){
               HeroNode cur=nodeStack.pop();
                uaa.next=cur;
                cur.next=null;
                uaa=cur;
            }
            //è½¬ç§»
            head.next=reversetListHead.next;
    
        }
    
        /**
         *
         * @param head
         * ä»å°¾åˆ°å¤´æ‰“å°å•é“¾è¡¨ åˆ©ç”¨æ ˆstack
         */
        public static void reversePrint(HeroNode head){
            //åˆ¤æ–­æ˜¯å¦ä¸ºç©ºæˆ–è€…ä¸€ä¸ªç»“ç‚¹
            if(head.next==null||head.next.next==null)return;
            //åè½¬é“¾è¡¨
            HeroNode reversetListHead=new HeroNode(0,"","");
            //å‹æ ˆ
            Stack<HeroNode> nodeStack = new Stack<>();
            HeroNode temp=head.next;
    
            while (true){
                if(temp==null)break;
                nodeStack.push(temp);
                temp=temp.next;
            }
    
            while(nodeStack.size()>0){
                HeroNode cur=nodeStack.pop();
                System.out.println(cur);
            }
        }
    
        /**
         * @param head1
         * @param head2
         * åˆå¹¶ä¸¤ä¸ªæœ‰åºçš„å•é“¾è¡¨ï¼Œåˆå¹¶ä¹‹åçš„é“¾è¡¨ä¾ç„¶æœ‰åºã€è¯¾åç»ƒä¹ .ã€‘
         * ç±»ä¼¼å¦‚æŒ‰noå¤§å°æ’å…¥,,t2æ’å…¥t1
         */
        public static void lindedList1AndLinkedList2(HeroNode head1,HeroNode head2 ){
            if(head1.next==null&&head2==null)return;
    
            HeroNode temp2=head2.next;
            HeroNode temp1=head1;
            while(true) {
    
                if(temp2==null)break;//å…¨éƒ¨æ’å…¥å®Œ
    
                //æ‰¾åˆ°å¯¹åº”çš„noä½ç½®
                while (true) {
                    if (temp1.next == null) break;//éå†ç»“æŸ
                    if (temp2.no < temp1.next.no) break;//
                    temp1 = temp1.next;
                }
    
                HeroNode next = temp2.next;
                temp2.next = temp1.next;
                temp1.next = temp2;
                temp2=next;
            }
    
        }
    
        //å®šä¹‰å•ä¸ªå®ä½“,HeroNode
        static class HeroNode {
            int no;
            String name;
            String nickname;
            HeroNode next;
    
            //æ„é€ å™¨
            public HeroNode(int no,String name,String nickname){
                this.no=no;
                this.name=name;
                this.nickname=nickname;
            }
    
            @Override
            public String toString() {
                return "HeroNode{" +
                        "no=" + no +
                        ", name='" + name + '\'' +
                        ", nickname='" + nickname + '\'' +
                        '}';
            }
        }
    
        //å®šä¹‰å•é“¾è¡¨å’Œæ–¹æ³•
        static class SingleLinkedList{
            private HeroNode head=new HeroNode(0,"","");
    
    
            //æ·»åŠ æ— é¡ºåºæ’å
            public void addHeroNode(HeroNode heroNode){
                HeroNode temp= head;
                while (true){
                    if(temp.next==null){
                        break;
                    }
                    temp=temp.next;
                }
    
                temp.next=heroNode;
            }
    
            //æ·»åŠ æ—¶æŒ‰é¡ºåºè¿›è¡Œæ·»åŠ 
            public void add2(HeroNode heroNode){
                HeroNode temp=head;
                boolean flag=false;
                while(true){
                    if(temp.next==null)break;//éå†ç»“æŸ
                    if(heroNode.no<temp.next.no)break;//æ‰¾åˆ°ç¼–å·ä½ç½®  1 2 3  *  5
                    else if(temp.next.no==heroNode.no)  //ç­‰äºè¯´æ˜ç¼–å·å·²å­˜åœ¨
                    {
                        flag=true;
                        break;}
    
                    temp=temp.next; //åç§»
                }
                if(flag) {
                    System.out.println("ç¼–å·å·²å­˜åœ¨ï¼Œæ— æ³•è¿›è¡Œæ·»åŠ ");
                }
                else {
                    heroNode.next=temp.next;
                    temp.next=heroNode;
                }
            }
    
            //æ˜¾ç¤ºé“¾è¡¨
            public void list(){
                HeroNode temp=head;
    
               while (true){
                   if(temp.next==null)break; //æ£€æŸ¥é“¾è¡¨åé¢è¿˜æœ‰æ²¡æœ‰æ•°æ® //åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º
                   System.out.println(temp.next);
                   temp=temp.next;
    
               }
            }
    
            //æ ¹æ®noä¿®æ”¹é“¾è¡¨
            public void update(HeroNode newHeroNode){
                HeroNode temp=head.next;
                boolean flag=false;
                while (true){
                    //éå†ç»“æŸ
                    if(temp==null)break;
                    if(newHeroNode.no== temp.no){
                        flag=true;
                       break;
                    }
                    temp=temp.next;
                }
    
                if(flag){
                    temp.name=newHeroNode.name;
                    temp.nickname=newHeroNode.nickname;
                    System.out.println("ä¿®æ”¹æˆåŠŸ");
                }else {
                    System.out.println("æ²¡æœ‰æ‰¾åˆ°è¯¥ç¼–å·"+newHeroNode.no);
                }
            }
    
            //æ ¹æ®noåˆ é™¤
            public void del(int no){
                HeroNode temp=head;
                boolean flag=false;
                while(true){
                  if(temp.next==null)break;//éå†ç»“æŸ
                  if(temp.next.no==no){
                      flag=true;
                      break;
                  }
                  temp=temp.next;
                }
    
                if(flag){
                    temp.next=temp.next.next;
                }else System.out.println("æ²¡æœ‰è¯¥no");
    
            }
    
    
    
        }
    }
    
~~~
  åŒå‘å®ç°ï¼ˆæœ‰preå’Œnextï¼‰

~~~java
package com.zouzhao.linklist;

public class DoubleLinkedListDemo {
    public static void main(String[] args) {

    }


    //å®šä¹‰å•ä¸ªå®ä½“,HeroNode2
    static class HeroNode2 {
        int no;
        String name;
        String nickname;
        HeroNode2 next;
        HeroNode2 pre;

        //æ„é€ å™¨
        public HeroNode2(int no,String name,String nickname){
            this.no=no;
            this.name=name;
            this.nickname=nickname;
        }

        @Override
        public String toString() {
            return "HeroNode2{" +
                    "no=" + no +
                    ", name='" + name + '\'' +
                    ", nickname='" + nickname + '\'' +
                    '}';
        }
    }


    class DoubleLinkedList{
        private HeroNode2 head=new HeroNode2(0,"","");


        //æ˜¾ç¤ºéå†é“¾è¡¨
        public void list(){
            HeroNode2 temp=head;

            while (true){
                if(temp.next==null)break; //æ£€æŸ¥é“¾è¡¨åé¢è¿˜æœ‰æ²¡æœ‰æ•°æ® //åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º
                System.out.println(temp.next);
                temp=temp.next;

            }
        }
        
        //æ·»åŠ ç»“ç‚¹åˆ°é“¾è¡¨æœ«å°¾
        public void addHeroNode(HeroNode2 heroNode){
            HeroNode2 temp= head;
            while (true){
                if(temp.next==null){
                    break;
                }
                temp=temp.next;
            }
            //åŒå‘é“¾è¡¨
            temp.next=heroNode;
            heroNode.pre=temp;
        }

        //æ ¹æ®noä¿®æ”¹é“¾è¡¨
        public void update(HeroNode2 newHeroNode){
            HeroNode2 temp=head.next;
            boolean flag=false;
            while (true){
                //éå†ç»“æŸ
                if(temp==null)break;
                if(newHeroNode.no== temp.no){
                    flag=true;
                    break;
                }
                temp=temp.next;
            }

            if(flag){
                temp.name=newHeroNode.name;
                temp.nickname=newHeroNode.nickname;
                System.out.println("ä¿®æ”¹æˆåŠŸ");
            }else {
                System.out.println("æ²¡æœ‰æ‰¾åˆ°è¯¥ç¼–å·"+newHeroNode.no);
            }
        }

        //æ ¹æ®noåˆ é™¤
        public void del(int no){

            if(head.next==null){
                System.out.println("é“¾è¡¨ä¸ºç©ºï¼Œæ— æ³•åˆ é™¤");
            }
            HeroNode2 temp=head.next;
            boolean flag=false;
            while(true){
                if(temp==null)break;//éå†ç»“æŸ
                if(temp.no==no){
                    flag=true;
                    break;
                }
                temp=temp.next;
            }

            if(flag){
                temp.pre.next=temp.next;
                //å¦‚æœä¸ºæœ€åä¸€ä¸ªç»“ç‚¹ï¼Œå°±ä¼šå‡ºç°ç©ºæŒ‡é’ˆ,è¦åŠ ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªç»“ç‚¹
                if(temp.next!=null){
                temp.next.pre=temp.pre;}

            }else System.out.println("æ²¡æœ‰è¯¥no");

        }
        
        
    }

}
~~~



## 21ã€HashMapå’ŒHaspSet

- Map
  - åŸºäºé”®å€¼å¯¹(key-value)çš„æ•°æ®ç»“æ„
  - keyä¸èƒ½é‡å¤çš„ï¼Œvalueå¯ä»¥é‡å¤
  - å…ƒç´ çš„æ’åˆ—é¡ºåºæ— æ³•å¾—åˆ°ä¿éšœçš„
  - **HaspMapåŠå¸¸ç”¨æ–¹æ³•**
  
~~~java
  		Map<String, Student> map = new HashMap<>();
		//ç¬¬ä¸€ä¸ªold
         Object old = map.put("1b", new Student("Mike", 20));
         System.out.println(old);	//sout:null

		//1ã€putï¼Œæ”¾å…¥key-value
         map.put("a2", new Student("Jack", 20));
         map.put("3_", new Student("Cool", 40));
         map.put("z4", new Student("Mary", 30));
		
		//ä¸¤ä¸ªoldè¾“å‡ºçš„åŒºåˆ«,æ–°æ”¾å…¥çš„keyæ²¡æœ‰è¦†ç›–è¿”å›nullï¼Œè¦†ç›–äº†è¿”å›è¢«è¦†ç›–çš„å¯¹è±¡
         old = map.put("3_", new Student("Tom", 6));		
         System.out.println(old);	//sout:Student{name='Cool', age=40}
		
         System.out.println("---------------");

         //2ã€keySetï¼Œå¾—åˆ°æ‰€æœ‰çš„key
         Set<String> keys = map.keySet();
         for (String key: keys) {
             Student value = map.get(key);
             System.out.println(key + "-" + value);
         }

         //3ã€valuesï¼Œä»…ä»…åªæƒ³è·å–åˆ°value
         Collection<Student> values = map.values();
         for (Student stu : values) {
             System.out.println(stu);
         }

         //4ã€entrySetï¼ŒæŠŠkeyå’ŒvalueåŒ…è£…æˆçš„è¿™æ ·ä¸€ä¸ªå¯¹è±¡å«Entry
         Set<Map.Entry<String, Student>> entries = map.entrySet();
         for (Map.Entry entry : entries) {
             System.out.println(entry.getKey() + ":" + entry.getValue());
         }

         System.out.println(map.size());
~~~

  

â€‹    

- Set
  - æ²¡æœ‰é¡ºåº
  
  - æ²¡æœ‰ä¸‹æ ‡
  
  - å…ƒç´ ä¸å¯ä»¥é‡å¤
  
  - ç±»ä¼¼äºä¸€ä¸ªå¤§éº»è¢‹ï¼Œé‡Œé¢åªèƒ½è£…ä¸é‡å¤çš„å…ƒç´ 
  
  - **HashSetåŠå¸¸ç”¨æ–¹æ³•**
  

~~~java
	//ä¸€ã€å…ƒç´ å»é‡
	static String[] duplicatedPlus (String[] arr) {     
       // é¦–å…ˆæŠŠæ•°ç»„è½¬æ¢æˆCollection
        List<String> list = Arrays.asList(arr);
      Set<String> set = new HashSet<>(list);
    //1ã€å¼ºè½¬   
    return (String[]) set.toArray();
    
        //2ã€new String[0]å…¶ä¸­å‚æ•°çš„ä½œç”¨å¹¶ä¸æ˜¯è®©ä½ ç»™ä¸€ä¸ªç©ºçš„æ•°ç»„å®¹å™¨ï¼Œè€Œæ˜¯å‘Šè¯‰å®ƒå…·ä½“æ•°ç»„çš„ç±»å‹ï¼Œè®©å®ƒè‡ªå·±ç»™é€ ä¸€ä¸ªå‡ºæ¥ï¼Œå°±æ˜¯ç»™ç±»å‹
       return set.toArray(new String[0]);

        // ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨çš„æ ¹æ®åé¢è¿”å›çš„ç±»å‹è¿›è¡Œæ¨æ–­
        // 3ã€æ•´åˆç‰ˆ
    return new HashSet<String>(Arrays.asList(arr)).toArray(new String[0]);
    	
    //4ã€Treeçš„ç»“æ„ä¼šè®©å…ƒç´ æŒ‰å¤§å°æ’å…¥ï¼ŒäºŒå‰æ ‘çš„ç»“æ„ï¼Œè¿”å›ç»“æœæœ‰åº
    return new TreeSet<>(Arrays.asList(arr)).toArray(new String[0]);
    }

	//äºŒã€APIã€å¸¸ç”¨
  static void testAPI() {
        Set<String> set = new HashSet<>();
      //1ã€addï¼Œæ·»åŠ 
        set.add("asdf");
        set.add("123");
        set.add("qwer");
        set.add(RandomUtils.randomString());
        //é‡å¤æ— æ³•æ’å…¥
      set.add("123");
		//2ã€remove ï¼Œç§»å‡º
        set.remove("qwer");

        for (String item : set) {
            System.out.println(item);
        }
	//3ã€containsï¼Œseté‡Œæ˜¯å¦åŒ…å«XXX
        System.out.println(set.contains("asdf"));
    }

~~~



## 22ã€Javaæƒé™ä¿®é¥°ç¬¦æœ‰å“ªäº›ï¼Ÿæœ‰ä½•åŒºåˆ«ï¼Ÿ

![image-20220723140053658](images/image-20220723140053658.png)



## 23ã€é‡è½½ä¸é‡å†™çš„åŒºåˆ«

1ã€å®šä¹‰ä¸åŒï¼šé‡è½½æ˜¯å®šä¹‰ç›¸åŒçš„æ–¹æ³•åã€å‚æ•°ä¸åŒï¼Œé‡å†™æ˜¯å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•

2ã€èŒƒå›´ä¸åŒï¼šé‡è½½æ˜¯åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œé‡å†™æ˜¯å­ç±»ä¸çˆ¶ç±»ä¹‹é—´çš„

3ã€å¤šæ€ä¸åŒï¼šé‡è½½æ˜¯ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼Œé‡å†™æ˜¯è¿è¡Œæ—¶çš„å¤šæ€æ€§

4ã€å‚æ•°ä¸åŒï¼šé‡è½½çš„å‚æ•°ä¸ªæ•°ã€å‚æ•°ç±»å‹ã€å‚æ•°çš„é¡ºåºå¯ä»¥ä¸åŒï¼Œé‡å†™çˆ¶ç±»å­æ–¹æ³•å‚æ•°å¿…é¡»ç›¸åŒ

5ã€ä¿®é¥°ä¸åŒï¼šé‡è½½å¯¹ä¿®é¥°èŒƒå›´æ²¡æœ‰è¦æ±‚ï¼Œé‡å†™è¦æ±‚é‡å†™æ–¹æ³•çš„ä¿®é¥°èŒƒå›´ä¸å°äºè¢«é‡å†™æ–¹æ³•çš„ä¿®é¥°èŒƒå›´

6ã€é‡å†™çš„å­ç±»è¿”å›å€¼ç±»å‹ã€å‚æ•°ç±»å‹ã€å¼‚å¸¸èŒƒå›´è¦å°äºç­‰äºçˆ¶ç±»çš„



## 24ã€å¼€é—­åŸåˆ™

è½¯ä»¶ä¸­çš„å¯¹è±¡ï¼ˆç±»ã€å‡½æ•°ã€æ¨¡å—ç­‰ï¼‰åº”è¯¥æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­



## 25ã€åƒåœ¾å›æ”¶æœºåˆ¶

 å›æ”¶ä¸å¯è¾¾çš„å¯¹è±¡ï¼Œç¨‹åºå‘˜ä¸èƒ½å¼ºåˆ¶æ‰§è¡Œï¼Œåªèƒ½System.gc æ–¹æ³•æ¥â€œå»ºè®®â€æ‰§è¡Œ











# ğŸˆğŸˆé«˜çº§\_é›†åˆæ¡†æ¶

## 1.1 mapå’Œset

~~~java
è§ä¸Šé¢ç»éªŒæ€»ç»“ç¬¬18ç‚¹
~~~



## 1.2 å·¥å…·ç±»Arraysã€ Collections

ä¸¤ç§ç±»å¸¸ç”¨æ–¹æ³•è¯¦ç»†å¯è§[ğŸ‘€æ”¶è—çš„æ–¹æ³•ä¸å‡½æ•°](/Project/javaæ–¹æ³•/javaæ–¹æ³•.md)

ä¸ºä»€ä¹ˆæ”¾æ”¶è—çš„æ–¹æ³•ä¸å‡½æ•°é‡Œå‘¢ï¼Œéš¾é“ä½ ç”¨æ–¹æ³•è¿˜å»ç¬”è®°é‡Œæ‰¾å—ï¼Œè‚¯å®šæ˜¯æœ‰ä¸€ä¸ªæ–¹æ³•æ”¶è—é›†æ›´å¿«å§

- Arrays

~~~java
 	    // 1ã€æ‹·è´æ•°ç»„
        Arrays.copyOf()
        // 2ã€å¯¹ç›®æ ‡æ•°ç»„åšä¸€ä¸ªèŒƒå›´æ‹·è´
       Arrays.copyOfRange()
        // 3ã€æŠŠæ•°ç»„è½¬æ¢æˆListé›†åˆ
         Arrays.asList(1,2,3);

        int[] arr = {3, 0, -9, 8, 4, 3};
		//4ã€ ç›´æ¥åœ¨åŸå…ˆçš„æ•°ç»„ä¸Šè¿›è¡Œæ’åºçš„ï¼Œç ´åæ€§æ–¹æ³•
        Arrays.sort(arr); 	//æ’åºå¥½å[-9, 0, 3, 3, 4, 8]
        //5ã€æŸ¥æ‰¾å€¼åœ¨arrçš„ä½ç½®ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œè¿”å›ç´¢å¼•
		// å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£ä¹ˆæŠŠè¿”å›(-(point) - 1)
		//pointï¼šè¿™ä¸ªæ–°å…ƒç´ å®‰æ’è¿›å»çš„ä½ç½® 
        int index = Arrays.binarySearch(arr, 9); // è¿”å›çš„æ˜¯ç›®æ ‡åœ¨æ’å¥½åºçš„æ•°ç»„ä¸­çš„ç´¢å¼•ï¼Œç›®æ ‡å¯ä»¥æ’å…¥6å·ç´¢å¼•ï¼Œæ‰€ä»¥è¿™é‡Œè¿”å›ï¼ˆ-6ï¼‰-1  ï¼Œå³-7
        System.out.println(Arrays.toString(arr));
        System.out.println(index);
~~~

- Collections

~~~java
  // Collections.sort(list); // æ’åº

        // Collections.binarySearch() // äºŒåˆ†æŸ¥æ‰¾

        // Collections.reverse(list)// å€’åº

        // Collections.shuffle(); // ä¹±åº
~~~

## 1.3 sort()ï¼Œ Comparableè®©å¯¹è±¡å¯ä»¥è¿›è¡Œæ¯”è¾ƒ

- ç¬¬ä¸€ç§æ–¹æ³•,è®©éœ€è¦æ¯”è¾ƒçš„ç±»å®ç°comparableï¼ˆä¸æ¨èï¼‰

~~~java
public class Student implements Comparable<Student>{
    .....çœç•¥å±æ€§
        ......çœç•¥æ–¹æ³•
  // å†³å®šæ¯”è¾ƒä»€ä¹ˆå±æ€§
 // åœ¨åšAéœ€æ±‚çš„æ—¶å€™ï¼Œè¦æ±‚æ ¹æ®ageæ¯”è¾ƒ
// åœ¨åšBéœ€æ±‚çš„æ—¶å€™ï¼Œè¦æ±‚æ ¹æ®nameæ¯”è¾ƒ
// å› ä¸ºä¸šåŠ¡çš„å‘å±•ï¼Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘(æ¯”è¾ƒé€»è¾‘)ä¾µå…¥åˆ°äº†JavaBeanä¸­ï¼Œè¿™æ ·çš„ä»£ç æ˜¯ä¸å¤ªå¥½ç»´æŠ¤çš„
        
        //æŒ‰å¹´é¾„å¤§å°æ¥è¿›è¡Œæ¯”è¾ƒ
         @Override
    public int compareTo(Student o) {
        return Integer.compare(getAge(), o.getAge());
    }
}
 
Main.class
        List<Student> stuList = new ArrayList<>();
        stuList.add(new Student(randomString(),randomNumber(100)));
        stuList.add(new Student(randomString(),randomNumber(100)));
        stuList.add(new Student(randomString(),randomNumber(100)));
        stuList.add(new Student(randomString(),randomNumber(100)));

       Collections.sort(stuList);
~~~



- ç¬¬äºŒç§æ–¹æ³•ï¼Œå†™å®ç°ç±»
~~~java
//æŒ‰å¹´é¾„ä»å°åˆ°å¤§
public class AgeComparator implements Comparator<Student> {
    @Override
    public int compare(Student o1, Student o2) {
        return Integer.compare(o1.getAge(), o2.getAge());
    }
}
//æŒ‰å§“åçš„ACSIIä»å°åˆ°å¤§ 
public class NameComparator implements Comparator<Student> {
    @Override
    public int compare(Student o1, Student o2) {
        return o1.getName().compareTo(o2.getName());
    }
Main.class
         List<Student> stuList = new ArrayList<>();
        stuList.add(new Student(randomString(),randomNumber(100)));
        stuList.add(new Student(randomString(),randomNumber(100)));
        stuList.add(new Student(randomString(),randomNumber(100)));
        stuList.add(new Student(randomString(),randomNumber(100)));

       Collections.sort(stuList,new AgeComparator());
~~~

- æ¯”è¾ƒåè½¬

~~~java
 // å¾—åˆ°ä¸€ä¸ªä½œç”¨ç›¸åçš„æ¯”è¾ƒå™¨ï¼Œé¡ºåºåè½¬äº†
       Comparator<Student> nameComparator = Collections.reverseOrder(new NameComparator());
       Collections.sort(stuList,nameComparator);
~~~



## 1.4 æ’åºç®—æ³•

ä¸‹é¢å‡ ä¸ªæ’åºæ˜¯æˆ‘è‡ªå·±åšé¢˜çš„æ’åºç®—æ³•ï¼Œå¤§è‡´ä¸è€å¸ˆç›¸åŒï¼Œå› ä¸ºè‡ªå·±çš„ç®—æ³•ä»ç½‘ä¸Šå­¦çš„ï¼Œæ‰€ä»¥å®ç°ä¸è€å¸ˆæœ‰äº›å·®å¼‚ï¼Œä¸è¿‡ä¸­å¿ƒæ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„,æœ‰å…´è¶£å¯ä»¥äº†è§£ä¸‹è¿™äº›æ’åºï¼Œæœ‰æ­¥éª¤ç–‘é—®å¯ä»¥qqç§èŠæˆ‘

### 1.4.1 å½’å¹¶æ’åºï¼ˆä»Šå¤©ä¸Šè¯¾è®²çš„ï¼‰

~~~java
package com.zouzhao.sort;

import java.util.Arrays;

public class MergeSort {

    public static void main(String[] args) {
        int[] n=new int[1000];
        for (int i = 0; i < n.length; i++) {
            n[i]=(int)(Math.random()*80000);
        }
       System.out.println(Arrays.toString(n));
		//ä¸Šé¢æ˜¯æ˜¾ç¤ºæ²¡æ’åºå‰çš„æ•°ç»„
        int[] temp=new int[n.length];
		//ç®—æ³•å…¥å£
        mergeSort(n,0,n.length-1,temp);
		//æ‰“å°æ’åºåçš„æ•°ç»„
        System.out.println(Arrays.toString(n));
    }

    private static void mergeSort(int[] n,int start,int end,int[] temp) {
        if (start<end) {
            int mid=(end-start)/2+start;
            mergeSort(n,start,mid,temp);
            mergeSort(n,mid+1,end,temp);
            //åˆå¹¶
            merge(n, start, end, mid,temp);
        }
    }

    private static void merge(int[] n, int start, int end, int mid,int[] temp) {
        //åˆå¹¶
        int i= start,j= mid +1;
        int k=start;
       while (i<=mid&&j<=end){
           if (n[i]< n[j]){
                    temp[k]= n[i];
                    i++;k++;
           }else {
               temp[k] = n[j];
               j++;k++;
           }
        }
      while (i<=mid){
          temp[k]= n[i];
          i++;k++;
      }
      while (j<=end){
          temp[k] = n[j];
          j++;k++;
      }
        System.arraycopy(temp,start,n,start,end-start+1);

    }


}
~~~



### 1.4.2 å†’æ³¡æ’åº

æœ‰å…´è¶£å¯ä»¥å‚è€ƒè¿™ä¸ªæ’åºçš„flagå¯¹å…¶ä»–æ’åºè¿›è¡Œæ”¹è‰¯ï¼Œ

flagåœ¨è¿™é‡Œæ„ä¹‰ï¼šå¦‚æœåœ¨ä¸€æ¬¡æ’åºä¸­å¦‚æœæ²¡æœ‰å‘ç”Ÿä¸€æ¬¡ä½ç½®çš„äº¤æ¢ï¼Œflagå°±ä¼šç­‰äºtrueï¼Œè¯´æ˜æ— éœ€è¿›è¡Œåé¢çš„å¾ªç¯æ’åº

~~~java
package com.zouzhao.sort;

import java.util.Arrays;

public class BubbleSort {
    public static void main(String[] args) {
        int[] n=new int[5];
        for (int i = 0; i < ; i++) {
            n[i]=(int)(Math.random()*80000);
        }
        int[] bubble = bubble(n);
        System.out.println(Arrays.toString(n));
        System.out.println(Arrays.toString(bubble));
    }

    private static  int[] bubble(int[] n) {
        int temp=0;
        boolean flag=true;
        for (int i = 0; i < n.length-1; i++) {
            for (int j = 0; j < n.length-1-i; j++) {
                if(n[j]> n[j+1]){
                    flag=false;
                    temp= n[j];
                    n[j]= n[j+1];
                    n[j+1]=temp;
                }
            }
            if(flag){
                break;
            }else {
                flag=true;
            }
        }
        return  n;
    }
}
~~~



### 1.4.3 é€‰æ‹©æ’åº

~~~java
package com.zouzhao.sort;

import java.util.Arrays;

public class ChoiceSort {
    public static void main(String[] args) {
        int[] n=new int[50];
        for (int i = 0; i < n.length; i++) {
            n[i]=(int)(Math.random()*80000);
        }
        choiceSort(n);
        System.out.println(Arrays.toString(n));

    }
    private static void choiceSort(int[] n){
        for (int i = 0; i < n.length-1; i++) {
            for (int j = i+1; j < n.length; j++) {
                if(n[j]<n[i]){
                    int temp= n[j];
                    n[j]= n[i];
                    n[i]=temp;
                }
            }
        }


    }
}
~~~



### 1.4.4 æ’å…¥æ’åº

~~~java
package com.zouzhao.sort;

import java.util.Arrays;

public class InsertSort {
    public static void main(String[] args) {
        int[] n=new int[50];
        for (int i = 0; i < n.length; i++) {
            n[i]=(int)(Math.random()*80000);
        }
        insertSort(n);
        System.out.println(Arrays.toString(n));
    }
    private static void insertSort(int[] n){
        for (int i = 0; i < n.length; i++) {
            for (int j = i; j >0; j--) {
                if (n[j]<n[j-1]){
                    int temp= n[j];
                    n[j]= n[j-1];
                    n[j-1]=temp;
                }
            }
        }
    }
}

~~~



### 1.4.5 å¿«é€Ÿæ’åºï¼ˆé€Ÿåº¦å¦‚å…¶åï¼‰

~~~java
package com.zouzhao.sort;

import java.util.Arrays;

public class QuickSort {
    public static void main(String[] args) {
        int[] arr=new int[1000];
        for (int i = 0; i < arr.length; i++) {
            arr[i]=(int)(Math.random()*80000);
        }
        System.out.println(Arrays.toString(arr));
        int[] ints = quickSort(arr, 0, arr.length - 1);
        System.out.println(Arrays.toString(ints));
    }

    public static int[] quickSort(int[] arr,int left,int right){
       if(left<right){
           int partition = partition(arr, left, right);
            quickSort(arr,left,partition-1);
            quickSort(arr,partition+1,right);
       }
        return arr;
    }

    public static int partition(int[] arr,int left,int right){
        int pivot=left;
        int index=left+1;
        for (int i = index; i <=right ; i++) {
            if (arr[i]<arr[pivot]){
                swap(arr,i,index);
                index++;
            }
        }
        swap(arr,pivot,index-1);
        return index-1;
    }
    public static void swap(int[] arr,int i,int j){
        int temp=arr[i];
        arr[i]=arr[j];
        arr[j]=temp;
    }
}
~~~



# ğŸˆğŸˆé«˜çº§\_å¼‚å¸¸

## 1ã€é›†åˆçš„foreaché—®é¢˜

~~~java
for (String s : list) { // åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šé»˜è®¤è°ƒç”¨
            System.out.println(s);
        }
~~~

ä¼šé»˜è®¤è°ƒç”¨Iteratorï¼Œæ‰€ä»¥è‡ªå·±å†™çš„MyArrayList<T> implements List<T>ä¸­è¦é‡å†™ä¸€ä¸ªItr<T> implements Iterator<T>ï¼Œæ¥å®ç°hasNextå’Œnextï¼Œå†åˆ©ç”¨ä¸‹é¢ä»£ç æ¥è°ƒç”¨

~~~java
public Iterator<T> iterator() {
        return new Itr<>();
    }
~~~



## 2ã€å¼‚å¸¸

### 2.1åˆ†ç±»

#### 2.1.1 çˆ¶ç±»ä¸å­ç±»                 

![image-20220722210118993](images/image-20220722210118993.png)



- **Errorç±»**ï¼šJVMå†…éƒ¨çš„ä¸¥é‡é—®é¢˜ã€‚æ— æ³•æ¢å¤ã€‚ç¨‹åºäººå‘˜ä¸ç”¨å¤„ç†ã€‚

- **Exceptionç±»**ï¼šæ™®é€šçš„é—®é¢˜ã€‚é€šè¿‡åˆç†çš„å¤„ç†ï¼Œç¨‹åºè¿˜å¯ä»¥å›åˆ°æ­£å¸¸æ‰§è¡Œæµç¨‹ã€‚è¦æ±‚ç¼–ç¨‹äººå‘˜è¦è¿›è¡Œå¤„ç†ã€‚

#### 2.1.2 æ£€æŸ¥å’Œæœªæ£€æŸ¥å¼‚å¸¸

~~~java
Javaä¸­Exceptionåˆåˆ†ä¸º2ç§å¼‚å¸¸ç±»å‹
- `RuntimeException `ä¸å—æ£€æµ‹å¼‚å¸¸ï¼ˆä¸å¤ªä¸¥é‡çš„é—®é¢˜ï¼‰ï¼Œå°±ç®—æ˜¯æœ‰è¿™ç§å‘ç”Ÿé—®é¢˜çš„å¯èƒ½æ€§ï¼Œæ—¢ä¸è¦try-catchï¼Œä¹Ÿä¸éœ€è¦throws
- `éRuntimeExceptionçš„å­ç±»` å—æ£€æµ‹å¼‚å¸¸ï¼ˆè¾ƒä¸ºä¸¥é‡çš„é—®é¢˜ï¼‰ï¼Œç¼–è¯‘å™¨å¼ºåˆ¶è¦æ±‚å¼€å‘äººå‘˜é¢å¯¹è¿™ä¸ªé—®é¢˜ï¼š
  	//1ã€è‡ªå·±æ¥å¤„ç†ï¼Œç¼–å†™try-catch
   		// 2ã€è‡ªå·±ä¸å¤„ç†ï¼Œåœ¨æ–¹æ³•ä¸Šæ·»åŠ throws XxxExceptionï¼Œå®ƒçš„ç”¨æ„æ˜¯å‘Šè¯‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„äººï¼Œè¿™ä¸ªæ–¹æ³•ä¼šæœ‰å‘ç”Ÿé”™è¯¯çš„é£é™©ï¼Œä½ éœ€è¦æ³¨æ„
~~~

ä¸å¤ªç›´è§‚ï¼Œæˆ‘ç›´æ¥ç»¼åˆä¸‹

**å¯¹æœªæ£€æŸ¥çš„å¼‚å¸¸(RuntimeException)çš„å‡ ç§å¤„ç†æ–¹å¼ï¼š**

- æ•è·
- ç»§ç»­æŠ›å‡º
- ä¸å¤„ç†

**å¯¹æ£€æŸ¥çš„å¼‚å¸¸ï¼Œé™¤äº†RuntimeExceptionï¼Œå…¶ä»–çš„å¼‚å¸¸éƒ½æ˜¯æ£€æŸ¥å¼‚å¸¸çš„å‡ ç§å¤„ç†æ–¹å¼ï¼š**

- ç»§ç»­æŠ›å‡ºï¼Œæ¶ˆæçš„æ–¹æ³•ï¼Œä¸€ç›´å¯ä»¥æŠ›åˆ°javaè™šæ‹Ÿæœºæ¥å¤„ç†
- ç”¨tryâ€¦catchæ•è·



#### 2.1.3 æ–¹æ³•è¦†ç›–

> å­ç±»çš„è¦†ç›–æ–¹æ³•ä¸èƒ½æ¯”çˆ¶ç±»çš„è¢«è¦†ç›–æ–¹æ³•æŠ›å‡ºæ›´å¤šå¼‚å¸¸

ä¾‹å­

~~~java
//ä¸æŠ¥é”™
class MySub2 extends Super {
    public void ma() throws EOFException, FileNotFoundException {

    }
}
class Super{
   public void ma()throws IOException{

    }
}
//æŠ¥é”™
class MySuper{
    public void m1() throws IOException{}
}
class MySub extends MySuper {
    public void m1() throws EOFException {}
}
//è¿™é‡ŒæŠ¥é”™ï¼Œæ ¹æ®å¼‚å¸¸åˆ†ç±»ï¼Œç¬”è®°2.1çš„å›¾ï¼ŒEOFExceptionä¸åŒ…æ‹¬FileNotFoundExceptionï¼Œå±äºåŒæ°´å¹³
class MySub2 extends MySub{
    public void m1() throws  FileNotFoundException {}
}
~~~







### 2.2ä½¿ç”¨æ–¹æ³•

#### 2.2.1 exception+try-catch

**tryè¡¨ç¤ºå®šä¹‰ä¸€ä¸ªå—åˆ°ç›‘æ§ã€å—åˆ°ä¿æŠ¤çš„ç¨‹åºä»£ç å—**ï¼›

catchä¸tryé¥ç›¸å‘¼åº”ï¼Œå®šä¹‰å½“try blockï¼ˆå—ç›‘æ§çš„ç¨‹åºå—ï¼‰å‡ºç°å¼‚å¸¸æ—¶ï¼Œé”™è¯¯å¤„ç†çš„ç¨‹åºæ¨¡å—ï¼Œå¹¶ä¸”æ¯ä¸ªcatch blockéƒ½å¸¦ä¸€ä¸ªå‚æ•°ï¼ˆç±»ä¼¼äºå‡½æ•°å®šä¹‰æ—¶çš„æ•°é‚£æ ·ï¼‰ï¼Œè¿™ä¸ªå‚æ•°çš„æ•°æ®ç±»å‹ç”¨äºå¼‚å¸¸å¯¹è±¡çš„æ•°æ®ç±»å‹è¿›è¡ŒåŒ¹é…ï¼›

~~~java
public class TestException {
    public static void main(String[] args) {
        try {
            int num=10/0;

        }catch (Exception e){
            e.printStackTrace();
        }
        System.out.println("123");
    }
~~~



#### 2.2.2 finallyè¯­å¥å—

finallyè¯­å¥å—æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œã€‚

~~~java
  public static void main(String[] args) {
         System.out.println(test(false)); 
    }     
static int test(boolean flag) {
         try {
             System.out.println(0);
             if (flag) {
                 throw new Exception("æ‰‹å·¥å¼‚å¸¸");
             }
             System.out.println(1);
             return 1;
         } catch (Exception e) {
             System.out.println(2);
         } finally {
             System.out.println(33); // æ— è®ºå‘ç”Ÿå¼‚å¸¸ä¸å¦ï¼Œéƒ½ä¸€å®šä¼šæ‰§è¡Œ
             return 2;
         }        
     }
//ç»“æœ	flagä¸ºfalse
//0
//1
//2
//33
//2
~~~





#### 2.2.3 thorwæŠ›å‡ºå¼‚å¸¸

æ‰‹åŠ¨æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼š**throw** new XXXXXX

RuntimeException

~~~java
 if (!("admin".equals(name) && "admin".equals(pwd))) {
             // æ‰‹å·¥åˆ¶é€ ä¸€ä¸ªå¼‚å¸¸ï¼Œè¾¾åˆ°ä¸­æ–­ç¨‹åºè¿è¡Œçš„æ•ˆæœ
             throw new RuntimeException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
}
~~~

#### 2.2.4 throwsæ–¹æ³•å£°æ˜å¼‚å¸¸

å£°æ˜è¯¥æ–¹æ³•æœ‰å¯èƒ½ä¼šæŠ›å‡ºæŸç§ç±»å‹çš„å¼‚å¸¸

å°†å½“å‰æ–¹æ³•ä¸­çš„å¼‚å¸¸äº¤ç»™è°ƒç”¨è€…å¤„ç†**ï¼šthrows** Exception

æŠ›çš®çƒï¼Œä¸å¤„ç†ç»™ä¸Šå±‚

~~~java
public class Account {
    public void deposit(float value) throws FileNotFoundException {    
        var reader = new FileReader("xxx.md");
   }
}
~~~

#### 2.2.5 è‡ªå®šä¹‰å¼‚å¸¸

~~~java
class ValidateRuntimeException extends RuntimeException{
    ValidateRuntimeException(String msg) {
        super(msg);
    }
}
class NetworkRuntimeException extends RuntimeException{
    NetworkRuntimeException(String msg) {
        super(msg);
    }
}
~~~



### 2.3 åœºæ™¯åº”ç”¨

éœ€æ±‚ï¼šå‡å¦‚ç”¨æˆ·çš„éœ€æ±‚ï¼šå³ä½¿æœ‰ä¸€ä¸ªæ–‡ä»¶å­˜åœ¨é—®é¢˜ï¼Œä¹Ÿä¸è¦ä¸­æ–­æ•´æ‰¹æ ¡éªŒ

~~~java
package com.think.lv2.exception;
import java.util.ArrayList;
import java.util.List;
public class Main {
    public static void main(String[] args) throws Exception {
        
        String[] arr = {"a", "bxx", "c"};
  		//ç¨‹åºä¸»ä½“
        //è¿”å›é”™è¯¯çš„é›†åˆ
        List<String> errors = batchValidate(arr);
      
        System.out.println("æ‰¹é‡å¤„ç†å®Œæ¯•");
        System.out.println(errors);

        // æ‰¹é‡å¤„ç†æ€»ç»“
        // 1 OK
        // 2 ERROR:
        // 3 ...
    }

    // å‡å¦‚ç”¨æˆ·çš„éœ€æ±‚ï¼šå³ä½¿æœ‰ä¸€ä¸ªæ–‡ä»¶å­˜åœ¨é—®é¢˜ï¼Œä¹Ÿä¸è¦ä¸­æ–­æ•´æ‰¹æ ¡éªŒ
    private static List<String> batchValidate (String[] arr) {
        List<String> errors = new ArrayList<>();
        for (String s : arr) {
            try {
                //é•¿åº¦å¤§äº1æŠ›å‡ºå¼‚å¸¸
                validateItem(s); // bxxæŠ›å‡ºäº†ä¸€ä¸ªé”™è¯¯
               //count==1æŠ›å‡ºå¼‚å¸¸
                saveItem(s);
            } catch (Exception e) { 
                // å¦‚æœtryé‡Œé¢å‘ç”Ÿçš„é”™è¯¯ï¼Œæ˜¯å‚æ•°å£°æ˜çš„ç±»å‹ï¼Œå°±ä¼šæ‰§è¡Œcatchä¸­çš„é€»è¾‘
                // åˆ¤æ–­é”™è¯¯å‚æ•°å£°æ˜çš„ç±»å‹
                if(e instanceof NetworkRuntimeException){
                    errors.add(e.getMessage());
                }
                if(e instanceof ValidateRuntimeException){
                    errors.add(e.getMessage());
                }
                e.printStackTrace();
            }
        }
        System.out.println("æ‰¹é‡æ ¡éªŒå®Œæ¯•ï¼");
        return errors;
    }

    static int count;
    
    static void saveItem(String s) {
        if (count++ == 1) throw new NetworkRuntimeException("ç½‘ç»œé“¾æ¥é”™è¯¯");
        System.out.println("æŠŠè§†é¢‘ä¿å­˜èµ·æ¥");
        // ç½‘ç»œè¿æ¥çš„é—®é¢˜
    }

    private static void validateItem(String s) { // è¸¢çš®çƒ
        if (s.length() > 1) {
            throw new ValidateRuntimeException("å­—ç¬¦ä¸²é•¿åº¦ä¸ç¬¦åˆè¦æ±‚");
            // System.out.println("ä¸ç¬¦åˆè¦æ±‚");
        } else {
            System.out.println(s + "æ˜¯åˆä¹è¦æ±‚çš„");
        }
    }
    // æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®éœ€æ±‚çš„ä¸šåŠ¡é€»è¾‘æ¥è¿›è¡Œåˆ¤æ–­ï¼Œå†³å®šæ˜¯å¦ä¸­æ–­ç¨‹åºè¿è¡Œ

}
//ä¸¤ä¸ªè‡ªå®šä¹‰å¼‚å¸¸
class ValidateRuntimeException extends RuntimeException{
    ValidateRuntimeException(String msg) {
        super(msg);
    }
}
class NetworkRuntimeException extends RuntimeException{
    NetworkRuntimeException(String msg) {
        super(msg);
    }
}

//ç»“æœ
aæ˜¯åˆä¹è¦æ±‚çš„
æŠŠè§†é¢‘ä¿å­˜èµ·æ¥
com.think.lv2.exception.ValidateRuntimeException: å­—ç¬¦ä¸²é•¿åº¦ä¸ç¬¦åˆè¦æ±‚
	at com.think.lv2.exception.Main.validateItem(Main.java:82)
	at com.think.lv2.exception.Main.batchValidate(Main.java:55)
	at com.think.lv2.exception.Main.main(Main.java:34)
cæ˜¯åˆä¹è¦æ±‚çš„
com.think.lv2.exception.NetworkRuntimeException: ç½‘ç»œé“¾æ¥é”™è¯¯
	at com.think.lv2.exception.Main.saveItem(Main.java:75)
	at com.think.lv2.exception.Main.batchValidate(Main.java:56)
	at com.think.lv2.exception.Main.main(Main.java:34)
æ‰¹é‡æ ¡éªŒå®Œæ¯•ï¼
æ‰¹é‡å¤„ç†å®Œæ¯•
[å­—ç¬¦ä¸²é•¿åº¦ä¸ç¬¦åˆè¦æ±‚, ç½‘ç»œé“¾æ¥é”™è¯¯]

//ç»†èŠ‚ï¼Œä¸ºä»€ä¹ˆcæ²¡æœ‰è¾“å‡ºâ€œæŠŠè§†é¢‘ä¿å­˜èµ·æ¥â€
//å› ä¸ºif (count++ == 1) ä¸ºfalseæ—¶ä¸ä¼šæ‰§è¡Œ++
~~~



# ğŸˆğŸˆé«˜çº§\_IO

## 1 æµ‹è¯•File

~~~java
public static void main(String[] args) {
        String path="D:\\java111\\123\\work";
        testFile(path);
        }
static void testFile(String path) {
        File file = new File(path);
        System.out.println(file.isFile());	//æ˜¯å¦ä¸ºæ–‡ä»¶
        System.out.println(file.isDirectory());//æ˜¯å¦ä¸ºç›®å½•
    }
//ç»“æœ
false
true
~~~



## 2 ç»å¯¹è·¯å¾„ä¸ç›¸å¯¹è·¯å¾„

- ç»å¯¹è·¯å¾„ï¼šç»å¯¹è·¯å¾„å°±æ˜¯ä½ çš„ä¸»é¡µä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•åœ¨ç¡¬ç›˜ä¸ŠçœŸæ­£çš„è·¯å¾„ï¼Œ(URLå’Œç‰©ç†è·¯å¾„)ä¾‹å¦‚ï¼šC:/xyz/test.txt ä»£è¡¨äº†test.txtæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚http://www.sun.com/index.htmä¹Ÿä»£è¡¨äº†ä¸€ä¸ªURLç»å¯¹è·¯å¾„ã€‚

- ç›¸å¯¹è·¯å¾„ï¼šç›¸å¯¹ä¸æŸä¸ªåŸºå‡†ç›®å½•çš„è·¯å¾„ã€‚åŒ…å«Webçš„ç›¸å¯¹è·¯å¾„ï¼ˆHTMLä¸­çš„ç›¸å¯¹ç›®å½•ï¼‰ï¼Œä¾‹å¦‚ï¼šåœ¨Servletä¸­ï¼Œ"/"ä»£è¡¨Webåº”ç”¨çš„è·Ÿç›®å½•ã€‚å’Œç‰©ç†è·¯å¾„çš„ç›¸å¯¹è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼š"./" ä»£è¡¨å½“å‰ç›®å½•,"../"ä»£è¡¨ä¸Šçº§ç›®å½•ã€‚è¿™ç§ç±»ä¼¼çš„è¡¨ç¤ºï¼Œä¹Ÿæ˜¯å±äºç›¸å¯¹è·¯å¾„ã€‚

	â€‹	

## 3 æ€ä¹ˆå¿«é€Ÿåœ°åœ¨ideaä¸­æ‰¾ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„

ä¸Šå›¾

ç¬¬ä¸€æ­¥ï¼Œå³é”®æ–‡ä»¶

![image-20220723091223917](images/image-20220723091223917.png)

ç¬¬äºŒæ­¥ï¼Œé€‰æ‹©copy path

![image-20220723091307527](images/image-20220723091307527.png)

ç¬¬ä¸‰æ­¥ï¼Œå¾—å‡ºç­”æ¡ˆ

![image-20220723091409891](images/image-20220723091409891.png)



## 4 æµçš„åˆ†ç±»

1.æŒ‰ç…§è¾“å…¥è¾“å‡ºåˆ†ä¸º è¾“å…¥æµ å’Œ è¾“å‡ºæµ
2.æŒ‰ç…§ä¼ è¾“å•ä½åˆ†ä¸º å­—èŠ‚æµ å’Œ å­—ç¬¦æµ
3.æŒ‰ç…§åŠŸèƒ½åˆ†ä¸º èŠ‚ç‚¹æµï¼ˆä½çº§æµï¼‰ å’Œ å¤„ç†æµï¼ˆé«˜çº§æµï¼‰

- å¸¸ç”¨çš„èŠ‚ç‚¹æµ
  æ–‡ ä»¶ **FileInputStream FileOutputStrean** FileReader FileWriter æ–‡ä»¶è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµã€‚
  å­—ç¬¦ä¸² StringReader StringWriter å¯¹å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµã€‚
  æ•° ç»„ ByteArrayInputStream ByteArrayOutputStreamCharArrayReader CharArrayWriter å¯¹æ•°ç»„è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµï¼ˆå¯¹åº”çš„ä¸å†æ˜¯æ–‡ä»¶ï¼Œè€Œæ˜¯å†…å­˜ä¸­çš„ä¸€ä¸ªæ•°ç»„ï¼‰ã€‚
  ç®¡ é“ PipedInputStream PipedOutputStream PipedReaderPipedWriterå¯¹ç®¡é“è¿›è¡Œå¤„ç†çš„èŠ‚ç‚¹æµã€‚

- å¸¸ç”¨å¤„ç†æµï¼ˆå…³é—­å¤„ç†æµä½¿ç”¨å…³é—­é‡Œé¢çš„èŠ‚ç‚¹æµï¼‰
  ç¼“å†²æµï¼š**BufferedInputStrean BufferedOutputStream BufferedReader BufferedWriter** å¢åŠ ç¼“å†²åŠŸèƒ½ï¼Œé¿å…é¢‘ç¹è¯»å†™ç¡¬ç›˜ã€‚
  è½¬æ¢æµï¼šInputStreamReader OutputStreamReader å®ç°å­—èŠ‚æµå’Œå­—ç¬¦æµä¹‹é—´çš„è½¬æ¢ã€‚
  æ•°æ®æµ DataInputStream DataOutputStream ç­‰-æä¾›å°†åŸºç¡€æ•°æ®ç±»å‹å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæˆ–è€…è¯»å–å‡ºæ¥.

  

![image-20220723092004867](images/image-20220723092004867.png)

## 5 Fileå¸¸ç”¨API

- file.mkdir() åˆ›å»ºæ–‡ä»¶å¤¹
- file.delete() åˆ é™¤
- file.getTotalSpace() è·å–æ–‡ä»¶å¤§å°
- file.getParentFile() è·å–çˆ¶èŠ‚ç‚¹
- file.exists() æ˜¯å¦å­˜åœ¨

![image-20220723084327722](images/image-20220723084327722.png)

## 6 æ˜¾ç¤ºç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶

~~~java
public static void main(String[] args) {
        treeWalk(path);
        copy();
    }
  private static void treeWalk(String path) {
        File file = new File(path);
      //å¦‚æœä¸ºæ–‡ä»¶å°±æ‰“å°å‡ºæ¥
        if (file.isFile()) System.out.println(file.getName());
        else {
        //å¦åˆ™é€’å½’éå†å­ç›®å½•
            File[] files = file.listFiles();
            for (File children : files) {
                treeWalk(children.getAbsolutePath());//ç»å¯¹è·¯å¾„
            }
        }

    }
//ç»“æœ
COMMIT_EDITMSG
config
description
FETCH_HEAD
HEAD
applypatch-msg.sample
commit-msg.sample
fsmonitor-watchman.sample
post-update.sample
............ç•¥
~~~



## 7 åŒ¿åå†…éƒ¨ç±»+è¿‡æ»¤å™¨FilenameFilter

æ¥å£åå°±æ˜¯ç±»å‹ï¼Œè€Œ{}ä¸­çš„é€»è¾‘ï¼Œå°±æ˜¯ä¸€ä¸ªåŠ¨æ€ä»£ç å—ï¼Œé‡Œé¢æ˜¯æ¥å£ä¸­æ‰€æœ‰æŠ½è±¡æ–¹æ³•çš„å…·ä½“å®ç°

```java
//å°†åç¼€ä¸º.javaçš„æ–‡ä»¶è¾“å‡º  
static FilenameFilter filter = new FilenameFilter() {
         @Override
         public boolean accept(File dir, String name) {
             if (name.endsWith(".java"))
                 System.out.println(">>>>" + name);
             return false;
         }
     };
```

- Lambda è¡¨è¾¾å¼å®ç°

~~~java
  static FilenameFilter filter = (dir, name) -> {
        if (name.endsWith(".java"))
            System.out.println(">>>>" + name);
        return true;
    };
~~~

## 8 å­—èŠ‚æµå®ç°copy

### 8.1 FileInputStream+FileOutputStream

![image-20220723085026185](images/image-20220723085026185.png)

~~~java
 static void copy() {
        String src = "/Users/cuesky/Desktop/adv.mp4";
        String dest = "/Users/cuesky/Desktop/advCopy.mp4";
        try (
        // åªè¦æ‹¬å·ä¸­çš„ç»„ä»¶å®ç°äº†Closeableæ¥å£ï¼ŒJVMä¼šè‡ªåŠ¨å¸®ç¨‹åºæ¥å…³é—­
        // in.close() out.close()
        // å®ƒä»¬å¹¶éæ˜¯ä¸ºäº†é‡Šæ”¾JVMä¸­ç›¸åº”çš„å†…å­˜ï¼Œå› ä¸ºJVMä¸­æœ‰GCå¯ä»¥è‡ªåŠ¨ç®¡ç†
        // ä¸»è¦æ˜¯ä¸ºäº†ï¼ŒJavaç¨‹åºç”³è¯·çš„ç¡¬ä»¶èµ„æºï¼Œé€šçŸ¥å®ƒä»¬å¯ä»¥é‡Šæ”¾äº†
        // å¦‚æœæ²¡æœ‰é‡Šæ”¾çš„è¯ï¼Œä¼šå‘ç”Ÿç³»ç»Ÿå´©æºƒï¼Œå› ä¸ºæ¯”å¦‚OSä¸€èˆ¬éƒ½æœ‰åŒæ—¶å¯ä»¥æ‰“å¼€å¤šå°‘ä¸ªæ–‡ä»¶çš„é™åˆ¶ï¼ˆ65536ï¼‰
       InputStream in = Files.newInputStream(Paths.get(src));
       OutputStream out = new FileOutputStream(dest);
       MyResource r = new MyResource()
        ) {
      // int b = in.read();// ä»¥å­—èŠ‚ä¸ºå•ä½è¯»å–æ–‡ä»¶
      // out.write(b); // ä»¥å­—èŠ‚ä¸ºå•ä½è¾“å‡ºæ•°æ®åˆ°æ–‡ä»¶ä¸­
      byte[] buffer = new byte[1024]; // ä»¥1kbä¸ºç¼“å†²æ¥è¯»å–
      int len; // ç”¨æ¥è®°å½•inå®é™…è¯»å–çš„æ–‡ä»¶é•¿åº¦
     while (  (len = in.read(buffer)) != -1) {
                // å‚æ•°2ï¼šä»bufferçš„ç¬¬å‡ ä¸ªä½ç½®å¼€å§‹è¯»å–
                // å‚æ•°3ï¼šä¸€å…±è¯»å–å¤šå°‘åˆ°æ–°æ–‡ä»¶ä¸­å»
                out.write(buffer, 0, len);
            }
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
~~~

### 8.2 BufferedInputStream+BufferedOutputStream(æœ‰ç¼“å­˜åŒºæ›´å¿«)

![image-20220723084904070](images/image-20220723084904070.png)

~~~java
 static void bufferd() {
        String src = "/Users/cuesky/Desktop/adv.mp4";
        String dest = "/Users/cuesky/Desktop/advCopy.mp4";
        try (
                InputStream in = new FileInputStream(src);
                BufferedInputStream bis = new BufferedInputStream(in); // å¸¦å†…éƒ¨ç¼“å†²çš„è¾“å…¥æµ
                OutputStream out = new FileOutputStream(dest);
                BufferedOutputStream bos = new BufferedOutputStream(out);
        ) {
            byte[] buffer = new byte[1024];
            int len;
            while ((len = bis.read(buffer)) != -1) {
                bos.write(buffer, 0, len);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
~~~



## 9 å­—ç¬¦æµå®ç°å†™æ–‡ä»¶

BufferedWriter+BufferedWriter

- å…¶ä¸­ BufferedWriter writer = new BufferedWriter(new FileWriter(src, true));çš„trueå¯ä»¥å®ç°ç»­å†™

~~~java
append â€“ boolean if true, then data will be written to the end of the file rather than the beginning.
~~~

ä»£ç 

~~~java
  static void charWrite() {
        String src = "/Users/cuesky/Desktop/a1.txt";
        Scanner scanner = new Scanner(System.in); // ç›´åˆ°ç”¨æˆ·è¾“å…¥qï¼Œå°±é€€å‡ºï¼ŒåŒæ—¶æŠŠå‰é¢è¾“å…¥ç»™æ§åˆ¶å°çš„æ‰€æœ‰ä¿¡æ¯ï¼Œéƒ½è®°å½•åˆ°æ–‡ä»¶ä¸­å»
        try (
                BufferedWriter writer = new BufferedWriter(new FileWriter(src, true));
               // Reader reader = new FileReader("");
                //BufferedReader br = new BufferedReader(reader)
        ) {
            // writer.newLine(); // å†™ä¸€ä¸ªç©ºè¡Œ
            String content;
            while (!(content = scanner.next()).equals("q")) {
                writer.write(content + "\r\n");
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
~~~



## 10 åºåˆ—åŒ–Serializable

### 10.1 å®šä¹‰

å®šä¹‰ï¼š åºåˆ—åŒ–ï¼Œå°±æ˜¯æŠŠä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œæ‹†åˆ†æˆæœ€å°çš„å•ä½(byte)ï¼Œä»¥ä¾¿ä»Šåæ•°æ®å­—èŠ‚æµçš„å½¢å¼å­˜å‚¨åœ¨ç£ç›˜ä¸­æˆ–è€…æ˜¯é€šè¿‡ç½‘ç»œåè®®å‘é€å¦ä¸€æ–¹ï¼Œå®ƒæ˜¯æ•°æ®å­˜å‚¨å’Œå‘é€çš„ä¸€ç§é‡è¦æŠ€æœ¯



### 10.2 æ“ä½œæ­¥éª¤

1ã€åˆ›å»ºå¯¹è±¡ï¼Œå¼•ç”¨ç±»å‹

æ³¨æ„ï¼š

- éœ€è¦è¢«åºåˆ—åŒ–çš„ç±»ä¸€å®šè¦å®ç°java.io.Serializableæ¥å£ï¼šå› ä¸ºObjectOutputStreamåœ¨åºåˆ—åŒ–çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªç±»å‹æ£€æµ‹

- serialVersionUIDç›¸å½“äºä¸€ä¸ªé˜²ä¼ªç¼–ç ï¼Œä½œç”¨æ˜¯ä¸ºäº†åœ¨åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œé¢„é˜²æœ‰äººç¯¡æ”¹å­—èŠ‚ç ä¸­çš„ä¿¡æ¯

~~~java
class Person implements Serializable {

    private static final long serialVersionUID = 2263583963027808782L; // å£°æ˜è¿™ä¸ªç±»çš„å®ä¾‹æ˜¯å¯ä»¥è¢«åºåˆ—åŒ–çš„

    // JVMåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ï¼Œä¼šå»è¯†åˆ«è¿™ä¸ªâ€œé˜²ä¼ªç¼–ç â€ï¼Œä½œç”¨æœ‰ç‚¹ç±»ä¼¼äºMD5æ ¡éªŒ
//    private static final long serialVersionUID = 1L;

    String name;

    @Override
    public String toString() {
        return "Person{" +
                "name='" + name + '\'' +
                '}';
    }

    public Person(String name) {
        this.name = name;
    }
}
~~~



2ã€å†™å…¥æ–‡ä»¶

~~~java
 public static void main(String[] args) {

        Person p1 = new Person("Jack");
        System.out.println(p1.hashCode());
        serializable(p1);

        unSerializable();
    }

    // å»ºä¸€ä¸ªå¯¹è±¡çš„æ•°æ®æ‹†åˆ†æˆå­—èŠ‚ï¼Œæœ‰åºçš„å†™å…¥åˆ°æ–‡ä»¶ä¸­å»
    private static void serializable(Person p1) {
        Path path = Paths.get("c:/Users/ThinkAboutAI/Desktop/person.data");
        try ( // åªè¦å®ç°äº†Closeableæ¥å£çš„å®ä¾‹éƒ½ä¼šè‡ªåŠ¨å…³é—­
              OutputStream out = Files.newOutputStream(path);
              ObjectOutputStream oos = new ObjectOutputStream(out)
        ) {
            oos.writeObject(p1);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private static void unSerializable() {
        try (
                ObjectInputStream ois = new ObjectInputStream(Files.newInputStream(Paths.get("c:/Users/ThinkAboutAI/Desktop/person.data")))
        ) {
            Object obj = ois.readObject();
            if (obj instanceof Person) {
                Person person = (Person) obj;
                System.out.println(person.hashCode());
                System.out.println(person);
            }
        } catch (IOException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            throw new RuntimeException(e);
        }
    }
~~~









# ğŸˆğŸˆç½‘ç»œç¼–ç¨‹

## 1ã€IPã€Portã€åŒå·¥ç­‰å®šä¹‰

- Internet P(IP)ï¼šæ¯ä¸€å°ç¡¬ä»¶ï¼ˆèƒ½æ¥å…¥ç½‘ç»œçš„ï¼‰åœ¨ç½‘ç»œä¸Šçš„ä¸€ä¸ªå”¯ä¸€åœ°å€æ ‡è¯†ï¼Œå…¶å®ƒè®¾å¤‡èƒ½ç›´æ¥é€šè¿‡IPæ¥å¯¹è¯¥è®¾å¤‡å‘èµ·è¿æ¥è¯·æ±‚

- Portï¼šç«¯å£ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†åŒºåˆ†ä¸åŒçš„åº”ç”¨ç¨‹åºå¦‚ä½•æ¥æ¥å—ç½‘ç»œæ•°æ®åŒ…
- å…¨åŒå·¥ï¼šå®¢æˆ·ç«¯åœ¨ç»™æœåŠ¡å™¨ç«¯å‘é€ä¿¡æ¯çš„åŒæ—¶ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥ç»™å®¢æˆ·ç«¯å‘é€ä¿¡æ¯ï¼›
- åŠåŒå·¥ï¼šå®¢æˆ·ç«¯å¯ä»¥ç»™æœåŠ¡ç«¯å‘é€ä¿¡æ¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿå¯ä»¥ç»™å®¢æˆ·ç«¯å‘é€ä¿¡æ¯ï¼Œä½†æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸èƒ½åŒæ—¶å‘ï¼›

- Transform verb. ä¼ è¾“

- Control æ§åˆ¶

- Protocol åè®®



## 2ã€ç½‘ç»œæ¨¡å‹

### 2.1 OSI

- æ¨¡å‹ï¼š

![image-20220725173441710](images/image-20220725173441710.png)

- åŠŸèƒ½ï¼š

![image-20220725173506928](images/image-20220725173506928.png)



### 2.2 TCP/IP

- æ¨¡å‹

![image-20220725173557155](images/image-20220725173557155.png)

- åŠŸèƒ½

![image-20220725173607920](images/image-20220725173607920.png)



## 3ã€TCP

- ä¼ è¾“å±‚åè®®

![image-20220725172555937](images/image-20220725172555937.png)



### 2.1 Server

~~~java
public class Server {

    public static void main(String[] args) {
        

        try ( // å¦‚æœå¼€å‘äººå‘˜è¦æ‰‹å·¥å…³é—­èµ„æºï¼Œä¸€å®šè¦æŒ‰ç…§FILOè§„åˆ™æ¥å…³é—­å’Œé‡Šæ”¾èµ„æº
            // åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„socketå¯¹è±¡
              ServerSocket ss = new ServerSocket(8080);
              // å¯åŠ¨ç›‘å¬æœåŠ¡ï¼šç­‰å¾…å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚
              // å¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°ä»»ä½•è¯·æ±‚ï¼Œç¨‹åºå°†ä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œ
              Socket socket = ss.accept(); // æ‰“é€šäº†ä¸€ä¸ªæ•°æ®æµçš„åŒå‘ç®¡é“
              // æ¥æ”¶æ•°æ®
              InputStream in = socket.getInputStream();
//              OutputStream out = socket.getOutputStream()
        ) {
            // åˆ›å»ºä¸€ä¸ªç¼“å†²å¯¹è±¡
            byte[] buffer = new byte[1024];
            int len;

            while ((len = in.read(buffer)) != -1) { // è¯»å–åˆ°æ•°æ®æµçš„æœ«å°¾

                String msg = new String(buffer, 0, len);
                if ("q".equalsIgnoreCase(msg)) break; // å½“å®¢æˆ·ç«¯å‘é€äº†Qæˆ–qï¼Œå°±å…³é—­å’Œé€€å‡ºç¨‹åº

                System.out.println("Server:" + msg);

//                out.write();
            }

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

}
~~~



### 2.2 Client

æ³¨æ„Clientçš„outæ²¡closeæœåŠ¡å™¨ç«¯å°±ä¸ä¼šåœæ­¢ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¤šæ¬¡å‘é€ä¿¡æ¯

~~~java
public class Client {
    public static void main(String[] args) {
        try (
                // åœ¨è¿æ¥æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå¿…é¡»è¦çŸ¥é“å¯¹æ–¹çš„IPå’ŒPORTä¿¡æ¯
                // åœ¨newçš„æ—¶å€™ï¼Œä¸å…‰å·²ç»åˆ›å»ºäº†å®ä¾‹ï¼Œè€Œä¸”å·²ç»å‘é€äº†connectè¿™ä¸ªåŠ¨ä½œ
                Socket socket = new Socket(InetAddress.getByName("127.0.0.1"), 8080);
                OutputStream out = socket.getOutputStream()
        ) {
            Console console = new Console();
            String msg;
            while (!"q".equalsIgnoreCase(msg = console.readString("è¯·è¾“å…¥è¦å‘é€çš„æ¶ˆæ¯ï¼š"))) {
                out.write(msg.getBytes());
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
~~~



### 2.3 HttpServer

~~~java
public static void main(String[] args) {
        // åˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„socketå¯¹è±¡

        try ( // å¦‚æœå¼€å‘äººå‘˜è¦æ‰‹å·¥å…³é—­èµ„æºï¼Œä¸€å®šè¦æŒ‰ç…§FILOè§„åˆ™æ¥å…³é—­å’Œé‡Šæ”¾èµ„æº
              ServerSocket ss = new ServerSocket(8080);
              // å¯åŠ¨ç›‘å¬æœåŠ¡ï¼šç­‰å¾…å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚
              // å¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°ä»»ä½•è¯·æ±‚ï¼Œç¨‹åºå°†ä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œ
              Socket socket = ss.accept(); // æ‰“é€šäº†ä¸€ä¸ªæ•°æ®æµçš„åŒå‘ç®¡é“
              // æ¥æ”¶æ•°æ®
//              InputStream in = socket.getInputStream();
              OutputStream out = socket.getOutputStream();
        ) {
            System.out.println("æ¥æ”¶åˆ°è¯·æ±‚");
            String msg = "<html><body><h1>Hello Http!</h1></body></html>";
            out.write("HTTP/1.1 200 OK\r\n".getBytes()); // å‘Šè¯‰å®¢æˆ·ç«¯çš„è¯·æ±‚æ¥æ”¶æˆåŠŸ
            out.write("Content-Type: text/html;charset=utf-8\r\n".getBytes()); // æˆ‘å‘ä½ å‘é€çš„æ•°æ®çš„MIME
            out.write("Connection: keep-alive\r\n".getBytes());
//            writer.write("Content-Length: " + msg.length() + "\r\n"); // æˆ‘å‘ä½ å‘é€çš„æ•°æ®çš„MIME
            out.write("\r\n".getBytes()); // åœ¨å“åº”å¤´å’Œå…·ä½“çš„å†…å®¹ä¹‹é—´ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºè¡Œ
            out.write(msg.getBytes());
            out.flush();
//            out.write("\r\n".getBytes());
            Thread.sleep(10000); // æ¨¡æ‹ŸæœåŠ¡å™¨ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆå®¢æˆ·ç«¯éœ€è¦æŠŠå‘é€çš„æ•°æ®ä¸‹è½½å®Œï¼‰
        } catch (IOException e) {
            e.printStackTrace();
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
}
~~~





## 4ã€UDP

### 4.1 Receiver

~~~java
public class Receiver {
    public static void main(String[] args) {
        // åˆ›å»ºæ•°æ®æŠ¥æ–‡çš„socket
        try (
                DatagramSocket ds = new DatagramSocket(8080);
        ) {
            byte[] buffer = new byte[1024]; // 1kb
            // çœŸæ­£ç”¨æ¥ç››æ”¾æ•°æ®çš„æ•°æ®åŒ…è£¹
            DatagramPacket dp = new DatagramPacket(buffer, buffer.length);
            // å½“bufferè¢«æ¥æ”¶çš„æ•°æ®å¡«å……æ»¡çš„æ—¶å€™ï¼Œå°±ä¼šreturn
            ds.receive(dp); // å½“æ²¡æœ‰æ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™ï¼Œä¼šä¸€ç›´é˜»å¡

            // æœåŠ¡å™¨ç«¯æ˜¯å¯ä»¥è·å–åˆ°å®¢æˆ·ç«¯çš„åœ°å€ä¿¡æ¯
//            dp.getAddress(); // è·å–å¯¹æ–¹IP
//            dp.getPort(); // è·å–ç«¯å£

            int len = dp.getLength(); // çœŸæ­£çš„æ¥æ”¶åˆ°æ•°æ®çš„é•¿åº¦
            byte[] data = dp.getData(); // å®ƒçš„é•¿åº¦ä¸bufferçš„é•¿åº¦æ˜¯ä¸€æ ·
            String msg = new String(data, 0, len);
            System.out.println(msg);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
~~~



### 4.2 Sender

~~~java
public class Sender {
    public static void main(String[] args) {
        try (
                DatagramSocket socket = new DatagramSocket()
        ) {
            byte[] msg = "hello world".getBytes();
            // åœ¨å‘é€çš„æ•°æ®æŠ¥æ–‡ä¸­ï¼Œå°è£…ç›®æ ‡çš„åœ°å€ä¿¡æ¯
            DatagramPacket dp = new DatagramPacket(msg, msg.length, InetAddress.getByName("127.0.0.1"), 8080);
            // while
            socket.send(dp);

            // å‘é€çš„æ•°æ®ä¼ è¾“å®Œæ¯•çš„æ—¶å€™ï¼Œå‘é€ä¸€ä¸ªç±»ä¼¼äºQçš„è¡¨ç¤º
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
~~~





# ğŸˆğŸˆå¤šçº¿ç¨‹

## 1ã€çº¿ç¨‹ã€è¿›ç¨‹æ¦‚å¿µ

- **Process è¿›ç¨‹**ï¼šå°±æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºåœ¨è¿è¡ŒæœŸé—´ï¼Œå®ƒæ‰€ç”³è¯·çš„èµ„æºï¼ˆç¡¬ä»¶ã€è½¯ä»¶ï¼‰çš„æ€»å’Œï¼Œå®ƒå³æ˜¯å†…å­˜ä¸­åˆ’å®šçš„ä¸€å—åŒºåŸŸï¼Œè€Œä¸”æ˜¯å½“å‰åº”ç”¨ç¨‹åºæ‰€â€œç‹¬å â€çš„,æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½

  - å½“ä¸€ä¸ªåº”ç”¨ç¨‹åºåŠŸèƒ½è¶³å¤Ÿå¤æ‚çš„æ—¶å€™ï¼Œå®ƒå¯èƒ½ä¼šç”±å¤šä¸ªè¿›ç¨‹ç»„æˆï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½ä¼šæ‰¿æ‹…æˆ–è€…æä¾›ç›¸åº”çš„æŸä¸€é¡¹åŠŸèƒ½

  

- **Thread çº¿ç¨‹**ï¼šâ€œæ˜¯ä¸€ä¸ªè½»é‡çº§çš„è¿›ç¨‹â€ï¼Œä¸€ä¸ªè¿›ç¨‹æ˜¯ç”±å¤šä¸ªçº¿ç¨‹ç»„æˆçš„ï¼ŒåŒæ—¶ï¼Œçº¿ç¨‹åˆæ˜¯CPUçš„æœ€åŸºæœ¬çš„è°ƒåº¦å•ä½



- CPUç›¸å…³æ¦‚å¿µï¼š
  - æŸä¸€ä¸ªçº¿ç¨‹å¦‚æœæƒ³è¦è®¡ç®—ï¼Œå¿…é¡»é¦–å…ˆè¦äº‰æŠ¢åˆ°CPUçš„æ—¶é—´ç‰‡ï¼ˆæ˜¯ä¸€ä¸ªéå¸¸å°çš„ï¼Œå‡ ä¹ä¸å¯ä»¥å†åˆ‡å‰²çš„æ—¶é—´å•ä½ï¼‰ï¼Œæ‰æœ‰æœºä¼šè®©CPUæ¥è®¡ç®—ç¨‹åºä¸­æŒ‡å®šçš„é€»è¾‘
  -  æˆ‘ä»¬çš„æ“ä½œç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™äº›ç¨‹åºæ˜¯ç”±å¤šä¸ªè¿›ç¨‹ç»„æˆçš„ï¼ŒåŒæ—¶æ¯ä¸€ä¸ªè¿›ç¨‹åˆåŒ…å«äº†å¤šä¸ªçº¿ç¨‹ï¼Œå› æ­¤ï¼Œæœ‰ä¸€ä¸ªæƒåŠ›éå¸¸å¤§çš„å¯¹è±¡â€œè°ƒåº¦å™¨â€ï¼Œ
  - ç”±è°ƒåº¦å™¨æ¥å†³å®šä»€ä¹ˆæ—¶é—´ï¼Œå“ªä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒCPUçš„è¿ç®—



## 2ã€åˆ›å»ºçº¿ç¨‹

åˆ›å»ºçº¿ç¨‹æœ‰å¤šç§æ–¹å¼ï¼š

### 2.1 ç¼–å†™Threadçš„å­ç±»

é‡å†™runæ–¹æ³•ï¼Œé€šè¿‡startå¯åŠ¨çº¿ç¨‹(å› ä¸ºJavaæ˜¯å•æ ¹ç»§æ‰¿ç»“æ„ï¼Œæ‰€ä»¥ä¸€ä¸ªç±»æ˜¯çº¿ç¨‹ç±»ï¼Œå°±ä¸èƒ½æ˜¯å…¶å®ƒç±»å‹çš„å­ç±»å‹äº†ï¼Œæœ‰å±€é™æ€§)

~~~java
  // ç¼–å†™ä¸€ä¸ªçº¿ç¨‹ç±»çš„å­ç±»
  class MyThread extends Thread {
  
  
      @Override
      public void run() { // çŠ¶æ€3ï¼šè¿è¡ŒçŠ¶æ€
          RandomUtils.longSleep(3000, 5000);
          // è·å–åˆ°å½“å‰çš„çº¿ç¨‹å¯¹è±¡
          Thread thread = Thread.currentThread();
          String name = thread.getName();
          long id = thread.getId();
          int priority = thread.getPriority(); // çº¿ç¨‹çš„ä¼˜å…ˆçº§
          System.out.println(name + ":" + id + ":" + priority);
          System.out.println(thread.getId() + "æ‰§è¡Œå®Œæ¯•");
  
      }  // çŠ¶æ€4ï¼šç»ˆæ­¢çŠ¶æ€
  }
~~~

  

### 2.2 ç¼–å†™ä¸€ä¸ªç±»å®ç°Runnableæ¥å£

å®ç°runæ–¹æ³•ï¼Œé€šè¿‡startå¯åŠ¨çº¿ç¨‹ï¼ˆå› ä¸ºTaskç±»åªéœ€è¦å®ç°æ¥å£ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ˜¯å…¶å®ƒç±»çš„å­ç±»å‹ï¼Œæ›´çµæ´»ï¼‰

~~~java
class Task implements Runnable {

    @Override
    public void run() {
        RandomUtils.longSleep(3000, 5000);
        // è·å–åˆ°å½“å‰çš„çº¿ç¨‹å¯¹è±¡
        Thread thread = Thread.currentThread();
        String name = thread.getName();
        long id = thread.getId();
        int priority = thread.getPriority(); // çº¿ç¨‹çš„ä¼˜å…ˆçº§
        System.out.println(name + ":" + id + ":" + priority);
        System.out.println(thread.getId() + "æ‰§è¡Œå®Œæ¯•");
    }
}

~~~



### 2.3 å†…éƒ¨ç±»

æ›´åŠ çµæ´»ï¼Œå¯ä»¥ä¸ç”¨å†åˆ»æ„çš„æ–°å»ºä¸€ä¸ªç±»ï¼Œå®ƒçš„å”¯ä¸€çš„ç¡®å®šï¼Œå°±æ˜¯åˆ«äººæ— æ³•é‡ç”¨ï¼ˆå®ƒæ²¡æœ‰åç§°ï¼‰

~~~java
    private static void multiThreadDemo() {

        // æ‰“å°å½“å‰ä¸»çº¿ç¨‹çš„ä¿¡æ¯
        Thread main = Thread.currentThread (); // å¯ä»¥ç†è§£ä¸ºä¸»çº¿ç¨‹
        System.out.println(main.getId() + ":" + main.getName());

        // å®ä¾‹åŒ–ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡
        for (int i = 0; i < 3; i++) { // åˆ›å»º3ä¸ªå­çº¿ç¨‹
            // Thread t = new MyThread(); // çŠ¶æ€1ï¼šè¿›å…¥newåˆå§‹åŒ–çŠ¶æ€ é©¬ä¸Šä¼šè¿›å…¥çŠ¶æ€2ï¼šå°±ç»ªçŠ¶æ€ï¼ˆé˜»å¡çŠ¶æ€ï¼‰
            // å¯åŠ¨è¿™ä¸ªçº¿ç¨‹
            // t.start();

            // Thread t = new Thread(new Task());
            // t.start();

            Thread t = new Thread(() -> { // åŒ¿åå†…éƒ¨ç±» - ç®€åŒ–ä¸ºlambdaè¡¨è¾¾å¼
                RandomUtils.longSleep(3000, 5000);
                // è·å–åˆ°å½“å‰çš„çº¿ç¨‹å¯¹è±¡
                Thread thread = Thread.currentThread();
                String name = thread.getName();
                long id = thread.getId();
                int priority = thread.getPriority(); // çº¿ç¨‹çš„ä¼˜å…ˆçº§
                System.out.println(name + ":" + id + ":" + priority);
                System.out.println(thread.getId() + "æ‰§è¡Œå®Œæ¯•");
            });
            t.start();
        }

        System.out.println("-----------------------------");
    }
~~~



## 3ã€çº¿ç¨‹ç«äº‰èµ„æº

- å®šä¹‰ä¸€ä¸ªç±»ï¼Œä»£è¡¨å®¹å™¨ï¼Œä¹Ÿè¡¨ç¤ºçº¿ç¨‹æŠ¢å çš„èµ„æº

~~~java
public class Container {

    private final List<String> list = new ArrayList<>();

    public void increment(String item) {
        list.add(item);
    }

    public void showAll() {
        System.out.println(list);
    }

}
~~~

- åˆ›å»ºçº¿ç¨‹ï¼Œé€šè¿‡å®ç°æ¥å£

~~~java
public class Dude implements Runnable {// å®¶ä¼™ brother guy

    private final String name;
    private final Container container;

    public Dude(String name, Container container){
        this.name = name;
        this.container = container;
    }


    @Override
    public void run() {
        for (int i = 0; i < 100; i++) {
            container.increment(name);
        }
    }

}
~~~

- ç¨‹åºå…¥å£

  å› ä¸ºt1.start()ä¸ºéé˜»å¡æ€§æ–¹æ³•ï¼Œæ‰€ä»¥ä¸ä¼šç­‰t1æ‰§è¡Œå®Œåå†æ‰§è¡Œt2.start()

~~~java
public class Main {
    public static void main(String[] args) {
        // å®¹å™¨åªæœ‰ä¸€ä¸ª
        Container container = new Container();
        // ä½†æ˜¯å®ƒè¦åŒæ—¶è¢«ä¸¤ä¸ªä»»åŠ¡ç±»ä½¿ç”¨
        Thread t1 = new Thread(new Dude("Jack", container));
        Thread t2 = new Thread(new Dude("Mike", container));

        t1.start();
        t2.start();

        while (t1.isAlive() || t2.isAlive()) {
        }

        // ç¨‹åºæ‰§è¡Œåˆ°è¿™é‡Œï¼Œè¯æ˜t1å’Œt2éƒ½ä¸æ˜¯æ´»è·ƒçš„
        container.showAll();
    }
}
~~~



## 4ã€API

### 4.1 while{}

~~~java
        Thread t = new Thread(new Task());
        t.start(); // éé˜»å¡æ€§æ–¹æ³•
        System.out.println("ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•");
       while (t.isAlive()) {
             ;
         }
        System.out.println("å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•");
~~~



### 4.2 join()-ç­‰å¾…å½“å‰çº¿ç¨‹æ­»äº¡

ç­‰å¾…å½“å‰è¿™ä¸ªtçº¿ç¨‹æ­»äº¡ï¼šå¦‚æœtæ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œç¨‹åºçš„æ‰§è¡Œæµå°±ä¼šä¸€ç›´é˜»å¡åœ¨è¿™ä¸€è¡Œ

~~~java
        Thread t = new Thread(new Task());
        t.start(); // éé˜»å¡æ€§æ–¹æ³•
        System.out.println("ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ¯•");

        t.join(); //ç­‰å¾…å½“å‰è¿™ä¸ªtçº¿ç¨‹æ­»äº¡ï¼šå¦‚æœtæ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œç¨‹åºçš„æ‰§è¡Œæµå°±ä¼šä¸€ç›´é˜»å¡åœ¨è¿™ä¸€è¡Œ

        System.out.println("å­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•");
~~~



### 4.3 interrupt()-ä¸­æ–­

- `interrupt()`å¹¶ä¸ä¼šå¼ºåˆ¶ä¸­æ–­çº¿ç¨‹ï¼Œå®ƒåªæ˜¯å‘å‡ºä¸€ä¸ªä¸­æ–­è¯·æ±‚ï¼Œç”±è¢«ä¸­æ–­çº¿ç¨‹æ¥å†³å®šæ˜¯å¦åº”è¯¥ä¸­æ–­ã€‚
- è¢«ä¸­æ–­çº¿ç¨‹éœ€è¦æŒç»­æ£€æŸ¥æ˜¯å¦æ”¶åˆ°ä¸­æ–­è¯·æ±‚ï¼Œç¼–å†™ç›¸åº”é€»è¾‘è¿›è¡Œä¸­æ–­ã€‚

~~~java
public class InterruptMain {

    public static void main(String[] args) {
        Thread t = new Thread(new Task());
        t.start();

        System.out.println("ä¸»çº¿ç¨‹ç­‰å¾…ing...");
        RandomUtils.longSleep(2_000, 3_000);

        // å‘å‡ºä¸­æ–­çš„æŒ‡ä»¤
        System.out.println("å‘å‡ºä¸­æ–­æŒ‡ä»¤");
        t.interrupt(); // ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œåªæ˜¯å‘å­çº¿ç¨‹å‘å‡ºäº†ä¸€ä¸ªä¸­æ–­ä¿¡å·
    }


private static class Task implements Runnable {
        @Override
        public void run() {
           for(int i=0;i<10_000;i++){
                if (isInterrupted()) return;
                System.out.println("å­çº¿ç¨‹æ‰§è¡Œing...");
            }
        }

        private boolean isInterrupted() {
            return Thread.currentThread().isInterrupted(); // å½“å‰çº¿ç¨‹æ˜¯å¦è¢«æ‰“äº†ä¸­æ–­çš„æ ‡è®°
        }
    }

~~~

 

### 4.4 synchronized

- åœ¨ä¿®æ”¹è¢«äº‰æŠ¢çš„èµ„æºæ–¹æ³•ä¸Šæ–°å¢ä¸€ä¸ªsynchronized(åŒæ­¥)
- æ•ˆæœï¼šä¼šè®©è¯¥æ–¹æ³•å˜æˆåŸå­æ€§çš„ä¸€ä¸ªæ“ä½œ(ä¸èƒ½å†åˆ‡å‰²çš„)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹åœ¨é‡Œé¢æ‰§è¡Œï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™ï¼Œå…¶å®ƒè¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„çº¿ç¨‹ä¼šä¸€ç›´è¢«é˜»å¡åœ¨å¤–é¢
-  å·¥ä½œåŸç†ï¼š
  - 1ã€å½“ä¸€ä¸ªç±»çš„æ–¹æ³•ï¼Œåªè¦æœ‰ä¸€ä¸ªè¢«åŠ äº†syncä¿®é¥°ï¼Œé‚£ä¹ˆJVMå°±ä¼šåˆ›å»ºå‡ºä¸€ä¸ªç±»ä¼¼äºlockçš„å¯¹è±¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºmonitor(ç›‘è§†å™¨)
  - 2ã€å½“æœ‰ä»»ä½•ä¸€ä¸ªçº¿ç¨‹æƒ³è¦è®¿é—®å¸¦æœ‰syncçš„æ–¹æ³•æ—¶ï¼ŒJVMçš„è°ƒåº¦å™¨å°±ä¼šè¯¢é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼šmonitoræ˜¯å¦å¯ä»¥è·å–åˆ°
         -- Y å½“å‰çº¿ç¨‹å°±ä¼šæ‹¿åˆ°è¯¥monitorï¼Œç„¶åè¿›å»æ‰§è¡Œè¯¥æ–¹æ³•
         -- N å½“å‰çº¿ç¨‹å°±ä¼šè¢«é˜»å¡åœ¨æ–¹æ³•å¤–
  -  3ã€å½“æŸä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œé€»è¾‘ä»¥åï¼Œå®ƒä¼šæŠŠmonitorå½’è¿˜ç»™è°ƒåº¦å™¨

- ç¨‹åº

~~~java
 public static void main(String[] args) throws InterruptedException {
        // 1ã€åˆ›å»ºä¸€ä¸ªè®¡æ•°å™¨å¯¹è±¡
        Counter counter = new Counter(); // è¢«äº‰æŠ¢çš„èµ„æºå¯¹è±¡
        // 2ã€åˆ›å»º2ä¸ªä»¥ä¸Šçš„çº¿ç¨‹ä»»åŠ¡ï¼Œå¯¹è®¡æ•°å™¨è¿›è¡Œç´¯åŠ 
        List<Thread> tasks = new ArrayList<>();
        for (int i = 0; i < 2; i++) {
            Thread t = new Thread(new User(counter));
            tasks.add(t);
            t.start();
        }

        // ç­‰å¾…ä»–ä»¬æ‰§è¡Œå®Œæ¯•
        for (Thread t : tasks)
            t.join();

        // 3ã€æœ€ç»ˆç»Ÿè®¡total
        System.out.println(counter.getTotal());

    }

private static class User implements Runnable {

        private Counter counter;

        public User(Counter counter) {
            this.counter = counter;
        }

        private void pushButton() {
            counter.increment();
        }

        @Override
        public void run() {
            for (int i = 0; i < 100_000; i++)
                pushButton();
        }
    }
~~~

- synchronizedéƒ¨åˆ†

~~~java

private static class Counter {
        // O
        private int total; // ä¸»å­˜åŒº CPUå¯„å­˜å™¨
        // private int total; // ä¸»å­˜åŒº CPUå¯„å­˜å™¨

    //ç”¨æ³•ä¸€ï¼Œsynchronizedå…³é”®å­—ä¿®é¥°æ–¹æ³•
        public synchronized void increment() { // ä¼šæœ‰å¤šä¸ªçº¿ç¨‹è½®ç•ªäº‰æŠ¢åˆ°æ—¶é—´ç‰‡è¿›æ¥æ‰§è¡Œç´¯åŠ é€»è¾‘
            // 1ã€æŠŠå¯„å­˜å™¨ä¸Šçš„totalç°åœ¨çš„å€¼æ‹·è´ä¸€ä»½è¿›æ¥ï¼Œå£°æ˜ä¸€ä¸ªå˜é‡å­˜èµ·æ¥
            // int temp = total;
            // 2ã€temp = temp + 1
            // 3ã€æŠŠç´¯åŠ åçš„tempå†™å›å¯„å­˜å™¨ä¸Šçš„totalå˜é‡
            // int num = 0; // å­˜å‚¨åœ¨å·¥ä½œå†…å­˜åŒº
            total++;
        }
    //ç”¨æ³•äºŒï¼Œsynchronizedä»£ç å—
     public void increment() {
        synchronized ( this) {	//éœ€è¦æä¾›ä¸€ä¸ªä¸å¯ä¿®æ”¹çš„å¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œä¸€èˆ¬ä¸ä¼šä½¿ç”¨åŸºæœ¬ç±»å‹
            totalBytes++;
        }
    }

    
        public int getTotal() {
            return total;
        }
    }

~~~



### 4.5 ReentrantLock()

~~~java
 Lock lock = new ReentrantLock(); // å¯é‡å…¥é”

public void increment() throws InterruptedException {
            //å‰é¢çš„é€»è¾‘ä»£ç 
    		//...............
            lock.lock(); // åŠ é”ï¼šä¸€æ—¦æ— æ³•è·å–åˆ°lockï¼Œåˆ™ä¼šé˜»å¡åœ¨æ­¤
            // boolean flag = lock.tryLock(3, TimeUnit.SECONDS); // éšç¼˜é”ï¼šï¼›ç«‹å³è¿”å›çš„ï¼Œtrue - æŠ¢åˆ°äº†ï¼›false - false
            // if (flag) {
            try {
                total++;
            } finally {
                lock.unlock(); // é‡Šæ”¾é”
            }
            // } else {
            //     // ç¼–å†™æ²¡æœ‰æŠ¢åˆ°è¡¥å¿é€»è¾‘
            // }
            //åé¢çš„é€»è¾‘ä»£ç 
    		//..............
    
 }
~~~



### 4.6 wait()ã€notify()ã€notifyAll()

- å¤§è‡´ç”¨æ³•

~~~java
// è¦ä½¿ç”¨çº¿ç¨‹ä¹‹é—´é€šè®¯çš„æ–¹æ³•ï¼šçº¿ç¨‹1å‘Šè¯‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹2ï¼Œæˆ‘çš„å·¥ä½œåšå®Œäº†
         Object lock = new Object();
         System.out.println(0);
         synchronized (lock) {
        //     // åšå®Œç¬¬ä¸€é˜¶æ®µçš„å·¥ä½œ
             lock.wait();  // å½“å‰çš„çº¿ç¨‹æš‚æ—¶äº¤å‡ºäº†CPUçš„æ—¶é—´ç‰‡ä½¿ç”¨æƒåŠ›ï¼Œæ­¤æ—¶ï¼Œæ­£å¸¸æƒ…å†µåº”è¯¥æœ‰å¦ä¸€ä¸ªçº¿ç¨‹æ¥å¾—åˆ°é” ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å®Œä»¥åï¼Œå†é€šçŸ¥â€œä½ åˆå¯ä»¥ç”¨äº†â€ lock.notifyAll()
        //     // åšç¬¬ä¸‰é˜¶æ®µçš„å·¥ä½œ
         }
         System.out.println(1);

         obj.notify(); // é€šçŸ¥1ä¸ªXXX
        // obj.notifyAll(); // é€šçŸ¥æ‰€æœ‰çš„XXX
~~~

- å®ä¾‹

~~~java
public class Main {
    // ä½ æ‹ä¸€ï¼Œæˆ‘æ‹ä¸€
    public static void main(String[] args) throws InterruptedException {

        // åˆ›å»ºä¸€ä¸ªç”¨æ¥äº‰æŠ¢çš„èµ„æº
        List<String> list = new ArrayList<>();
        // å¼€è¾Ÿä¸¤ä¸ªçº¿ç¨‹ï¼Œå¾€listä¸­å¡«å……æ•°æ®
        // å¡«å……çš„è§„åˆ™å¦‚ä¸‹ï¼šçº¿ç¨‹1é¦–å…ˆå¡«å……A,A,Aï¼Œç„¶åçº¿ç¨‹2å¡«å……B,B,Bï¼Œç„¶åçº¿ç¨‹1å†å¡«å……A,A,A
        // é—®é¢˜åˆ†æï¼š
        // å¯¹äºçº¿ç¨‹1æ¥è¯´ï¼Œå®ƒéœ€è¦å…ˆå¡«å……ä¸€äº›å­—ç¬¦ä¸²ï¼Œç„¶åç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œå†ç»§ç»­å®Œæˆåç»­çš„å¡«å……å·¥ä½œ
        // å¯¹äºçº¿ç¨‹2æ¥è¯´ï¼Œå®ƒéœ€è¦ç­‰åˆ°çº¿ç¨‹1å®Œæˆç¬¬ä¸€é˜¶æ®µçš„å·¥ä½œï¼Œå†å¡«å……è‡ªå·±çš„ä¿¡æ¯ï¼Œç„¶åå†äº¤å‡ºæ‰§è¡Œæƒ


        Thread t1 = new Thread(new WorkerA(list));
        Thread t2 = new Thread(new WorkerB(list));

        t1.start();
        RandomUtils.longSleep(100, 200);
		t2.start();
        
        t1.join();
        t2.join(); // ç­‰2ä¸ªçº¿ç¨‹éƒ½ç»“æŸä»¥åå†æ¥æŸ¥çœ‹listä¸­çš„é¡ºåºæ˜¯å¦æ­£ç¡®

        System.out.println(list);

    }

    private static class WorkerA implements Runnable {
        final List<String> list;

        public WorkerA(List<String> list) {
            this.list = list;
        }

        public void fill() {
            for (int i = 0; i < 3; i++)
                list.add("A");
        }

        @Override
        public void run() {
            // ä¸€å®šè¦è®°ä½ï¼Œåœ¨waitä¹‹å‰é¦–å…ˆå¿…é¡»å…ˆè·å–åˆ°monitor
            try {
                synchronized (list) {
                    fill();
                    System.out.println("fill A 1");
                    list.wait();
                    fill();
                    System.out.println("fill A 2");
                }
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
        }
    }

    private static class WorkerB implements Runnable {
        final List<String> list;

        public void fill() {
            for (int i = 0; i < 3; i++)
                list.add("B");
        }

        public WorkerB(List<String> list) {
            this.list = list;
        }

        @Override
        public void run() {
            synchronized (list) {
                fill();
                System.out.println("fill B");
                list.notifyAll(); // å”¤é†’åˆ«äººæˆ‘åšå®Œäº†ï¼Œä½ ä»¬å¯ä»¥æ¥ç€å»æŠ¢äº†(monitor)
            }
        }
    }
}

~~~



### 4.7 Volatile

- é—®é¢˜æ¡ˆä¾‹

```java
public class DownloadStatus {
    private int totalBytes;
    private boolean isDone;

    public synchronized void incrementTotalBytes() {
            totalBytes++;
    }

    public int getTotalBytes() {
        return totalBytes;
    }

    public boolean isDone() {
        return isDone;
    }

    public void setDone(boolean done) {
        isDone = done;
    }
}

public class DownloadFileTask implements Runnable {
    private DownloadStatus status;

    public DownloadFileTask(DownloadStatus status) {
        this.status = status;
    }

    @Override
    public void run() {
        System.out.println("Download:" + Thread.currentThread().getName());
        for (int i = 0; i < 1_000_000; i++) {
            if (Thread.currentThread().isInterrupted()) return;
            status.incrementTotalBytes();
        }
        status.setDone(true);
        System.out.println("Download complete:" + Thread.currentThread().getName());
    }
}

public class ThreadDemo {
    public static void main(String[] args) {
        var status = new DownloadStatus();
        var t1 = new Thread(new DownloadFileTask(status));
        t1.start();

        var t2 = new Thread(() -> {
            while (!status.isDone()) {
            }
            System.out.println(status.getTotalBytes());
        });
        t2.start();

    }
}
```

åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç¨‹åºä¸€ç›´è¿è¡Œä¸èƒ½åœæ­¢ï¼Œä¸”`t2`çº¿ç¨‹æ— æ³•è¾“å‡ºæœ€ç»ˆç»“æœï¼Œä¸»è¦åŸå› åœ¨äºï¼š

- åœ¨è®¡ç®—æœºçš„`CPU`è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨ä¸€å¥—ç¼“å­˜æœºåˆ¶ï¼šä¸ºäº†ä¼˜åŒ–ç¨‹åºæ‰§è¡Œé€Ÿåº¦ï¼Œä¼šé¦–å…ˆæŠŠä¸»å­˜å‚¨å™¨ï¼ˆ`main memory`ï¼‰ä¸­çš„æ•°æ®æ‹·è´åˆ°è‡ªå·±çš„ç¼“å­˜ï¼ˆ`cache`ï¼‰ä¸­ï¼Œç„¶åå†ç»§ç»­è¿ç®—ã€‚ç”±äºç›´æ¥ä»è‡ªå·±çš„`cache`ä¸­è¯»å–æ•°æ®çš„é€Ÿåº¦æ›´å¿«ï¼Œå› æ­¤å‡å°‘äº†ä¸æ–­ä¼ å€¼å¸¦æ¥çš„æ—¶é—´æŸè€—ã€‚
- `t1`çº¿ç¨‹å’Œ`t2`çº¿ç¨‹é¦–å…ˆéƒ½æŠŠè¿™ä¸ªå€¼æ‹·è´åˆ°è‡ªå·±çš„ç¼“å­˜ä¸­ï¼Œç„¶å`t1`çº¿ç¨‹å¯¹è¿™ä¸ªå€¼åšå‡ºäº†ä¿®æ”¹ï¼Œç”±äºç¼“å­˜ä¸­çš„æ•°æ®åªæœ‰è‡ªå·±å¯ä»¥è®¿é—®ï¼Œå› æ­¤`t2`çº¿ç¨‹å¹¶çœ‹ä¸åˆ°è¿™ä¸ªä¿®æ”¹ï¼Œç”šè‡³å½“`t1`çº¿ç¨‹å°†è¿™ä¸ªä¿®æ”¹å†™å›åˆ°ä¸»å­˜å‚¨å™¨ï¼Œè¿™ç§ä¿®æ”¹å¯¹äº`t2`ä»ç„¶æ˜¯ä¸å¯è§çš„ã€‚

è¿™ç§åœºæ™¯ï¼Œå°±ç§°ä¸ºå¤šçº¿ç¨‹å¹¶å‘çš„å¯è§æ€§é—®é¢˜ï¼š



![image-20210611030505411](images/image-20210611030505411.png)

- è§£å†³æ–¹æ³•ï¼švolatile

å½“`isDone`è¢«`volatile`ä¿®é¥°æ—¶ï¼Œæ„å‘³ç€å‘Šè¯‰`JVM`è¿™ä¸ªå˜é‡æ˜¯ä¸ç¨³å®šçš„ï¼Œä¸è¦åœ¨è®¡ç®—çš„æ—¶å€™ä¾èµ–å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„å€¼ï¼Œè€Œæ€»æ˜¯ä»ä¸»å­˜å‚¨å™¨ä¸­è¯»å–å®ƒï¼ŒåŒæ—¶ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹`isDone`æ—¶ï¼Œä¼šç«‹åˆ»æ›´æ–°å­˜å‚¨åœ¨ä¸»å­˜å‚¨å™¨ä¸­çš„å€¼ã€‚

```java
public class DownloadStatus {
    private int totalBytes;
    private volatile boolean isDone;

    public synchronized void incrementTotalBytes() {
            totalBytes++;
    }

    public int getTotalBytes() {
        return totalBytes;
    }

    public boolean isDone() {
        return isDone;
    }

    public void setDone(boolean done) {
        isDone = done;
    }
}
```



### 4.8 CopyOnWriteArrayList

ArrayListç”±äºæœ¬èº«æ²¡æœ‰è¿›è¡ŒåŒæ­¥åŒ–ï¼ˆsynchronizeï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¯´å®ƒæ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸å®‰å…¨çš„ç±»

Vectorçº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯å¤ªè€äº†

å› æ­¤æœ‰äº†CopyOnWriteArrayList,ç”¨çš„æ˜¾ç¤ºé”ï¼Œ ReentrantLock

~~~java
public class Demo {

    public static void main(String[] args) throws InterruptedException {

        // å¦‚æœéœ€è¦ç»Ÿè®¡æ­£ç¡®çš„æ•°é‡ï¼Œæˆ‘ä»¬éœ€è¦ç¼–ç æ¥å®ç°å¯¹è¢«äº‰æŠ¢èµ„æºçš„åŒæ­¥åŒ–
        // ArrayListç”±äºæœ¬èº«æ²¡æœ‰è¿›è¡ŒåŒæ­¥åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¯´å®ƒæ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸å®‰å…¨çš„ç±»
        final List<String> list = new CopyOnWriteArrayList<>(); // è¿™ä¸ªæ˜¯ä¸€ä¸ªonly oneçš„èµ„æº
   
        List<Thread> tasks = new ArrayList<>();

        for (int i = 0; i < 2; i++) { // åˆ›å»º2ä¸ªç‹¬ç«‹çº¿ç¨‹

            Thread t = new Thread(() -> {
                for (int j = 0; j < 100_000; j++) { // å¾ªç¯å¾€listä¸­æ·»åŠ å…ƒç´ 
                    list.add("A");
                }
            });

            tasks.add(t);
            t.start();
        }

        // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•
        for (Thread r : tasks)
            r.join();

        System.out.println(list.size());


    }

}
~~~



## 5ã€é¢åŒ…åº—é—®é¢˜

- é¢˜ç›®

~~~
1ã€è¯·å®šä¹‰ä¸€ä¸ªé¢åŒ…åº—å¯¹è±¡(åªæœ‰ä¸€ä¸ªå®ä¾‹)
-- ä½¿ç”¨æŸç§å›ºå®šçš„é¢‘ç‡æŒç»­çš„ç”Ÿäº§é¢åŒ…

2ã€è¯·å®šä¹‰ä¸€ä¸ªæ¶ˆè´¹è€…ç±»(å®ä¾‹æœ‰å¤šä¸ª)
-- å»é¢åŒ…åº—æ¶ˆè´¹(æŠ¢)é¢åŒ…ï¼Œæ¯æ¬¡æ¶ˆè´¹ä¸€ä¸ªï¼Œæ¶ˆè´¹çš„é€Ÿåº¦è‡ªå·±å®šä¹‰

3ã€ä¸æ–­çš„åœ¨æ§åˆ¶å°è¾“å‡ºï¼š
é¢åŒ…åº—ç”Ÿäº§äº†1ä¸ªé¢åŒ…ï¼Œç°æœ‰XXXä¸ª(å·²ç»æ¶ˆè´¹äº†XXXä¸ª)
æ¶ˆè´¹è€…æ¯æ¶ˆè´¹1ä¸ªé¢åŒ…ï¼Œä¹Ÿè¾“å‡ºJackä¹°åˆ°äº†1ä¸ªé¢åŒ…
~~~

- è‡ªå·±å†™çš„ï¼Œä¸çŸ¥é“åˆä¸åˆç†

~~~java
package bakeryquestion;

public class Test {
    public static void main(String[] args) {
        Bakery bakery = new Bakery();
        Thread t = new Thread(bakery);
        Thread t2 = new Thread(new Consumer(bakery,"Jack"));
        Thread t3 = new Thread(new Consumer(bakery,"Mike"));
        Thread t4 = new Thread(new Consumer(bakery,"Mary"));
        t.start();
        t2.start();
        t3.start();
        t4.start();


    }

    private static class Bakery implements Runnable {
        int count;

        @Override
        public void run() {
            System.out.println("Bakeryçº¿ç¨‹å¯åŠ¨");
            while (true) {
                //é¢åŒ…åº—100æ¯«ç§’æŠ¢ä¸€æ¬¡çº¿ç¨‹ï¼Œç”Ÿäº§é¢åŒ…
                try {
                    Thread.sleep(100);
                } catch (InterruptedException e) {
                    throw new RuntimeException(e);
                }

                synchronized (this) {

                    if (count <100) {
                        // é¢åŒ…è¶³å¤Ÿ

                        count++;
                        System.out.println("1ç”Ÿäº§äº†ä¸€ä¸ªé¢åŒ…ï¼Œæ€»å…±æœ‰" + count);
                        notifyAll();// ç”Ÿäº§äº†é¢åŒ…ï¼Œå‘Šè¯‰æ¶ˆè´¹è€…å¯ä»¥è´­ä¹°äº†

                    } else {
                        // é¢åŒ…ä¸å¤Ÿ
                        count++;
                        System.out.println("2ç”Ÿäº§äº†ä¸€ä¸ªé¢åŒ…ï¼Œæ€»å…±æœ‰" + count);
                        try {
                            wait();// ç”Ÿäº§äº†é¢åŒ…ï¼Œå‘Šè¯‰æ¶ˆè´¹è€…å¯ä»¥è´­ä¹°äº†
                        } catch (InterruptedException e) {
                            throw new RuntimeException(e);
                        }

                    }
                }

            }

        }
    }


    private static class Consumer implements Runnable {
        private Bakery bakery;
        String name;

        @Override
        public void run() {
            System.out.println("Consumerçº¿ç¨‹å¯åŠ¨");
            while (true) {
                //é¡¾å®¢500æ¯«ç§’æŠ¢ä¸€æ¬¡çº¿ç¨‹ï¼Œæ¶ˆè´¹é¢åŒ…
                try {
                    Thread.sleep(500);

                } catch (InterruptedException e) {
                    throw new RuntimeException(e);
                }

                synchronized (bakery) {
                    if (bakery.count > 0) {
                        System.out.println("é¡¾å®¢"+name+"ä¹°äº†ä¸€ä¸ªé¢åŒ…ï¼Œè¿˜å‰©");
                        bakery.count--;
                        bakery.notifyAll();// æ¶ˆè´¹å®Œäº†ä¸€ä¸ªé¢åŒ…ï¼Œç›¸å½“äºå‡å°‘ä¸€ä¸ªä¿¡å·é‡ï¼Œå‘Šè¯‰ç”Ÿäº§è€…è¦ç”Ÿäº§äº†
                    } else {
                        System.out.println("é¡¾å®¢"+name+"æƒ³ä¹°é¢åŒ…ï¼Œé¢åŒ…ä¸å¤Ÿ");
                        try {
                            bakery.wait();  // é¢åŒ…ä¸å¤Ÿï¼Œå‘Šè¯‰ç”Ÿäº§è€…è¦ç”Ÿäº§é¢åŒ…äº†
                        } catch (InterruptedException e) {
                            throw new RuntimeException(e);
                        }

                    }

                }

            }

        }

        public Consumer(Bakery bakery, String name) {
            this.bakery = bakery;
            this.name = name;
        }
    }


}

~~~

## 6ã€TimeUtilç±»

- ```java
  TimeUnit.MILLISECONDS.sleep(time); // ä»£ç æ˜“è¯»ï¼Œè¯­ä¹‰æ›´æ¸…æ™°
  ```

## 7ã€å¤šçº¿ç¨‹æ¡ˆä¾‹ä¸€:waitå’ŒnotifyAllçš„ä½¿ç”¨

- é—®é¢˜ï¼šç°åœ¨æœ‰A1ã€A2ã€A3ä¸‰ä¸ªçº¿ç¨‹ï¼ˆåˆ†åˆ«æ‰“0-10ã€11-20ã€21-30ï¼‰ï¼Œæ€æ ·ä¿è¯A2åœ¨A1æ‰§è¡Œå®Œåæ‰§è¡Œï¼ŒA3åœ¨A2æ‰§è¡Œå®Œåæ‰§è¡Œï¼Ÿ

```java
public class Demo {
    // åº”ç”¨ç¨‹åºæ˜¯ç”±1ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ç»„æˆçš„ï¼ˆå®ƒçš„å†…å­˜ç©ºé—´æ˜¯ç‹¬å çš„ï¼‰ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹æ˜¯ç”±1ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç»„æˆçš„ï¼ˆå®ƒçš„å†…å­˜æœ‰ä¸€éƒ¨åˆ†æ˜¯å…±äº«çš„ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯ç‹¬å çš„ï¼‰
    // JVMé€šè¿‡Runnableåˆ›å»ºçš„çº¿ç¨‹ï¼Œå…¶å®æ›´åŠ åƒæ˜¯ä¸€ä¸ªä»»åŠ¡ï¼ˆé€»è¾‘ä¸Šçš„æ¦‚å¿µï¼Œè€Œéç‰©ç†ä¸Šçš„ï¼‰
    // å¦‚æœç¨‹åºä¸­çš„æ€»ä»»åŠ¡æ•°å¤§äºå¤„ç†å™¨çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆCPUçš„è°ƒåº¦å™¨å°†ä¼šè®©ä»–ä»¬è½®ç•ªæ¥ä½¿ç”¨å¤„ç†å™¨æ‰§è¡Œé€»è¾‘

    public static void main(String[] args) throws InterruptedException {
        Resource res = new Resource(new ArrayList<>(), 1);
        Thread t1 = new Thread(new Task(res, 1));
        Thread t2 = new Thread(new Task(res, 2));
        Thread t3 = new Thread(new Task(res, 3));
        t3.start();
        t2.start();
        RandomUtils.longSleep(1000, 2000);
        t1.start();

        t1.join();
        t2.join();
        t3.join();

        System.out.println(res.getList());
    }
    private static class Resource {
        List<Integer> list;
        /**
         * ç°åœ¨åˆ°äº†ç¬¬å‡ ä¸ª
         */
        int current;

        public Resource(List<Integer> list, int current) {
            this.list = list;
            this.current = current;
        }

        public List<Integer> getList() {
            return list;
        }

        public void setList(List<Integer> list) {
            this.list = list;
        }

        public int getCurrent() {
            return current;
        }
        public void setCurrent(int current) {
            this.current = current;
        }
    }
    private static class Task implements Runnable {
        final Resource res;
        /**
         * å½“å‰çº¿ç¨‹æ’åœ¨ç¬¬å‡ ä¸ª
         */
        int order;

        public Task(Resource res, int order) {
            this.res = res;
            this.order = order;
        }

        @Override
        public void run() {
            // åˆ¤æ–­æ˜¯å¦è½®åˆ°å½“å‰çº¿ç¨‹æ¥è¿›è¡Œå¡«å……
            while (true) {
                try {
                    synchronized (res) {
                        if (myTurn()) { // min = ? max =? (10x - 9) 10x
                            fill(generateNumbers(10 * order - 9, 10 * order));
                            res.setCurrent(order + 1);
                            // éƒ½æœ‰è®©æƒä¸€è¯´ï¼Œæ ¹æ®è¯­å¢ƒæ¥åˆ¤æ–­wait or  notifyAll
                            res.notifyAll();
                        } else {
                            // N not fill() æ”¾å¼ƒ
                            res.wait();
                        }
                    }
                    if (res.getCurrent() >= 4) break;
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }

        }
        private boolean myTurn() {
            return (order == res.getCurrent());
        }
        /**
         * æŠŠarrä¸­çš„å…ƒç´ ä¾æ¬¡æ·»åŠ åˆ°listå®¹å™¨çš„æœ«å°¾
         *
         * @param arr éœ€è¦è¢«å¡«å……çš„æ•°ç»„
         */
        public void fill(int[] arr) {
            for (int j : arr)
                res.getList().add(j);
        }
        /**
         * ç”Ÿæˆä¸€ä¸ªä»min~maxä¹‹é—´çš„æ•´æ•°æ•°ç»„
         *
         * @param min æœ€å°å€¼ï¼ˆåŒ…å«ï¼‰
         * @param max æœ€å¤§å€¼ï¼ˆåŒ…å«ï¼‰
         * @return åŒºé—´æ•°ç»„
         */
        public int[] generateNumbers(int min, int max) {
            int[] arr = new int[max - min + 1];
            for (int i = min; i < max + 1; i++)
                arr[i - min] = i;

            return arr;
        }

    }
}
```

## 8ã€çº¿ç¨‹æ± çš„åˆ›å»º

### 8.1 å›ºå®šæ•°é‡çº¿ç¨‹æ± FixedThreadPool

~~~java
 public static void main(String[] args) {
        // åˆ›å»ºä¸€ä¸ªæœ‰å›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ±  N-1 æ¨¡å¼ ä¸ªåˆ«ç»„ä»¶ä¼šç”¨N + 1
        // éå¸¸é€‚åˆä¿å®ˆçš„æ¥é™å®šå¯¹äºæœåŠ¡å™¨CPUèµ„æºçš„ä½¿ç”¨
        ExecutorService pool = Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors() - 1);
        // è¯·è€ƒè™‘å¦‚ä¸‹è¿™ç§æƒ…å†µï¼šå‰é¢3ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´éå¸¸é•¿ï¼Œè€Œåé¢æäº¤çš„2ä¸ªä»»åŠ¡ä¼šæœ‰ä¸€ä¸ªç­‰å¾…æœŸ
        for (int i = 0; i < 100; i++) {
            pool.submit(() -> { // å¼€å‘äººå‘˜ä¸éœ€è¦è‡ªå·±æ¥åˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œè€Œæ˜¯æŠŠå…³æ³¨ç‚¹æ”¾åœ¨runï¼Œä¹Ÿå°±æ˜¯å…·ä½“çš„ä¸šåŠ¡é€»è¾‘
                RandomUtils.longSleep(1000, 5000);
                System.out.println(Thread.currentThread().getName());
            });
        }
        pool.shutdown(); // ç±»ä¼¼äºå„ç§joinï¼Œå³æ˜¯ä¼šç­‰åˆ°æ‰€æœ‰æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œå†å…³é—­pool
        // pool.shutdownNow();
        // shutdownä»¥åï¼Œä¸å¯ä»¥å†æäº¤æ–°çš„ä»»åŠ¡äº†
    }
~~~



### 8.2 æ‡’æ±‰æ¨¡å¼çº¿ç¨‹æ± CachedThreadPool

- æ‡’æ±‰
  ä¸€å¼€å§‹ï¼Œpoolçš„sizeä¸º0ï¼Œéšç€æäº¤ä»»åŠ¡çš„å¢å¤šï¼Œå®ƒä¼šä¸æ–­åˆ›å»ºæ–°çš„çº¿ç¨‹å®ä¾‹ï¼Œéšç€æ—¶é—´çš„æ¨è¿›ï¼Œæœ‰çš„ä»»åŠ¡å¾ˆå¿«å°±æ‰§è¡Œå®Œäº†ï¼Œçº¿ç¨‹å¯¹è±¡ä¼šæœ‰éƒ¨åˆ†é—²ç½®ï¼Œå› æ­¤å®ƒä»¬ä¼šè¢«poolé”€æ¯(å›æ”¶)ï¼Œå®ç°poolçš„sizeå‡ºç°å¼¹æ€§å¢é•¿å’Œæ”¶ç¼©
- é€‚ç”¨äºæäº¤è¯·æ±‚çš„é¢‘ç‡ä¸æ˜¯ç‰¹åˆ«å¿«ï¼Œä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤šçš„åœºæ™¯

```java
public class Main {
    public static void main(String[] args) {
        ExecutorService pool = Executors.newCachedThreadPool();      
        for (int i = 0; i < 100; i++) {
            pool.submit(() -> { 
                RandomUtils.longSleep(1000, 5000);
                System.out.println(Thread.currentThread().getName());
            });
        }
        pool.shutdown(); // ç±»ä¼¼äºå„ç§joinï¼Œå³æ˜¯ä¼šç­‰åˆ°æ‰€æœ‰æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä»¥åï¼Œå†å…³é—­pool
        // pool.shutdownNow();

        // shutdownä»¥åï¼Œä¸å¯ä»¥å†æäº¤æ–°çš„ä»»åŠ¡äº†
    }
}
```

## 9ã€scheduleå®šæ—¶ä»»åŠ¡

### 9.1 scheduleAtFixedRate

- scheduleAtFixedRate:ä¿éšœ2ä¸ªä»»åŠ¡çš„å¼€å§‹æ—¶é—´é—´éš”ä¸º1sï¼Œä½†æ˜¯å¦‚æœæœ‰ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´è¶…å‡º1sï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªä»»åŠ¡çš„å¼€å§‹æ—¶é—´å°†ä¼šå»¶è¿Ÿåˆ°ä¸Šä¸€ä¸ªä»»åŠ¡ç»“æŸã€‚
- å‚æ•°
  - å‚æ•°1è¡¨ç¤ºRunableï¼Œé‡å†™æ–¹æ³•
  - å‚æ•°2è¡¨ç¤ºç¬¬ä¸€ä¸ªå¼€å§‹ç­‰å¾…æ—¶é—´
  - å‚æ•°3è¡¨ç¤º2ä¸ªä»»åŠ¡çš„å¼€å§‹æ—¶é—´é—´éš”
  - å‚æ•°4è¡¨ç¤ºæ—¶é—´å•ä½

```java
public class ScheduleMain {
    // å®šæ—¶ä»»åŠ¡
    public static void main(String[] args) {
        int poolSize = Runtime.getRuntime().availableProcessors() - 1;
        ScheduledExecutorService pool = Executors.newScheduledThreadPool(poolSize);

        // pool.schedule(
        //         () -> System.out.println(Thread.currentThread().getName()),
        //         3, // è¡¨ç¤ºæäº¤ä»»åŠ¡ä»¥åï¼Œéš”å¤šä¹…æ‰æ‰§è¡Œ
        //         TimeUnit.SECONDS
        // );
        // åœ¨delayæ—¶é—´è¿‡åï¼ŒæŒ‰ç…§periodçš„é¢‘ç‡æ‰§è¡Œå·²ç»æäº¤çš„ä»»åŠ¡
        // ä¿éšœä¸Šä¸€ä¸ªä»»åŠ¡çš„å¼€å§‹ä¸ä¸‹ä¸€ä¸ªä»»åŠ¡çš„å¼€å§‹ä¹‹é—´çš„é—´éš”ä¸º1s
        pool.scheduleAtFixedRate(
                () -> {
                    System.out.println(">>>" + Thread.currentThread().getName());
                    RandomUtils.longSleep(3000, 5000);
                    System.out.println("<<<" + Thread.currentThread().getName());
                }, // ä»»åŠ¡å¹¶éæ˜¯é©¬ä¸Šæäº¤
                3,
                6,
                TimeUnit.SECONDS
        );

       
```

### 9.2 scheduleWithFixedDelay

- scheduleWithFixedDelay: ä¸¥æ ¼ä¿éšœä¸Šä¸€ä¸ªä»»åŠ¡ç»“æŸå’Œä¸‹ä¸€ä¸ªä»»åŠ¡å¼€å§‹ä¹‹é—´çš„é—´éš”ä¸€å®šæ˜¯1s
- å‚æ•°
  - å‚æ•°1è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºRunableï¼Œé‡å†™æ–¹æ³•
  - å‚æ•°2è¡¨ç¤ºç¬¬ä¸€ä¸ªå¼€å§‹ç­‰å¾…æ—¶é—´
  - å‚æ•°3è¡¨ç¤ºä¸Šä¸€ä¸ªä»»åŠ¡ç»“æŸå’Œä¸‹ä¸€ä¸ªä»»åŠ¡å¼€å§‹ä¹‹é—´çš„é—´éš”
  - å‚æ•°4è¡¨ç¤ºæ—¶é—´å•ä½

~~~java
public static void main(String[] args) {
				pool.scheduleWithFixedDelay(() -> {
                    System.out.println(">>>" + Thread.currentThread().getName());
                    RandomUtils.longSleep(3000, 5000);
                    System.out.println("<<<" + Thread.currentThread().getName());
                }, // ä»»åŠ¡å¹¶éæ˜¯é©¬ä¸Šæäº¤
                3,
                1,
                TimeUnit.SECONDS);

        RandomUtils.longSleep(60000);
        pool.shutdown();

    }

}
~~~





## 10ã€é›†åˆç”¨æ³•

- int[] é•¿åº¦å›ºå®šï¼Œç±»å‹é™å®šçš„

- List

  ArrayList çº¿ç¨‹ä¸å®‰å…¨ï¼Œå› ä¸ºå®ƒçš„ä¿®æ”¹æ–¹æ³•å¹¶æ²¡æœ‰â€œåŒæ­¥åŒ–â€ï¼ŒåŒæ­¥åŒ–å°±æ˜¯ä½¿ç”¨é”çš„æœºåˆ¶ä¿éšœå¯¹åº”çš„é€»è¾‘â€œåŸå­åŒ–â€ï¼Œè¿™äº›è¢«åŸå­åŒ–çš„é€»è¾‘æ˜¯è¿è´¯æ‰§è¡Œçš„
  ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œè¿™äº›ä»£ç ç‰‡æ®µçš„æ—¶å€™ï¼Œå…¶å®ƒçº¿ç¨‹éƒ½é˜»å¡åœ¨å¤–é¢ï¼Œç­‰å¾…å®ƒä»¬å…¨éƒ¨å®Œæˆï¼Œæ‰èƒ½è¿›æ¥æ‰§è¡Œ

  CopyOnWriteArrayList

- Map

â€‹       HashMap ä¸é‡å¤ï¼Œéœ€è¦æ ¹æ®æŸä¸€ä¸ªåˆ«åã€æ ‡è¯†æ‰¾åˆ°æŸä¸€ä¸ª

â€‹       ConcurrentHashMap

- Set

â€‹       HashSet : ä¸é‡å¤ï¼Œåªéœ€è¦ç››æ”¾ï¼Œä¸éœ€è¦æ‰¾æŸä¸€ä¸ª
â€‹       ConcurrentSkipListSet

## 11ã€Futureã€Callable

### 11.1 Futureå’ŒCallable

- `Callable`æ¥å£æ¥æäº¤æœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œå¾—åˆ°`Feature`ä½œä¸ºç»“æœ

- pool.submitç”¨çš„æ˜¯Callableè€Œä¸æ˜¯Runableï¼Œå› ä¸ºRunableæ²¡æœ‰è¿”å›å€¼
- **future.get()ç­‰æ–¹æ³•æ˜¯é˜»å¡æ€§æ–¹æ³•**

~~~java
 public static void main(String[] args) throws ExecutionException, InterruptedException {
        ExecutorService pool = null;
        try {
            pool = Executors.newFixedThreadPool(3);
            // submitæ–¹æ³•ï¼šæäº¤ä¸€ä¸ªæœ‰è¿”å›å€¼çš„ä»»åŠ¡ï¼Œå®ƒä¼šç«‹å³è¿”å›ä¸€ä¸ªåŒ…è£…äº†ä¸€ä¸ªåœ¨æœªæ¥æŸä¸€ä¸ªæ—¶é—´ç‚¹ä¼šå¾—åˆ°ç»“æœçš„å¯¹è±¡
            // futureç›¸å½“äºæˆ‘ä»¬ä»¥åè·å–ç»“æœçš„ä¸€ä¸ªå¥æŸ„
            Future<String> future = pool.submit(
                    () -> {
                        RandomUtils.longSleep(3000, 5000);
                        return RandomUtils.randomString(); // x
                    }
            );
            System.out.println(0);

            String msg = future.get();// ä¼šå¾—åˆ°xå¤„æ‰€returnçš„å€¼ï¼Œè¿™ä¸ªgetæ–¹æ³•æ˜¯é˜»å¡æ€§ï¼Œé˜»å¡çš„æ—¶é—´å–å†³äºä»»åŠ¡å®é™…æ‰§è¡Œçš„æ—¶é—´

            System.out.println(msg);
        } finally {
            if (pool != null)
                pool.shutdown();
        }

        // pool.submit(new MyCall());
    }
~~~





### 11.2 æ¡ˆä¾‹

- é—®é¢˜

  å¼€è¾Ÿå¤šä¸ªçº¿ç¨‹ï¼Œåœ¨çº¿ç¨‹ä¸­éšæœºä¼‘çœ ä¸€æ®µæ—¶é—´ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œæœ€åç­‰æ‰€æœ‰çº¿ç¨‹éƒ½ç”Ÿæˆå¥½ç»“æœ
  1ã€è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹è°ç”Ÿæˆçš„æ•°å­—æœ€å¤§
  2ã€æŠŠæ‰€æœ‰çš„æ•°å­—è¿›è¡Œä»å°æ‰“åˆ°çš„é¡ºåºï¼Œæ’åºè¾“å‡ºï¼ˆé™„åŠ è¾“å‡ºæ¯ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆçš„æ—¶é—´ï¼‰


```java
 public static void main(String[] args) throws ExecutionException, InterruptedException {
        ExecutorService pool = Executors.newFixedThreadPool(3);
     
        // åˆ›å»ºä¸€ä¸ªé›†åˆï¼ŒæŠŠæ‰€æœ‰çš„ä»»åŠ¡æäº¤ç»“æœéƒ½æœé›†èµ·æ¥
        List<Future<Info>> list = new ArrayList<>();
        for (int i = 0; i < 10; i++) {
            Future<Info> future = pool.submit(() -> {
                long t1 = System.currentTimeMillis();
                RandomUtils.longSleep(3000, 7000);
                int num = RandomUtils.randomNumber(1000);
                long t2 = System.currentTimeMillis();

                return new Info(num, (t2 - t1));
            });
            list.add(future);	//è¿™é‡Œä¼šé˜»å¡
        }
        // 1ã€å¦‚ä½•å¾—åˆ°æ‰€æœ‰çš„è¿è¡Œç»“æœ
        List<Info> infos = new ArrayList<>();
        for (Future<Info> f : list) {
            Info info = f.get(); // äºæ­¤åŒæ—¶ï¼Œä»»åŠ¡ä¸ç®¡ä½ æ˜¯å¦getï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§æ—¢å®šçš„èŠ‚å¥è¿è¡Œ
            infos.add(info);
        }
        // 2ã€æ ¹æ®numæ’åº
        // if(o1.getRandomNumber()> o2.getRandomNumber()) return 1;
        // if(o1.getRandomNumber()< o2.getRandomNumber()) return -1;
        // return 0;
        Collections.sort(infos, (o1, o2) -> Integer.compare(o1.getRandomNumber(), o2.getRandomNumber()));
        System.out.println(infos);
        pool.shutdown();//ç­‰å¾…è¿è¡Œå®Œ
    }


    private static class Info {
        int randomNumber; // è¡¨ç¤ºç”Ÿæˆçš„éšæœºæ•°
        long duration; // è€—è´¹çš„æ—¶é—´
        @Override
        public String toString() {
            return "Info{" +
                    "randomNumber=" + randomNumber +
                    ", duration=" + duration +
                    '}';
        }
        public int getRandomNumber() {
            return randomNumber;
        }

        public void setRandomNumber(int randomNumber) {
            this.randomNumber = randomNumber;
        }

        public long getDuration() {
            return duration;
        }

        public void setDuration(long duration) {
            this.duration = duration;
        }

        public Info(int randomNumber, long duration) {
            this.randomNumber = randomNumber;
            this.duration = duration;
        }
    }
}
```





## 12ã€å¼‚æ­¥çº¿ç¨‹

### 12.1 CompletableFuture.runAsync

#### 12.1.1 ä»¥å¼‚æ­¥çš„æ–¹å¼æäº¤ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„ä»»åŠ¡

```java
CompletableFuture.runAsync(() -> {
    RandomUtils.longSleep(3000, 5000);
    System.out.println(RandomUtils.randomString());
});
System.out.println("æäº¤ä»»åŠ¡ä»¥åä¸»çº¿ç¨‹åç»­çš„é€»è¾‘");
```

#### 12.1.2 æŒ‰ç…§çº¿ç¨‹æ‰§è¡Œé¡ºåºå®ç°

```java
List<String> list = new ArrayList<>();
CompletableFuture<Void> future1 = CompletableFuture.runAsync(() -> {
    System.out.println("start1");
    list.add("A");
    System.out.println("end1");
});
System.out.println("ä»»åŠ¡1æäº¤å®Œæ¯•");
CompletableFuture<Void> future2 = future1.thenRunAsync(() -> {
    System.out.println("start2");
    list.add("B");
    System.out.println("end2");
});
System.out.println("ä»»åŠ¡2æäº¤å®Œæ¯•");
future2.thenRunAsync(() -> {
    System.out.println("start3");
    list.add("C");
    System.out.println("end3");
});
System.out.println("ä»»åŠ¡3æäº¤å®Œæ¯•");
```

#### 12.1.3 ä¸¥æ ¼ä¿éšœä»»åŠ¡ä¸€ç»“æŸåæ‰èƒ½å¼€å§‹ä»»åŠ¡äºŒ

```java
CompletableFuture.runAsync(() -> list.add("a"))
        .thenRunAsync(() -> list.add("b"))
        .thenRunAsync(() -> list.add("c"));

RandomUtils.longSleep(200);
System.out.println(list);
```

#### 12.1.4 æ— è¿”å›å€¼çš„å¤šä»»åŠ¡å¹¶è¡Œ


```
public static void test2() { // æ— è¿”å›å€¼çš„å¤šä»»åŠ¡å¹¶è¡Œ
    // å¹¶è¡Œçš„æäº¤å¤šä¸ªæœ‰å¯èƒ½è€—è´¹æ—¶é—´çš„ä»»åŠ¡
    // æœ€ç»ˆåœ¨æ‰€æœ‰çš„ä»»åŠ¡å®Œæˆä¹‹åï¼Œå†æ‰§è¡Œåç»­çš„æŒ‡å®šé€»è¾‘

    CompletableFuture<Void> f1 = CompletableFuture.runAsync(() -> {
        RandomUtils.longSleep(3000, 5000);
        System.out.println(RandomUtils.randomString());
    });
    CompletableFuture<Void> f2 = CompletableFuture.runAsync(() -> {
        RandomUtils.longSleep(3000, 5000);
        System.out.println(RandomUtils.randomString());
    });
    CompletableFuture<Void> f3 = CompletableFuture.runAsync(() -> {
        RandomUtils.longSleep(3000, 5000);
        System.out.println(RandomUtils.randomString());
    });

    CompletableFuture<Void> all = CompletableFuture.allOf(f1, f2, f3);
    all.thenRun(() -> {
        System.out.println("æœ€åè¿è¡Œçš„");
    });


    RandomUtils.longSleep(5000);
}
```



### 12.2 CompletableFuture.supplyAsync

#### 12.2.1 ä»¥å¼‚æ­¥çš„æ–¹å¼æäº¤ä¸€ä¸ªæœ‰è¿”å›å€¼çš„ä»»åŠ¡

```java
CompletableFuture<String> future = CompletableFuture.supplyAsync(() -> {
    RandomUtils.longSleep(3000, 5000);
    return RandomUtils.randomString();
});
System.out.println("æäº¤ä»»åŠ¡ä»¥åä¸»çº¿ç¨‹åç»­çš„é€»è¾‘");
String msg = future.get();
System.out.println(msg);
```

#### 12.2.2 æœ‰è¿”å›å€¼çš„å¤šä»»åŠ¡å¹¶è¡Œ

~~~java
  private static final Supplier<Integer> supplier = () -> {
        RandomUtils.longSleep(3000, 5000);
        int num = RandomUtils.randomNumber(100);
        System.out.println(num);
        return num;
    };
public static void test3() { // æœ‰è¿”å›å€¼çš„å¤šä»»åŠ¡å¹¶è¡Œ
        CompletableFuture<Integer> f1 = CompletableFuture.supplyAsync(supplier);
        CompletableFuture<Integer> f2 = CompletableFuture.supplyAsync(supplier);
        CompletableFuture<Integer> f3 = CompletableFuture.supplyAsync(supplier);

        CompletableFuture<Void> all = CompletableFuture.allOf(f1, f2, f3);
        all.thenRun(() -> {
            try {
                System.out.println(f1.get() + f2.get() + f3.get());
            } catch (InterruptedException | ExecutionException e) {
                throw new RuntimeException(e);
            }
            // System.out.println("æœ€åè¿è¡Œçš„");
        });

        RandomUtils.longSleep(5000);
    }
~~~

#### 12.2.3 è¶…æ—¶ä¸é˜»å¡

~~~java
 private static void test4() {
        CompletableFuture<Integer> future = CompletableFuture.supplyAsync(() -> {
            RandomUtils.longSleep(5000);
            return RandomUtils.randomNumber(100);
        });
        System.out.println("ä»»åŠ¡æäº¤å®Œæ¯•");
        Integer num = null;
        try {
            num = future.get(3, TimeUnit.SECONDS);
        } catch (Exception e) {
            // ç¼–å†™è¡¥å¿é€»è¾‘
            // å¦‚æœè¶…æ—¶äº†ï¼Œç”¨æˆ·æ²¡å¿…è¦ç»§ç»­ç­‰å¾…ï¼Œå› ä¸ºæœ‰å¯èƒ½ç¡®å®æ²¡ç¥¨äº†ï¼Œåº”å½“ç«‹å³å‘Šè¯‰ç”¨æˆ·ç»“æœ
        }
        System.out.println(num);
    }
~~~



# ğŸˆğŸˆJDKæ–°ç‰¹æ€§

## 1ã€jdkä¸­å‡½æ•°å¼æ¥å£å®¶æ—

### 1.1 Functionã€Consumerã€Supplierç­‰

```java
Function å…¥å‚-1 è¿”å›å€¼-1   
BiFunction å…¥å‚-2 è¿”å›å€¼-1

Consumer æ¶ˆè´¹è€… å…¥å‚-1
BiConsumer å…¥å‚-2

Supplier æä¾›è€… è¿”å›å€¼-1

Predicate æ–­è¨€ å…¥å‚-1 è¿”å›å€¼-å¸ƒå°”ç±»å‹
```

### 1.2 ä½¿ç”¨Supplierå’ŒConsumeræ¥å£å¯¹é›†åˆæ’åº

- Supplieræ¥å£ç”¨äºè¿”å›ç”ŸæˆUserç±»çš„é›†åˆ

```java
private static final Supplier<List<User>> s0 = () -> {
    List<User> list = new ArrayList<>();
    for (int i = 0; i < 7; i++)
        list.add(new User(RandomUtils.randomString(), RandomUtils.randomNumber(100)));
    return list;
};
```

- Consumeræ¥å£ç”¨äºæ¥å—é›†åˆè¿›è¡Œæ’åº


```java
private static final Consumer<List<User>> c0 = (users) -> {
      Collections.sort(users, Comparator.comparing(User::getName));
      System.out.println(users);
  };
```

- testSupplierAndConsumeræ–¹æ³•ç”¨äºæ¥æ”¶Supplierä¼ å›çš„é›†åˆï¼Œå¹¶å°†å…¶ä¼ ç»™Consumerï¼Œåœ¨mainå‡½æ•°é‡Œè°ƒç”¨æ­¤æ–¹æ³•åå¾—åˆ°æ’å¥½åºåçš„é›†åˆåˆ—è¡¨ï¼›

```java
public static void testSupplierAndConsumer(Consumer<List<User>> c, Supplier<List<User>> s) {
      List<User> users = s.get();
      c.accept(users);
  }
```



## 2ã€æ–¹æ³•å¼•ç”¨( :: )

  ```java
  private static List<User> createUsers() {
      List<User> list = new ArrayList<>();
      for (int i = 0; i < 7; i++)
          list.add(new User(RandomUtils.randomString(), RandomUtils.randomNumber(100)));
      return list;
  }
  private static void printUsers(List<User> users) {
      Collections.sort(users, Comparator.comparing(User::getName));
      System.out.println(users);
  }
   public static void testSupplierAndConsumer(Consumer<List<User>> c, Supplier<List<User>> s) {
          List<User> users = s.get();
          c.accept(users);
  }
    public static void main(String[] args) {
          testSupplierAndConsumer(FunctionDemo::printUsers, FunctionDemo::createUsers);
  }
  
  ```



## 3ã€æ•°ç»„è½¬æ¢æˆæµ

- ä½¿ç”¨æ•´æ•°æµéå†æ•°ç»„

```java
public static void main(String[] args) {
    // Function
    Function<Integer, int[]> fn = (size) -> {
        int[] arr = new int[size];
        for (int i = 0; i < size; i++) {
            arr[i] = RandomUtils.randomNumber(100);
        }
        return arr;
    };
    int[] arr = fn.apply(20);

    // æ•´æ•°æµçš„åˆ›å»º
    IntStream stream = Arrays.stream(arr);
    stream.forEach(System.out::println);

    System.out.println("------------------------------------------");
    // ç»è¿‡ä¸Šè¿°çš„é€»è¾‘ï¼ŒæŒ‡é’ˆå·²ç»æŒ‡å‘äº†æ•°æ®æµçš„æœ«å°¾äº†
    stream = Arrays.stream(arr);
    // åƒæ˜¯æŠŠæ•´ä¸ªæ•°ç»„ï¼Œå˜æˆäº†ä¸€è‚¡ç”±å„ä¸ªå…ƒç´ ç»„æˆçš„æ°´æµ
    stream
            .filter((item) -> item % 2 == 0) // ä½¿ç”¨æ–­è¨€è¿›è¡Œè¿‡æ»¤
            // .limit(5) // é™å®šæœ€åç»“æœä¸º5ä¸ª
            .forEach(System.out::println);
}
```



## 4ã€é›†åˆè½¬æ¢æˆæµ

- å†™ä¸€ä¸ªæ–¹æ³•ç”¨æ¥ç”Ÿæˆ20ä¸ªé•¿åº¦çš„Userç±»é›†åˆ

```java
Function<Integer, List<User>> fn = (size) -> {
      List<User> users = new ArrayList<>();
      for (int i = 0; i < size; i++) {
          users.add(new User(RandomUtils.randomString(), RandomUtils.randomNumber(100)));
      }
      return users;
  };
  
  List<User> users = fn.apply(20);
```

### 4.1 peek+filter+foreach


- streamæµæ–¹æ³•ä½¿ç”¨ï¼šå¯¹é›†åˆçš„æ“ä½œ

```java
  ï¼ˆ1ï¼‰users.stream()
          // åœ¨æ­¤å¤„å¼€äº†ä¸€ä¸ªå°çª—å£ï¼Œè®©ä½ å¯ä»¥åœ¨ä¸ä¿®æ”¹æ•°æ®çš„æƒ…å†µä¸‹å»çª¥æ¢é‡Œé¢çš„æ¯ä¸€ä¸ªå…ƒç´ çš„å†…å®¹
          // ä¸€èˆ¬ç”¨äºå¼€å‘äººå‘˜è°ƒè¯•é€»è¾‘
          .peek(u -> System.out.println(u.getAge()))
          .filter(u -> u.getAge() > 18)
          .forEach(System.out::println);
  
  ï¼ˆ2ï¼‰users.stream()
                  // .map( user -> user.getName() )
                  // .map(User::getName)
                  // ä¸€æ—¦ä½¿ç”¨mapè¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæµçš„åé¢ï¼Œå°±åªå‰©ä¸‹è¢«è½¬æ¢çš„å†…å®¹äº†
                  // .mapToInt(User::getAge)
                  .sorted(Comparator.comparing(User::getName))
                  .forEach(System.out::println);
  
```



### 4.2 filter+sorted/map + collect

- æ”¶é›†é›†åˆæ“ä½œï¼š

```java
  // é‡æ–°æ”¶é›†ç¬¦åˆæ¡ä»¶çš„ä¸€ä¸ªæ–°é›†åˆ
  /**
         æ”¶é›†ç”¨æˆ·ç±»é“¾è¡¨
  */
  List<User> userList = users.stream()
          .filter(user -> user.getAge() >= 18)
          .sorted(Comparator.comparing(User::getName))
          .collect(Collectors.toList());
  /**
         æ”¶é›†å§“åé“¾è¡¨
  */
  List<String> nameList = users.stream()
          .map(User::getName)
          .collect(Collectors.toList());
```



### 4.3 anyMatchã€max

- æ–­è¨€åŒ¹é…

```java
  // è¯¥æµä¸­åªè¦æœ‰ä¸€ä¸ªåŒ¹é…æ–­è¨€ï¼Œå°±ä¸ºtrue
boolean flag = users.stream().anyMatch(user -> user.getAge() >= 18);//noneMatchã€AllMatch
  
  users.stream().findFirst();// æ‰¾åˆ°ç¬¬ä¸€ä¸ª
  users.stream().findAny(); // æ‰¾åˆ°ä»»ä½•ä¸€ä¸ª
  
  Optional<User> opt = users.stream().max(Comparator.comparing(User::getAge));
  
  if(opt.isPresent()) { // æ‰¾åˆ°äº†ç¬¦åˆæ¡ä»¶çš„
      User user = opt.get(); // å»è·å–å®ƒ
      System.out.println(user);
  }
```

### 4.4 åˆ†ç»„æ¡ˆä¾‹(groupingBy)

```java
private static void testGroup() {
      Function<Integer, List<User>> fn = (size) -> {
          List<User> users = new ArrayList<>();
          for (int i = 0; i < size; i++) {
              users.add(new User(RandomUtils.randomString(), RandomUtils.randomNumber(100), RandomUtils.randomNumber(4)));
          }
          return users;
      };
  
      List<User> users = fn.apply(30);
  
      // æ ¹æ®ç­çº§æ¥åˆ†ç»„ï¼Œè¦æ±‚å¾—åˆ°3ä¸ªç‹¬ç«‹çš„é›†åˆæˆ–è€…æ•°ç»„
      // Map<Boolean, List<User>> collect = users.stream().collect(Collectors.partitioningBy(user -> user.getAge() >= 18));
      // Set<Map.Entry<Boolean, List<User>>> entries = collect.entrySet();
      // for (Map.Entry<Boolean, List<User>> entry : entries) {
      //     System.out.println(entry.getKey() + ":" + entry.getValue());
      // }
      Map<Integer, List<User>> collect = users.stream()
              .collect(Collectors.groupingBy(User::getClassNo));
      // æ ¹æ®2ä¸ªç”šè‡³æ›´å¤šä¸ªå­—æ®µæ¥åˆ†ç»„ï¼ˆè¿™äº›å­—æ®µçš„å€¼éƒ½ä¸€æ ·ï¼Œè®¤ä¸ºæ˜¯ä¸€ç»„çš„ï¼‰
      // users.stream().collect(Collectors.groupingBy( user -> user.getA() + user.getB()));
  
      Set<Map.Entry<Integer, List<User>>> entries = collect.entrySet();
  
      for (Map.Entry<Integer, List<User>> entry : entries) {
          System.out.println(entry.getKey() + ":" + entry.getValue());
      }
  }
```

























# ğŸ§¨ğŸ§¨MySQLğŸ§¨ğŸ§¨

# ğŸˆğŸˆæŸ¥è¯¢

## æ•°æ®åº“æ–‡ä»¶

~~~sql
DROP DATABASE IF EXISTS `sql_invoicing`;
CREATE DATABASE `sql_invoicing`; 
USE `sql_invoicing`;

SET NAMES utf8 ;
SET character_set_client = utf8mb4 ;

CREATE TABLE `payment_methods` (
  `payment_method_id` tinyint(4) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  PRIMARY KEY (`payment_method_id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `payment_methods` VALUES (1,'Credit Card');
INSERT INTO `payment_methods` VALUES (2,'Cash');
INSERT INTO `payment_methods` VALUES (3,'PayPal');
INSERT INTO `payment_methods` VALUES (4,'Wire Transfer');

CREATE TABLE `clients` (
  `client_id` int(11) NOT NULL,
  `name` varchar(50) NOT NULL,
  `address` varchar(50) NOT NULL,
  `city` varchar(50) NOT NULL,
  `state` char(2) NOT NULL,
  `phone` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`client_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `clients` VALUES (1,'Vinte','3 Nevada Parkway','Syracuse','NY','315-252-7305');
INSERT INTO `clients` VALUES (2,'Myworks','34267 Glendale Parkway','Huntington','WV','304-659-1170');
INSERT INTO `clients` VALUES (3,'Yadel','096 Pawling Parkway','San Francisco','CA','415-144-6037');
INSERT INTO `clients` VALUES (4,'Kwideo','81674 Westerfield Circle','Waco','TX','254-750-0784');
INSERT INTO `clients` VALUES (5,'Topiclounge','0863 Farmco Road','Portland','OR','971-888-9129');

CREATE TABLE `invoices` (
  `invoice_id` int(11) NOT NULL,
  `number` varchar(50) NOT NULL,
  `client_id` int(11) NOT NULL,
  `invoice_total` decimal(9,2) NOT NULL,
  `payment_total` decimal(9,2) NOT NULL DEFAULT '0.00',
  `invoice_date` date NOT NULL,
  `due_date` date NOT NULL,
  `payment_date` date DEFAULT NULL,
  PRIMARY KEY (`invoice_id`),
  KEY `FK_client_id` (`client_id`),
  CONSTRAINT `FK_client_id` FOREIGN KEY (`client_id`) REFERENCES `clients` (`client_id`) ON DELETE RESTRICT ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `invoices` VALUES (1,'91-953-3396',2,101.79,0.00,'2019-03-09','2019-03-29',NULL);
INSERT INTO `invoices` VALUES (2,'03-898-6735',5,175.32,8.18,'2019-06-11','2019-07-01','2019-02-12');
INSERT INTO `invoices` VALUES (3,'20-228-0335',5,147.99,0.00,'2019-07-31','2019-08-20',NULL);
INSERT INTO `invoices` VALUES (4,'56-934-0748',3,152.21,0.00,'2019-03-08','2019-03-28',NULL);
INSERT INTO `invoices` VALUES (5,'87-052-3121',5,169.36,0.00,'2019-07-18','2019-08-07',NULL);
INSERT INTO `invoices` VALUES (6,'75-587-6626',1,157.78,74.55,'2019-01-29','2019-02-18','2019-01-03');
INSERT INTO `invoices` VALUES (7,'68-093-9863',3,133.87,0.00,'2019-09-04','2019-09-24',NULL);
INSERT INTO `invoices` VALUES (8,'78-145-1093',1,189.12,0.00,'2019-05-20','2019-06-09',NULL);
INSERT INTO `invoices` VALUES (9,'77-593-0081',5,172.17,0.00,'2019-07-09','2019-07-29',NULL);
INSERT INTO `invoices` VALUES (10,'48-266-1517',1,159.50,0.00,'2019-06-30','2019-07-20',NULL);
INSERT INTO `invoices` VALUES (11,'20-848-0181',3,126.15,0.03,'2019-01-07','2019-01-27','2019-01-11');
INSERT INTO `invoices` VALUES (13,'41-666-1035',5,135.01,87.44,'2019-06-25','2019-07-15','2019-01-26');
INSERT INTO `invoices` VALUES (15,'55-105-9605',3,167.29,80.31,'2019-11-25','2019-12-15','2019-01-15');
INSERT INTO `invoices` VALUES (16,'10-451-8824',1,162.02,0.00,'2019-03-30','2019-04-19',NULL);
INSERT INTO `invoices` VALUES (17,'33-615-4694',3,126.38,68.10,'2019-07-30','2019-08-19','2019-01-15');
INSERT INTO `invoices` VALUES (18,'52-269-9803',5,180.17,42.77,'2019-05-23','2019-06-12','2019-01-08');
INSERT INTO `invoices` VALUES (19,'83-559-4105',1,134.47,0.00,'2019-11-23','2019-12-13',NULL);

CREATE TABLE `payments` (
  `payment_id` int(11) NOT NULL AUTO_INCREMENT,
  `client_id` int(11) NOT NULL,
  `invoice_id` int(11) NOT NULL,
  `date` date NOT NULL,
  `amount` decimal(9,2) NOT NULL,
  `payment_method` tinyint(4) NOT NULL,
  PRIMARY KEY (`payment_id`),
  KEY `fk_client_id_idx` (`client_id`),
  KEY `fk_invoice_id_idx` (`invoice_id`),
  KEY `fk_payment_payment_method_idx` (`payment_method`),
  CONSTRAINT `fk_payment_client` FOREIGN KEY (`client_id`) REFERENCES `clients` (`client_id`) ON UPDATE CASCADE,
  CONSTRAINT `fk_payment_invoice` FOREIGN KEY (`invoice_id`) REFERENCES `invoices` (`invoice_id`) ON UPDATE CASCADE,
  CONSTRAINT `fk_payment_payment_method` FOREIGN KEY (`payment_method`) REFERENCES `payment_methods` (`payment_method_id`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `payments` VALUES (1,5,2,'2019-02-12',8.18,1);
INSERT INTO `payments` VALUES (2,1,6,'2019-01-03',74.55,1);
INSERT INTO `payments` VALUES (3,3,11,'2019-01-11',0.03,1);
INSERT INTO `payments` VALUES (4,5,13,'2019-01-26',87.44,1);
INSERT INTO `payments` VALUES (5,3,15,'2019-01-15',80.31,1);
INSERT INTO `payments` VALUES (6,3,17,'2019-01-15',68.10,1);
INSERT INTO `payments` VALUES (7,5,18,'2019-01-08',32.77,1);
INSERT INTO `payments` VALUES (8,5,18,'2019-01-08',10.00,2);


DROP DATABASE IF EXISTS `sql_store`;
CREATE DATABASE `sql_store`;
USE `sql_store`;

CREATE TABLE `products` (
  `product_id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `quantity_in_stock` int(11) NOT NULL,
  `unit_price` decimal(4,2) NOT NULL,
  PRIMARY KEY (`product_id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `products` VALUES (1,'Foam Dinner Plate',70,1.21);
INSERT INTO `products` VALUES (2,'Pork - Bacon,back Peameal',49,4.65);
INSERT INTO `products` VALUES (3,'Lettuce - Romaine, Heart',38,3.35);
INSERT INTO `products` VALUES (4,'Brocolinni - Gaylan, Chinese',90,4.53);
INSERT INTO `products` VALUES (5,'Sauce - Ranch Dressing',94,1.63);
INSERT INTO `products` VALUES (6,'Petit Baguette',14,2.39);
INSERT INTO `products` VALUES (7,'Sweet Pea Sprouts',98,3.29);
INSERT INTO `products` VALUES (8,'Island Oasis - Raspberry',26,0.74);
INSERT INTO `products` VALUES (9,'Longan',67,2.26);
INSERT INTO `products` VALUES (10,'Broom - Push',6,1.09);


CREATE TABLE `shippers` (
  `shipper_id` smallint(6) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  PRIMARY KEY (`shipper_id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `shippers` VALUES (1,'Hettinger LLC');
INSERT INTO `shippers` VALUES (2,'Schinner-Predovic');
INSERT INTO `shippers` VALUES (3,'Satterfield LLC');
INSERT INTO `shippers` VALUES (4,'Mraz, Renner and Nolan');
INSERT INTO `shippers` VALUES (5,'Waters, Mayert and Prohaska');


CREATE TABLE `customers` (
  `customer_id` int(11) NOT NULL AUTO_INCREMENT,
  `first_name` varchar(50) NOT NULL,
  `last_name` varchar(50) NOT NULL,
  `birth_date` date DEFAULT NULL,
  `phone` varchar(50) DEFAULT NULL,
  `address` varchar(50) NOT NULL,
  `city` varchar(50) NOT NULL,
  `state` char(2) NOT NULL,
  `points` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`customer_id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `customers` VALUES (1,'Babara','MacCaffrey','1986-03-28','781-932-9754','0 Sage Terrace','Waltham','MA',2273);
INSERT INTO `customers` VALUES (2,'Ines','Brushfield','1986-04-13','804-427-9456','14187 Commercial Trail','Hampton','VA',947);
INSERT INTO `customers` VALUES (3,'Freddi','Boagey','1985-02-07','719-724-7869','251 Springs Junction','Colorado Springs','CO',2967);
INSERT INTO `customers` VALUES (4,'Ambur','Roseburgh','1974-04-14','407-231-8017','30 Arapahoe Terrace','Orlando','FL',457);
INSERT INTO `customers` VALUES (5,'Clemmie','Betchley','1973-11-07',NULL,'5 Spohn Circle','Arlington','TX',3675);
INSERT INTO `customers` VALUES (6,'Elka','Twiddell','1991-09-04','312-480-8498','7 Manley Drive','Chicago','IL',3073);
INSERT INTO `customers` VALUES (7,'Ilene','Dowson','1964-08-30','615-641-4759','50 Lillian Crossing','Nashville','TN',1672);
INSERT INTO `customers` VALUES (8,'Thacher','Naseby','1993-07-17','941-527-3977','538 Mosinee Center','Sarasota','FL',205);
INSERT INTO `customers` VALUES (9,'Romola','Rumgay','1992-05-23','559-181-3744','3520 Ohio Trail','Visalia','CA',1486);
INSERT INTO `customers` VALUES (10,'Levy','Mynett','1969-10-13','404-246-3370','68 Lawn Avenue','Atlanta','GA',796);


CREATE TABLE `order_statuses` (
  `order_status_id` tinyint(4) NOT NULL,
  `name` varchar(50) NOT NULL,
  PRIMARY KEY (`order_status_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `order_statuses` VALUES (1,'Processed');
INSERT INTO `order_statuses` VALUES (2,'Shipped');
INSERT INTO `order_statuses` VALUES (3,'Delivered');


CREATE TABLE `orders` (
  `order_id` int(11) NOT NULL AUTO_INCREMENT,
  `customer_id` int(11) NOT NULL,
  `order_date` date NOT NULL,
  `status` tinyint(4) NOT NULL DEFAULT '1',
  `comments` varchar(2000) DEFAULT NULL,
  `shipped_date` date DEFAULT NULL,
  `shipper_id` smallint(6) DEFAULT NULL,
  PRIMARY KEY (`order_id`),
  KEY `fk_orders_customers_idx` (`customer_id`),
  KEY `fk_orders_shippers_idx` (`shipper_id`),
  KEY `fk_orders_order_statuses_idx` (`status`),
  CONSTRAINT `fk_orders_customers` FOREIGN KEY (`customer_id`) REFERENCES `customers` (`customer_id`) ON UPDATE CASCADE,
  CONSTRAINT `fk_orders_order_statuses` FOREIGN KEY (`status`) REFERENCES `order_statuses` (`order_status_id`) ON UPDATE CASCADE,
  CONSTRAINT `fk_orders_shippers` FOREIGN KEY (`shipper_id`) REFERENCES `shippers` (`shipper_id`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `orders` VALUES (1,6,'2019-01-30',1,NULL,NULL,NULL);
INSERT INTO `orders` VALUES (2,7,'2018-08-02',2,NULL,'2018-08-03',4);
INSERT INTO `orders` VALUES (3,8,'2017-12-01',1,NULL,NULL,NULL);
INSERT INTO `orders` VALUES (4,2,'2017-01-22',1,NULL,NULL,NULL);
INSERT INTO `orders` VALUES (5,5,'2017-08-25',2,'','2017-08-26',3);
INSERT INTO `orders` VALUES (6,10,'2018-11-18',1,'Aliquam erat volutpat. In congue.',NULL,NULL);
INSERT INTO `orders` VALUES (7,2,'2018-09-22',2,NULL,'2018-09-23',4);
INSERT INTO `orders` VALUES (8,5,'2018-06-08',1,'Mauris enim leo, rhoncus sed, vestibulum sit amet, cursus id, turpis.',NULL,NULL);
INSERT INTO `orders` VALUES (9,10,'2017-07-05',2,'Nulla mollis molestie lorem. Quisque ut erat.','2017-07-06',1);
INSERT INTO `orders` VALUES (10,6,'2018-04-22',2,NULL,'2018-04-23',2);


CREATE TABLE `order_items` (
  `order_id` int(11) NOT NULL AUTO_INCREMENT,
  `product_id` int(11) NOT NULL,
  `quantity` int(11) NOT NULL,
  `unit_price` decimal(4,2) NOT NULL,
  PRIMARY KEY (`order_id`,`product_id`),
  KEY `fk_order_items_products_idx` (`product_id`),
  CONSTRAINT `fk_order_items_orders` FOREIGN KEY (`order_id`) REFERENCES `orders` (`order_id`) ON UPDATE CASCADE,
  CONSTRAINT `fk_order_items_products` FOREIGN KEY (`product_id`) REFERENCES `products` (`product_id`) ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `order_items` VALUES (1,4,4,3.74);
INSERT INTO `order_items` VALUES (2,1,2,9.10);
INSERT INTO `order_items` VALUES (2,4,4,1.66);
INSERT INTO `order_items` VALUES (2,6,2,2.94);
INSERT INTO `order_items` VALUES (3,3,10,9.12);
INSERT INTO `order_items` VALUES (4,3,7,6.99);
INSERT INTO `order_items` VALUES (4,10,7,6.40);
INSERT INTO `order_items` VALUES (5,2,3,9.89);
INSERT INTO `order_items` VALUES (6,1,4,8.65);
INSERT INTO `order_items` VALUES (6,2,4,3.28);
INSERT INTO `order_items` VALUES (6,3,4,7.46);
INSERT INTO `order_items` VALUES (6,5,1,3.45);
INSERT INTO `order_items` VALUES (7,3,7,9.17);
INSERT INTO `order_items` VALUES (8,5,2,6.94);
INSERT INTO `order_items` VALUES (8,8,2,8.59);
INSERT INTO `order_items` VALUES (9,6,5,7.28);
INSERT INTO `order_items` VALUES (10,1,10,6.01);
INSERT INTO `order_items` VALUES (10,9,9,4.28);

CREATE TABLE `sql_store`.`order_item_notes` (
  `note_id` INT NOT NULL,
  `order_Id` INT NOT NULL,
  `product_id` INT NOT NULL,
  `note` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`note_id`));

INSERT INTO `order_item_notes` (`note_id`, `order_Id`, `product_id`, `note`) VALUES ('1', '1', '2', 'first note');
INSERT INTO `order_item_notes` (`note_id`, `order_Id`, `product_id`, `note`) VALUES ('2', '1', '2', 'second note');


DROP DATABASE IF EXISTS `sql_hr`;
CREATE DATABASE `sql_hr`;
USE `sql_hr`;


CREATE TABLE `offices` (
  `office_id` int(11) NOT NULL,
  `address` varchar(50) NOT NULL,
  `city` varchar(50) NOT NULL,
  `state` varchar(50) NOT NULL,
  PRIMARY KEY (`office_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `offices` VALUES (1,'03 Reinke Trail','Cincinnati','OH');
INSERT INTO `offices` VALUES (2,'5507 Becker Terrace','New York City','NY');
INSERT INTO `offices` VALUES (3,'54 Northland Court','Richmond','VA');
INSERT INTO `offices` VALUES (4,'08 South Crossing','Cincinnati','OH');
INSERT INTO `offices` VALUES (5,'553 Maple Drive','Minneapolis','MN');
INSERT INTO `offices` VALUES (6,'23 North Plaza','Aurora','CO');
INSERT INTO `offices` VALUES (7,'9658 Wayridge Court','Boise','ID');
INSERT INTO `offices` VALUES (8,'9 Grayhawk Trail','New York City','NY');
INSERT INTO `offices` VALUES (9,'16862 Westend Hill','Knoxville','TN');
INSERT INTO `offices` VALUES (10,'4 Bluestem Parkway','Savannah','GA');



CREATE TABLE `employees` (
  `employee_id` int(11) NOT NULL,
  `first_name` varchar(50) NOT NULL,
  `last_name` varchar(50) NOT NULL,
  `job_title` varchar(50) NOT NULL,
  `salary` int(11) NOT NULL,
  `reports_to` int(11) DEFAULT NULL,
  `office_id` int(11) NOT NULL,
  PRIMARY KEY (`employee_id`),
  KEY `fk_employees_offices_idx` (`office_id`),
  KEY `fk_employees_employees_idx` (`reports_to`),
  CONSTRAINT `fk_employees_managers` FOREIGN KEY (`reports_to`) REFERENCES `employees` (`employee_id`),
  CONSTRAINT `fk_employees_offices` FOREIGN KEY (`office_id`) REFERENCES `offices` (`office_id`) ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `employees` VALUES (37270,'Yovonnda','Magrannell','Executive Secretary',63996,NULL,10);
INSERT INTO `employees` VALUES (33391,'D\'arcy','Nortunen','Account Executive',62871,37270,1);
INSERT INTO `employees` VALUES (37851,'Sayer','Matterson','Statistician III',98926,37270,1);
INSERT INTO `employees` VALUES (40448,'Mindy','Crissil','Staff Scientist',94860,37270,1);
INSERT INTO `employees` VALUES (56274,'Keriann','Alloisi','VP Marketing',110150,37270,1);
INSERT INTO `employees` VALUES (63196,'Alaster','Scutchin','Assistant Professor',32179,37270,2);
INSERT INTO `employees` VALUES (67009,'North','de Clerc','VP Product Management',114257,37270,2);
INSERT INTO `employees` VALUES (67370,'Elladine','Rising','Social Worker',96767,37270,2);
INSERT INTO `employees` VALUES (68249,'Nisse','Voysey','Financial Advisor',52832,37270,2);
INSERT INTO `employees` VALUES (72540,'Guthrey','Iacopetti','Office Assistant I',117690,37270,3);
INSERT INTO `employees` VALUES (72913,'Kass','Hefferan','Computer Systems Analyst IV',96401,37270,3);
INSERT INTO `employees` VALUES (75900,'Virge','Goodrum','Information Systems Manager',54578,37270,3);
INSERT INTO `employees` VALUES (76196,'Mirilla','Janowski','Cost Accountant',119241,37270,3);
INSERT INTO `employees` VALUES (80529,'Lynde','Aronson','Junior Executive',77182,37270,4);
INSERT INTO `employees` VALUES (80679,'Mildrid','Sokale','Geologist II',67987,37270,4);
INSERT INTO `employees` VALUES (84791,'Hazel','Tarbert','General Manager',93760,37270,4);
INSERT INTO `employees` VALUES (95213,'Cole','Kesterton','Pharmacist',86119,37270,4);
INSERT INTO `employees` VALUES (96513,'Theresa','Binney','Food Chemist',47354,37270,5);
INSERT INTO `employees` VALUES (98374,'Estrellita','Daleman','Staff Accountant IV',70187,37270,5);
INSERT INTO `employees` VALUES (115357,'Ivy','Fearey','Structural Engineer',92710,37270,5);


DROP DATABASE IF EXISTS `sql_inventory`;
CREATE DATABASE `sql_inventory`;
USE `sql_inventory`;


CREATE TABLE `products` (
  `product_id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `quantity_in_stock` int(11) NOT NULL,
  `unit_price` decimal(4,2) NOT NULL,
  PRIMARY KEY (`product_id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
INSERT INTO `products` VALUES (1,'Foam Dinner Plate',70,1.21);
INSERT INTO `products` VALUES (2,'Pork - Bacon,back Peameal',49,4.65);
INSERT INTO `products` VALUES (3,'Lettuce - Romaine, Heart',38,3.35);
INSERT INTO `products` VALUES (4,'Brocolinni - Gaylan, Chinese',90,4.53);
INSERT INTO `products` VALUES (5,'Sauce - Ranch Dressing',94,1.63);
INSERT INTO `products` VALUES (6,'Petit Baguette',14,2.39);
INSERT INTO `products` VALUES (7,'Sweet Pea Sprouts',98,3.29);
INSERT INTO `products` VALUES (8,'Island Oasis - Raspberry',26,0.74);
INSERT INTO `products` VALUES (9,'Longan',67,2.26);
INSERT INTO `products` VALUES (10,'Broom - Push',6,1.09);


~~~



## 1ã€å•è¡¨æŸ¥è¯¢

### 1.1 selectæŸ¥è¯¢

```sql
select * from customers;
select * from customers where customer_id=1;
select * from customers order by 
```

- Selectï¼šç”¨æ¥æŒ‘é€‰è¦æŸ¥è¯¢çš„åˆ—
- fromï¼šæŸ¥è¯¢å“ªä¸€å¼ è¡¨
- whereï¼šå£°æ˜æŸ¥è¯¢æ¡ä»¶
- orderï¼šæ ¹æ®å“ªäº›å­—æ®µè¿›è¡Œæ’åº

ä¸€æ¡å®Œæ•´çš„SQLæ˜¯ç”±å¤šä¸ªå­å¥ç»„æˆçš„ï¼Œå„ä¸ªå­å¥éƒ½æ˜¯éœ€è¦æŒ‰ç…§æŒ‡å®šçš„é¡ºåºæ’åˆ—çš„ï¼Œå¦åˆ™ä¼šå‡ºç°è¯­æ³•é”™è¯¯è€Œæ— æ³•æ‰§è¡Œã€‚

### 1.2 selectå­å¥

```sql
-- æŒ‘é€‰æŒ‡å®šçš„åˆ—è¿›è¡ŒæŸ¥è¯¢
select first_name,last_name from customers;

-- åˆ—ä¸åˆ—å¯ä»¥è°ƒæ¢é¡ºåºï¼Œç»“æœå±•ç¤ºçš„æ—¶å€™ä¹Ÿä¼šå‡ºç°ç›¸åº”çš„å˜åŒ–
select last_name,first_name from customers;

-- ç‰¹å®šçš„åˆ—å¯ä»¥ç»“åˆæ•°å­¦è¡¨è¾¾å¼ä¸€èµ·ä½¿ç”¨
select first_name,last_name,points,points*0.9 from customers;

-- ä¸ºäº†åœ¨æŸ¥çœ‹æ•°æ®çš„æ—¶å€™æ–¹ä¾¿å¯¹æŸåˆ—è¿›è¡Œç†è§£ï¼Œå¯ä»¥å¯¹åˆ—ä½¿ç”¨aså–åˆ«å
select first_name,last_name,points,points*0.9 as discount from customers;

-- å¦‚æœåˆ«åä¸­å«æœ‰ç©ºæ ¼ï¼Œéœ€è¦ä½¿ç”¨å•å¼•å·åŒ…å«èµ·æ¥
select first_name,last_name,points,points*0.9 as 'æŠ˜ æ‰£' from customers;

-- ä½¿ç”¨distinctä¿®é¥°åˆ—åè¿›è¡Œå»é‡æŸ¥è¯¢
select distinct state from customers;

-- ç»ƒä¹ ï¼šæŸ¥è¯¢å•†å“è¡¨ï¼ˆåç§°ã€å•ä»·ã€1.1å€å•ä»·-åˆ«åâ€˜æ–°å•ä»·â€™ï¼‰
```

### 1.3 whereå­å¥

`where`å­å¥ç”¨æ¥å¯¹æŸ¥è¯¢ç»“æœæ ¹æ®æ¡ä»¶è¿›è¡Œç­›é€‰ï¼š

- é¦–å…ˆéå†æ‰€æœ‰ç»“æœ
- ç„¶åå¯¹æ¯ä¸€æ¡ç»“æœï¼Œåº”ç”¨æ¡ä»¶è¿›è¡Œæ£€æµ‹
- å¦‚æœæ¡ä»¶æ»¡è¶³ï¼ˆ`true`ï¼‰ï¼Œå°±ä¼šè¿”å›è¿™æ¡è®°å½•åˆ°æœ€ç»ˆç»“æœé›†

```sql
-- >ã€>=ã€<ã€<=ã€=ã€!=ã€<>
select * from customers where points>3000;
select * from customers where state='VA';
select * from customers where birth_date>'1990-01-01';

-- ç»ƒä¹ ï¼šæŸ¥è¯¢2019å¹´å‘ç”Ÿçš„æ‰€æœ‰è®¢å•

-- ä½¿ç”¨andã€orã€notç»„åˆå¤šä¸ªæ¡ä»¶
select * from customers where birth_date>'1990-01-01' and points>1000;
select * from customers where birth_date>'1990-01-01' or points>1000;

-- andä¼˜å…ˆçº§å¤§äºor
select * from customers where birth_date>'1990-01-01' or points>1000 and state='va';

-- ä½¿ç”¨æ‹¬å·è®©è¯­ä¹‰æ›´æ¸…æ™°
select * from customers where birth_date>'1990-01-01' or (points>1000 and state='va');
-- notå–å
select * from customers where not(birth_date>'1990-01-01' or points>1000);
select * from customers where (birth_date<='1990-01-01' and points<=1000);

-- ç»ƒä¹ ï¼šæŸ¥è¯¢è®¢å•æ˜ç»†è¡¨ï¼Œæå–è®¢å•ç¼–å·ä¸º6ï¼Œä¸”æ€»ä»·å¤§äº30çš„è®°å½•

-- inè¡¨ç¤ºä¸€å®šèŒƒå›´
select * from customers where state in('va','ga','fl');
select * from customers where state not in('va','ga','fl');

-- ç»ƒä¹ ï¼šæŸ¥è¯¢å•†å“è¡¨ï¼Œæå–åº“å­˜ä¸º49ã€38æˆ–72çš„è®°å½•

-- betweenï¼ŒåŒ…å«å·¦å³è¾¹ç•Œå€¼
select * from customers where points between 1000 and 3000;

-- ç»ƒä¹ ï¼šæŸ¥è¯¢å®¢æˆ·ä¸­ç”Ÿæ—¥åœ¨1990/1/1åˆ°2000/1/1ä¹‹é—´çš„æ‰€æœ‰è®°å½•

-- likeè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%ä»»æ„å¤šä¸ªä»»æ„å­—ç¬¦ _ä»»æ„ä¸€ä¸ªå­—ç¬¦
select * from customers where last_name like 'b%'; -- ä»¥bå¼€å¤´
select * from customers where last_name like '%b%'; -- å«æœ‰bå­—æ¯
select * from customers where last_name like '%b'; -- ä»¥bç»“å°¾

-- ç»ƒä¹ ï¼šæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯ï¼Œåœ°å€ä¸­åŒ…å«trailæˆ–avenue

-- ç»ƒä¹ ï¼šæŸ¥è¯¢å®¢æˆ·ä¿¡æ¯ï¼Œç”µè¯å·ç ä»¥9ç»“å°¾çš„

-- æ­£åˆ™è¡¨è¾¾å¼æŸ¥è¯¢
-- ^ å­—ç¬¦ä¸²å¼€å§‹
-- $ å­—ç¬¦ä¸²ç»“æŸ
-- | é€»è¾‘æˆ–
select * from customers where last_name regexp '^field|mac';
select * from customers where last_name regexp 'field$|mac';
select * from customers where last_name regexp '[gim]e';
select * from customers where last_name regexp '[a-h]e';

-- ç»ƒä¹ 
-- first_name ä¸­æœ‰ elka æˆ– ambur
-- last_name ä¸­æœ‰ ey æˆ– on
-- last_name ä»¥ my å¼€å¤´ æˆ– åŒ…å« se
-- last_name åŒ…å« br æˆ– bu

-- nullæŸ¥è¯¢
select * from customers where phone is null;
select * from customers where phone is not null;

-- ç»ƒä¹  æ‰¾å‡ºæ²¡æœ‰å‘è´§çš„è®¢å•

```

### 1.4 order byå­å¥

```sql
select * from customers order by first_name;
select * from customers order by first_name desc;
select * from customers order by state,first_name;

-- ç»ƒä¹  æŸ¥è¯¢è®¢å•ç¼–å·ä¸º2çš„è®¢å•è¯¦æƒ…ï¼ŒæŒ‰ç…§è®¢å•æ€»ä»·é™åºæ’åˆ—
```

### 1.5 limitå­å¥ï¼ˆåˆ†é¡µæŸ¥è¯¢ï¼‰

```sql
-- limit size;
-- limit offset, size
select * from customers limit 0,3;

-- ç»ƒä¹  æ‰¾å‡ºç§¯åˆ†å‰ä¸‰çš„ç”¨æˆ·

```

## 2ã€å¤šè¡¨æŸ¥è¯¢

### 2.1 å†…è¿æ¥

```sql
-- æŸ¥è¯¢è®¢å•å’Œç›¸åº”çš„å®¢æˆ·ä¿¡æ¯
select order_id,o.customer_id,first_name,last_name
	from orders o join customers c
	on o.customer_id = c.customer_id;
	
-- ç»ƒä¹  æŸ¥è¯¢è®¢å•è¯¦æƒ…è¡¨ï¼Œæ˜¾ç¤ºå•†å“åç§°ä¿¡æ¯
```

### 2.2 è‡ªè¿æ¥

```sql
-- æŸ¥è¯¢æ¯ä¸ªå‘˜å·¥å’Œä»–ä»¬çš„ç®¡ç†è€…
select e.employee_id,e.first_name,m.employee_id,m.first_name
	from employee e join employee m
	on e.reports_to = m.employee_id;
```

### 2.3 åˆå¹¶å¤šä¸ªè¡¨

```sql
-- æŸ¥è¯¢è®¢å•è¡¨ï¼ŒåŒæ—¶æ˜¾ç¤ºç›¸åº”çš„å®¢æˆ·ä¿¡æ¯å’Œè®¢å•çŠ¶æ€ä¿¡æ¯
select o.order_id,o.order_date,c.first_name,c.last_name,os.name
	from orders o
	join customers c on o.customer_id = c.customer_id
	join order_statuses os on o.status = os.order_status_id;
	
-- ç»ƒä¹  æŸ¥è¯¢æ”¯ä»˜è¡¨ï¼ŒåŒæ—¶æ˜¾ç¤ºæ”¯ä»˜æ–¹å¼å’Œå®¢æˆ·ä¿¡æ¯

```

### 2.4 ç»„åˆå…³è”æŸ¥è¯¢

åœ¨`order_items`ä¸­ï¼Œ`order_id`å’Œ`product_id`æ˜¯ä¸è¶³ä»¥å•ç‹¬æ ‡ç¤ºå”¯ä¸€æ€§çš„ï¼Œå¿…é¡»ç»„åˆèµ·æ¥æ‰èƒ½ã€‚ä¹Ÿå³æ˜¯è¡¨ä¸­çš„æ•°æ®ï¼Œä¸å­˜åœ¨ä¸¤ä¸ªå®Œå…¨ä¸€æ ·çš„ç»„åˆã€‚

```sql
select *
	from order_items oi
	join order_item_notes oin
	on oi.order_id = oin.order_id and oi.product_id = oin.product_id;
```

### 2.5 éšå¼å…³è”æŸ¥è¯¢

```sql
select * from orders o,customers c where o.customer_id = c.customer_id;
```

### 2.6 å¤–è¿æ¥

```sql
select c.customer_id,c.first_name,o.order_id
	from customer c
	left join orders o
	on c.customer_id = o.customer_id
	order by c.customer_id;
```

åœ¨`SQL`ä¸­åˆ†ä¸ºå·¦è¿æ¥å’Œå³è¿æ¥ä¸¤ç§ï¼Œå½“ä¸ºå·¦è¿æ¥æŸ¥è¯¢æ—¶ï¼Œå·¦è¡¨çš„è®°å½•æ— è®ºè¿æ¥æ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œéƒ½ä¼šä½œä¸ºç»“æœè¿”å›ï¼Œå³è¿æ¥åŒç†ã€‚

```sql
-- ç»ƒä¹  æŸ¥è¯¢å•†å“åŠå…¶è®¢è´­çš„æ¬¡æ•°å’Œæ•°é‡
```

### 2.7 å¤šè¡¨å¤–è¿æ¥

```sql
-- æŸ¥è¯¢ å•†å“çš„è®¢è´­æ•°é‡ä¸ç›¸åº”çš„ç‰©æµä¿¡æ¯
select c.customer_id,c.first_name,o.order_id,s.name
	from customer c
	left join orders o
	on c.customer_id = o.customer_id
	left join shippers s
	on o.shipper_id = s.shipper_id
	order by c.customer_id;
	
-- ç»ƒä¹  æŸ¥è¯¢è®¢å•åŠå…¶ç›¸åº”çš„å®¢æˆ·å’Œç‰©æµçŠ¶æ€ä¿¡æ¯
```

### 2.8 è‡ªå¤–è¿æ¥

```sql
-- æŸ¥è¯¢æ‰€æœ‰çš„é›‡å‘˜åŠå…¶ç®¡ç†è€…
select e.employee_id,e.first_name,m.first_name
	from employees e
	left join employees m
	on e.employee_id = m.employee_id;
```

### 2.9 usingä»å¥

```sql
select o.order_id,c.first_name
	from orders o
	join customers c
	-- on o.customer_id = c.customer_id
	using (customer_id);
	
-- åŒæ ·é€‚ç”¨äºç»„åˆå…³è”æŸ¥è¯¢
select * from order_items io join order_item_notes oin using (order_id,product_id);

-- ç»ƒä¹  æŸ¥è¯¢æ”¯ä»˜è¡¨ï¼Œæ˜¾ç¤ºå¯¹åº”çš„å®¢æˆ·å’Œæ”¯ä»˜æ–¹å¼ä¿¡æ¯
```

### 2.10 è‡ªç„¶è¿æ¥

```sql
select * from customers natural join orders;
```

åœ¨è‡ªç„¶è¿æ¥ä¸­ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨åŒ¹é…ç›¸åŒçš„åˆ—ä½œä¸ºè¿æ¥æ¡ä»¶

### 2.11 äº¤å‰è¿æ¥

```sql
select c.first_name,p.name from customers c cross join products p;
select c.first_name,p.name from customers c , products p;
```

åœ¨äº¤å‰è¿æ¥ä¸­ï¼Œå·¦è¡¨çš„æ¯æ¡è®°å½•éƒ½ä¼šä¸å³è¡¨çš„æ¯æ¡è®°å½•è¿›è¡Œè¿æ¥ã€‚

### 2.12 è”åˆæŸ¥è¯¢

è”åˆæŸ¥è¯¢ç”¨æ¥è¿æ¥ä¸¤ä¸ªæŸ¥è¯¢ç»“æœé›†

```sql
select order_id,order_date, 'active' from orders where order_date>='2019-01-01'
union
select order_id,order_date, 'archived' from orders where order_date<'2019-01-01'

-- ä¹Ÿå¯ä»¥ç”¨æ¥è”åˆä¸åŒçš„è¡¨
select first_name from customers
union
select name from shippers;
```

> éœ€è¦æ³¨æ„çš„æ˜¯æ¯ä¸ªæŸ¥è¯¢è¿”å›çš„åˆ—æ•°è¦ä¸€è‡´

```sql
-- ç»ƒä¹  æ ¹æ®ç”¨æˆ·çš„ç§¯åˆ†è¿›è¡Œé‡‘é“¶é“œçš„åˆ†çº§
```

### 2.13 in

~~~sql
-- æŸ¥è¯¢ä»æ¥æ²¡æœ‰è®¢å•çš„å•†å“ä¿¡æ¯
select * from products
	where product_id not in (select distinct product_id from order_items);
	
-- ç»ƒä¹  æŸ¥è¯¢æ²¡æœ‰å‘ç¥¨è®°å½•çš„å®¢æˆ·
~~~



## 3ã€å¢åˆ æ”¹

### 3.1 åˆ—å±æ€§

- Columnï¼šåˆ—åç§°ï¼Œä¸€èˆ¬ç”¨è›‡å½¢å‘½åæ³•
- Datatypeï¼šæ•°æ®ç±»å‹
- PKï¼šä¸»é”®ï¼Œæ¯ä¸€å¼ è¡¨éƒ½æœ‰ä¸»é”®
- NNï¼šéç©ºå±æ€§
- AIï¼šè‡ªåŠ¨å¢é•¿åˆ—
- Defaultï¼šé»˜è®¤å€¼

### 3.2 insert

```sql
-- æ’å…¥ä¸€è¡Œæ•°æ®
insert into customers 
	values(default,'John','Smith','2020-01-01',null,'address','city','CA',200);
	
insert into customers (first_name,last_name,birth_date,address,city,state)
	values('John','Smith','2020-01-01','address','city','CA');
	
-- åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œå¯¹åº”çš„åˆ—åå¯ä»¥æ‰“ä¹±é¡ºåºï¼Œç›¸åº”çš„valueséƒ¨åˆ†ï¼Œä¹Ÿåº”è¯¥ç›¸åº”è°ƒæ•´é¡ºåº

-- æ’å…¥å¤šè¡Œæ•°æ®
insert into shippers(name) values('shipper1'),('shipper2');

-- ç»ƒä¹  å‘productsè¡¨ä¸­æ’å…¥3æ¡è®°å½•

-- å‘å¤šå¼ è¡¨æ’å…¥æ•°æ®
insert into orders(customer_id,order_date,status)
	values(1,'2021-06-01',1);

insert into order_items 
	values(last_insert_id(),1,1,2.95),(last_insert_id(),2,1,3.95);
	
-- copyä¸€å¼ è¡¨çš„æ•°æ®
create table orders_archived as
	select * from orders;
	
insert into orders_archived 
	select * from orders where order_date<'1990-01-01';
	
-- ç»ƒä¹  copy invoicesè¡¨ï¼Œclient_idæ›¿æ¢ä¸ºåå­—ï¼Œpayment_dateä¸ä¸ºnull

```

### 3.3 update

```sql
-- æ›´æ–°ä¸€æ¡è®°å½•
update invoices 
	set payment_total=10,payment_date='2020-03-01' where invoice_id=1;

update invoices 
	set payment_total=invoice_total*0.5,payment_date=due_date where invoice_id=3;
	
-- æ›´æ–°å¤šæ¡è®°å½•è¯­æ³•ä¸ä¸Šä¸€è‡´ï¼Œåªæ˜¯æ¡ä»¶ä¸ä¸€æ ·ï¼Œåœ¨å¼€å‘ä¸­æ¯”è¾ƒå°‘è§ï¼Œè°¨æ…ä½¿ç”¨

-- ç»ƒä¹  æ›´æ–°customersè¡¨ï¼Œç»™1990å¹´ä¹‹å‰ç”Ÿçš„å®¢æˆ·+50åˆ†

-- ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡Œæ›´æ–°
update invoices 
	set payment_total=10,payment_date='2020-03-01' 
	where invoice_id=(select client_id from clients where name='Myworks');
	
update invoices 
	set payment_total=10,payment_date='2020-03-01' 
	where invoice_id in(select client_id from clients where state in('CA','NY'));
	
-- ç»ƒä¹  æ›´æ–°ordersè¡¨comentsä¸ºé‡‘ç‰Œå®¢æˆ·ï¼Œæ¡ä»¶ä¸ºå®¢æˆ·ç§¯åˆ†è¶…è¿‡3000åˆ†
```

### 3.4 delete

```sql
delete from invoices where invoice_id=1;

delete from invoices 
	where client_id=(select client_id from clients where name='Myworks');
```

## 4ã€ç»Ÿè®¡æŸ¥è¯¢

### 4.1 èšåˆå‡½æ•°

èšåˆå‡½æ•°å±äºå†…ç½®å‡½æ•°çš„ä¸€ç§ï¼Œå®ƒéœ€è¦æ¥æ”¶ä¸€äº›å‚æ•°ï¼Œç„¶åå†åˆå¹¶ä¸ºä¸€ä¸ªç»“æœã€‚

```sql
select
		max(invoice_total),min(invoice_total),avg(invoice_total),
		sum(invoice_total),count(invoice_total) 
		from invoices;
		
-- æ³¨æ„ï¼Œä»¥ä¸Šå‡½æ•°åªèƒ½ä½œç”¨äºéç©ºçš„åˆ—ï¼Œå¹¶ä¸”é‡å¤å€¼ä¹Ÿä¼šè®¡ç®—åœ¨å†…
select count(*) from invoices; 
select count(distinct client_id) from invoices;

-- ç»ƒä¹  æŸ¥è¯¢2019å¹´ä¸ŠåŠå¹´ã€ä¸‹åŠå¹´åŠæ•´å¹´çš„æ€»é”€å”®é¢invoice_totalã€æ€»æ”¶æ¬¾é¢payment_totalã€æ€»åº”æ”¶é¢
```

### 4.2 åˆ†ç»„æŸ¥è¯¢

```sql
-- æŒ‰ç…§å®¢æˆ·å¯¹é”€å”®æ€»é¢è¿›è¡Œåˆ†ç»„æŸ¥è¯¢
select client_id,sum(invoice_total) as total_sales from invoices
	where invoice_date>='2019-07-01'
	group by client_id
	order by total_sales desc;
	
-- æŒ‰ç…§å·å’ŒåŸå¸‚å¯¹é”€å”®æ€»é¢è¿›è¡Œåˆ†ç»„æŸ¥è¯¢
select state,c
ity,sum(invoice_total) as total_sales 
	from invoices i
	join clients using(client_id)
	group by state,city

-- ç»ƒä¹  æ ¹æ®æ—¥æœŸã€ä»˜æ¬¾æ–¹å¼å¯¹ä»˜æ¬¾æ€»é¢è¿›è¡Œåˆ†ç»„æŸ¥è¯¢

-- havingå­å¥
-- æ ¹æ®å®¢æˆ·idå¯¹é”€å”®æ€»é¢è¿›è¡Œåˆ†ç»„æŸ¥è¯¢ï¼Œç­›é€‰å‡ºä»˜æ¬¾æ€»é¢å¤§äº500çš„æ•°æ®
select client_id,sum(invoice_total) as total_sales
	from invoices
	group by client_id
	having total_sales>500;
	
-- æ ¹æ®å®¢æˆ·idå¯¹é”€å”®æ€»é¢è¿›è¡Œåˆ†ç»„æŸ¥è¯¢ï¼Œç­›é€‰å‡ºä»˜æ¬¾æ€»é¢å¤§äº500çš„æ•°æ®ï¼Œä¸”å‘ç¥¨æ€»æ•°å¤§äº5çš„æ•°æ®
select client_id,sum(invoice_total) as total_sales,count(*) as numbers
	from invoices
	group by client_id
	having total_sales>500 and numbers>5;
	
-- æŸ¥è¯¢å®¢æˆ·åœ¨VAï¼Œä¸”å¼€é”€å¤§äº100å…ƒçš„å®¢æˆ·ä¿¡æ¯

-- with rollup
select client_id,sum(invoice_total) as total_sales from invoices
	group by client_id
	with rollup;
-- rollup æ“ä½œç¬¦åªä½œç”¨äºèšåˆå‡½æ•°åˆ—

select state,city,sum(invoice_total) as total_sales 
	from invoices i
	join clients using(client_id)
	group by state,city with rollup;
	
-- æŸ¥è¯¢å„ç§æ”¯ä»˜æ–¹å¼çš„ç´¯è®¡å€¼ï¼ˆä½¿ç”¨rollupæ“ä½œç¬¦çš„æ—¶å€™ï¼Œgroup byä¸èƒ½ç”¨åˆ«åï¼‰
```



## 5ã€é«˜çº§æŸ¥è¯¢

### 5.1 å­æŸ¥è¯¢


å­æŸ¥è¯¢å°±æ˜¯åŒ…å«åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢è¯­å¥é‡Œé¢çš„æŸ¥è¯¢

```sql
-- æŸ¥è¯¢ä»·æ ¼æ¯”Lettuce(id=3)è´µçš„å•†å“
select * from products 
	where unit_price > (select unit_price from products where product_id=3);
	
-- ç»ƒä¹  æŸ¥è¯¢å·¥èµ„é«˜äºå¹³å‡æ°´å¹³çš„å‘˜å·¥ä¿¡æ¯
```

### 5.2 in

```sql
-- æŸ¥è¯¢ä»æ¥æ²¡æœ‰è®¢å•çš„å•†å“ä¿¡æ¯
select * from products
	where product_id not in (select distinct product_id from order_items);
	
-- ç»ƒä¹  æŸ¥è¯¢æ²¡æœ‰å‘ç¥¨è®°å½•çš„å®¢æˆ·
```

### 5.3 å­æŸ¥è¯¢ vs è¿æ¥æŸ¥è¯¢

```sql
-- æŸ¥è¯¢æ²¡æœ‰å‘ç¥¨è®°å½•çš„å®¢æˆ·
select * from clients left join invoices using(client_id) where invoice_id is null;
```

å‡ ä¹æ‰€æœ‰çš„å­æŸ¥è¯¢éƒ½å¯ä»¥ä½¿ç”¨è¿æ¥æŸ¥è¯¢æ¥å®ç°ï¼Œåœ¨å…·ä½“ä½¿ç”¨å“ªä¸€ç§æŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬ä¸»è¦ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢æ¥è€ƒè™‘ï¼š

- æŸ¥è¯¢æ€§èƒ½
- æŸ¥è¯¢è¯­å¥çš„å¯è¯»æ€§

```sql
-- ç»ƒä¹  æ‰¾å‡ºè®¢è´­äº†ç”Ÿèœçš„å®¢æˆ·ä¿¡æ¯ï¼ˆä½¿ç”¨ä¸¤ç§æŸ¥è¯¢æ–¹å¼æ¥å®ç°ï¼‰
```

### 5.4 all & any(some)

```sql
-- æŸ¥è¯¢æ‰€æœ‰å¤§äºid=3çš„å®¢æˆ·å‘ç¥¨é‡‘é¢ï¼ˆå–æœ€å¤§ï¼‰çš„å‘ç¥¨è®°å½•
select * from invoices where invoice_total >
	(select max(invocie_total) from invoices where client_id=3);

select * from invoices where invoice_total >
	all (select invocie_total from invoices where client_id=3);
	
-- æŸ¥è¯¢æ‰€æœ‰å¤§äºid=3çš„å®¢æˆ·å‘ç¥¨é‡‘é¢ï¼ˆåªè¦å¤§äºå…¶ä¸­æŸä¸€æ¡ï¼‰çš„å‘ç¥¨è®°å½•
select * from invoices where invoice_total >
	any (select invoice_total from invoices where client_id=3);

-- æŸ¥è¯¢è‡³å°‘æœ‰2æ¡å‘ç¥¨è®°å½•çš„å®¢æˆ·
select * from clients where client_id in
	(select client_id from invocies group by client_id having count(*)>=2);
	
select * from clients where client_id = any
	(select client_id from invocies group by client_id having count(*)>=2);
```

### 5.5 å…³è”å­æŸ¥è¯¢

å­æŸ¥è¯¢çš„æ¡ä»¶å…³è”åˆ°ä¸»æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢ä¸èƒ½ç‹¬ç«‹æ‰§è¡Œã€‚

```sql
-- æŸ¥è¯¢è–ªèµ„æ°´å¹³é«˜äºéƒ¨é—¨å¹³å‡æ°´å¹³çš„å‘˜å·¥ä¿¡æ¯
select * from employees e where salary > 
	(select avg(salary) from employees where office_id = e.office_id);
```

- éå…³è”å­æŸ¥è¯¢ï¼šå­æŸ¥è¯¢æ¡ä»¶ç‹¬ç«‹ï¼Œå…ˆè¿›è¡Œå­æŸ¥è¯¢ï¼Œç„¶åè¿›è¡Œä¸»æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢åªè¿›è¡Œä¸€æ¬¡ã€‚
- å…³è”å­æŸ¥è¯¢ï¼šå­æŸ¥è¯¢æ¡ä»¶å…³è”å¤–éƒ¨è®°å½•ï¼Œå› æ­¤å…ˆè¿›è¡Œä¸»æŸ¥è¯¢ï¼Œç„¶åè¿›è¡Œå­æŸ¥è¯¢ã€‚ç”±äºå­æŸ¥è¯¢ä¼šæ‰§è¡Œå¤šæ¬¡ï¼Œå¦‚æœæ•°æ®é‡å¤§çš„è¯ï¼ŒæŸ¥è¯¢æ€§èƒ½ä¼šè¾ƒæ…¢ã€‚

```sql
-- ç»ƒä¹  æŸ¥è¯¢å®¢æˆ·å‘ç¥¨è®°å½•ä¸­é«˜äºè¿™ä¸ªå½“å‰å®¢æˆ·å¹³å‡å‘ç¥¨é‡‘é¢æ°´å¹³çš„æ‰€æœ‰å‘ç¥¨è®°å½•
```

### 5.6 exists

```sql
-- æ‰¾å‡ºæœ‰å‘ç¥¨è®°å½•çš„å®¢æˆ·ä¿¡æ¯
select * from clients where client_id in (select distinct client_id from invoices);

select * from clients c where
	exists (select client_id from invoices where client_id = c.client_id);
```

å¦‚æœåœ¨`in`åé¢çš„å­æŸ¥è¯¢è¿”å›çš„æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„ç»“æœé›†ï¼Œé‚£ä¹ˆä½¿ç”¨`exists`ä¼šç›¸å¯¹æ€§èƒ½è¾ƒå¥½ã€‚å› ä¸ºé’ˆå¯¹åè€…ï¼Œå­æŸ¥è¯¢æ˜¯ä¸ä¼šå°†ç»“æœé›†è¿”å›ç»™å¤–éƒ¨æŸ¥è¯¢ï¼Œè€Œåªæ˜¯æ£€æµ‹ç»“æœçš„çœŸå‡ã€‚

```sql
-- ç»ƒä¹  æŸ¥è¯¢ä»æœªè¢«è®¢è´­è¿‡çš„å•†å“ä¿¡æ¯
```

### 5.7 selectä»å¥ä¸­çš„å­æŸ¥è¯¢

```sql
-- æŸ¥è¯¢æ¯æ¡å‘ç¥¨è®°å½•çš„é‡‘é¢ã€å¹³å‡å‘ç¥¨é‡‘é¢ä»¥åŠä¸¤è€…çš„å·®é¢
select invoice_id,invoice_total,
	(select avg(invoice_total) from invoices) as invoice_avg,
	invoice_total - (select invoice_avg) as diff
	from invoices
	
-- ç»ƒä¹  æŸ¥è¯¢å®¢æˆ·çš„idã€åç§°ã€æ€»é”€å”®é¢ã€å¹³å‡é”€å”®é¢åŠä¸¤è€…å·®é¢
```

### 5.8 fromä»å¥ä¸­çš„å­æŸ¥è¯¢

```sql
-- ä»ä¸Šè¿°ç»ƒä¹ æ‰€è¿°çš„æŸ¥è¯¢ä¸­ï¼Œæç‚¼å‡ºæœ‰å‘ç¥¨è®°å½•çš„æ•°æ®
select * from (
	select client_id,name,
		(select sum(invoice_total) from invoices where client_id = c.client_id) total,
    (select avg(invoice_total) from invoices) avg,
    (select total-avg) diff
    from clients c
) summary where total is not null;
```

> æˆ‘ä»¬å¯ä»¥æŠŠå­æŸ¥è¯¢æ‰€æŸ¥åˆ°çš„è®°å½•å½“ä½œä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼ŒåŸºäºå®ƒï¼Œå¯ä»¥ç»§ç»­æŸ¥è¯¢ã€è¿æ¥æŸ¥è¯¢ç­‰ã€‚





## 6ã€äº‹åŠ¡ä¸å¹¶å‘

### 6.1 ç®€ä»‹

äº‹åŠ¡å°±æ˜¯ä¸€ç»„è´Ÿè´£æŸä¸€éƒ¨åˆ†å·¥ä½œçš„SQLä»£ç ï¼Œæ‰€æœ‰çš„è¯­å¥å¿…é¡»æˆåŠŸæ‰§è¡Œï¼Œå¦åˆ™äº‹åŠ¡å°±ä¼šå¤±è´¥ã€‚

ä¾‹å¦‚ï¼šé“¶è¡Œè½¬å¸ï¼ŒåŒ…å«ä»ä¸€ä¸ªè´¦æˆ·è½¬å‡ºé‡‘é¢ï¼Œä»ä¸€ä¸ªè´¦æˆ·è½¬å…¥é‡‘é¢ï¼Œè¿™ä¸¤ä¸ªæ§½èµ°éƒ½å¿…é¡»æˆåŠŸæ‰§è¡Œï¼Œå¦åˆ™å°±ä¼šå‡ºç°è´¦æˆ·ä¸å¹³è¡¡ï¼Œå¦‚æœåªæœ‰æŸä¸€ä¸ªæ“ä½œæˆåŠŸï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œå›æ»šæˆ–è€…æ’¤é”€æ‰€æœ‰æ“ä½œã€‚

äº‹åŠ¡ä½¿ç”¨çš„åœºæ™¯ï¼šæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„ä¿®æ”¹éƒ½è¦å®Œæˆï¼Œå¹¶å°†å®ƒä»¬è§†ä¸ºä¸€ä¸ªæ•´ä½“æ“ä½œã€‚

ä¾‹å¦‚ï¼šæˆ‘ä»¬éœ€è¦åœ¨è®¢å•å‘ç”Ÿçš„æ—¶å€™ï¼Œæ—¢è¦å‘è®¢å•è¡¨ä¸­æ–°å¢ä¸€æ¡è®°å½•ï¼Œè¿˜éœ€è¦å‘è®¢å•æ˜ç»†è¡¨ä¸­æ·»åŠ è®°å½•ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªæ“ä½œæˆåŠŸï¼Œè€Œå¦ä¸€ä¸ªæ“ä½œå¤±è´¥ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°ä¸€ä¸ªä¸å®Œæ•´çš„è®¢å•ä¿¡æ¯ã€‚

äº‹åŠ¡çš„ç‰¹æ€§`ACID`ï¼š

- `Atomicity`åŸå­æ€§ï¼Œäº‹åŠ¡å°±åƒåŸå­ä¸€æ ·ï¼Œå„ä¸ªæ“ä½œåˆä¸ºä¸€ä½“ï¼Œä¸å¯æ‹†åˆ†
- `Consistency`ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬çš„æ•°æ®æ°¸è¿œä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¸ä¼šä¿å­˜æ²¡æœ‰å•†å“çš„è®¢å•ä¿¡æ¯ã€‚
- `Isolation`éš”ç¦»æ€§ï¼Œäº‹åŠ¡ä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œç‰¹åˆ«æ˜¯å®ƒä»¬è¦ä¿®æ”¹åŒä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œå®ƒä»¬ä¹‹é—´äº’ç›¸ä¸å—å½±å“ã€‚å¦‚æœå¤šä¸ªäº‹åŠ¡è¦ä¿®æ”¹åŒä¸€ä»½æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«é”å®šï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªäº‹åŠ¡æœ‰æƒä¿®æ”¹ã€‚
- `Durability`æŒä¹…æ€§ï¼Œä¸€æ—¦ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ï¼Œå®ƒçš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œä»»ä½•ç‰¹æ®Šæƒ…å†µæ¯”å¦‚åœç”µï¼Œéƒ½ä¸ä¼šå½±å“è¿™ç§æ•°æ®ä¿®æ”¹ã€‚

### 6.2 åˆ›å»º

```sql
-- åˆ›å»ºè®¢å•ä¿¡æ¯
start transaction;

insert into orders(customer_id,order_date,status)
	values(1,'2019-01-01',1);
	
insert into order_items values(last_insert_id(),1,1,1);

commit;

-- å¦‚æœåœ¨å‘order_itemsè¡¨æ’å…¥æ•°æ®çš„æ—¶å€™æ–­å¼€æ•°æ®åº“è¿æ¥ï¼Œé‚£ä¹ˆå‰é¢çš„æ“ä½œéƒ½å°†å›æ»š

-- MySQLé»˜è®¤å°†æ‰€æœ‰å•ç‹¬çš„CRUDè¯­å¥åŒ…è£…æˆä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶ä¸”æ‰§è¡Œè‡ªåŠ¨æäº¤
show variables like 'autocommit%';
```

### 6.3 å¹¶å‘ä¸é”å®š

åœ¨ç°å®ä¸­ï¼Œä¸€ä¸ªæ•°æ®æœ‰å¯èƒ½è¢«å¤šä¸ªç”¨æˆ·åŒæ—¶è¿›è¡Œè®¿é—®æˆ–è€…ä¿®æ”¹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å¹¶å‘ã€‚

```sql
-- çª—å£1
start transaction;
update customers set points = points + 10 where customer_id = 1;
commit;

-- çª—å£2
start transaction;
update customers set points = points + 10 where customer_id = 1;
commit;

-- å½“çª—å£1æ‰§è¡Œå®Œupdateä½†æ˜¯å¹¶æœªæäº¤æ—¶ï¼Œæ‰§è¡Œçª—å£2çš„ä»£ç è‡³updateï¼Œä¼šå‘ç°ä¸€åªå¤„äºç­‰å¾…çŠ¶æ€
-- å½“æˆ‘ä»¬æ‰§è¡Œç¬¬ä¸€æ¬¡æ›´æ–°çš„æ—¶å€™ï¼ŒMySQLå°†æ•°æ®é”å®šäº†ï¼Œå¦‚æœå…¶å®ƒçš„äº‹åŠ¡æƒ³è¦æ›´æ–°åŒä¸€æ¡æ•°æ®ï¼Œå®ƒå°±éœ€è¦ç­‰å¾…ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªäº‹åŠ¡æäº¤æˆ–è€…å›æ»šæ¥é‡Šæ”¾é”ã€‚
```

å¹¶å‘å¸¦æ¥çš„é—®é¢˜ï¼š

- `Lost Updates`ä¸¢å¤±ä¿®æ”¹ï¼šå½“2ä¸ªäº‹åŠ¡ä¿®æ”¹åŒä¸€ä»½æ•°æ®è€Œä¸ä½¿ç”¨é”æ—¶ï¼Œä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œåä¸€ä¸ªäº‹åŠ¡çš„ä¿®æ”¹ä¼šæŠŠå‰ä¸€æ¬¡äº‹åŠ¡çš„ä¿®æ”¹è¦†ç›–æ‰ã€‚
- `Dirty Reads`è„è¯»ï¼šäº‹åŠ¡è¯»å–è¿˜æ²¡æœ‰æäº¤çš„æ•°æ®æ—¶ï¼Œäº‹åŠ¡Aå¯¹æ•°æ®å‘ç”Ÿäº†ä¿®æ”¹ï¼Œè€Œäº‹åŠ¡Båœ¨Aæäº¤ä¹‹å‰è¯»å–äº†Aä¿®æ”¹çš„æ•°æ®ï¼Œä½†æ˜¯æœ€åAå›æ»šäº†ï¼Œé‚£ä¹ˆBè¯»å–çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„ã€‚
- `Non-repeating Reads`ä¸å¯é‡å¤è¯»ï¼šåœ¨ä¸€æ¬¡äº‹åŠ¡Aä¸­2æ¬¡è¯»å–åŒä¸€ä»½æ•°æ®ï¼Œä½†æ˜¯äº‹åŠ¡Båœ¨Açš„2æ¬¡è¯»å–ä¹‹é—´å¯¹è¿™ä»½æ•°æ®è¿›è¡Œäº†ä¿®æ”¹å’Œæäº¤ï¼Œé‚£ä¹ˆäº‹åŠ¡Açš„2æ¬¡è¯»å–ç»“æœå°†ä¼šä¸ä¸€æ ·ã€‚ç®€è¨€ä¹‹ï¼Œä¸€ä¸ªäº‹åŠ¡è¯»å–åŒä¸€æ¡è®°å½•ï¼Œä¼šå‡ºç°ä¸¤ä¸ªä¸åŒçš„çŠ¶æ€å€¼ï¼Œåˆç§°ä¸ºABAäº‹ä»¶ã€‚
- `Phanton Reads`å¹»è¯»ï¼šäº‹åŠ¡Bå¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œåœ¨Bæäº¤ä¹‹å‰ï¼Œäº‹åŠ¡Aæ ¹æ®æ¡ä»¶æŸ¥è¯¢å‡ºè‹¥å¹²æ¡è®°å½•ï¼Œä½†æ˜¯åœ¨Bæäº¤ä¹‹åï¼Œä½¿å¾—æŸäº›æ•°æ®ä¹‹å‰ä¸ç¬¦åˆAçš„è¦æ±‚ï¼Œä½†æ˜¯Bä¿®æ”¹æäº¤åç¬¦åˆè¦æ±‚äº†ã€‚



### 6.4 äº‹åŠ¡éš”ç¦»çº§åˆ«

|                  | Lost Updates | Dirty Reads | Non-repeating Reads | Phanton Reads |
| :--------------: | :----------: | :---------: | :-----------------: | :-----------: |
| Read Uncommitted |              |             |                     |               |
|  Read Committed  |              |      Y      |                     |               |
| Repeatable Read* |      Y       |      Y      |          Y          |               |
|   Serializable   |      Y       |      Y      |          Y          |       Y       |

äº‹åŠ¡éš”ç¦»çº§åˆ«è¶Šé«˜ï¼Œä½¿ç”¨çš„é”ä¹Ÿä¼šè¶Šå¤šï¼Œè¶Šéœ€è¦ç‰ºç‰²æ€§èƒ½å’Œä½“éªŒ

```sql
-- æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«
show variables like 'transaction_isolation';

-- ä¿®æ”¹
-- ä¸‹ä¸€æ¬¡ï¼ˆä¸”åªæœ‰ä¸‹ä¸€æ¬¡ï¼‰äº‹åŠ¡ç”Ÿæ•ˆï¼Œç›´åˆ°å½“å‰äº‹åŠ¡å®Œæ¯•
set transaction isolation level serializable; 
set session transaction isolation level serializable; -- åªåœ¨å½“å‰ä¼šè¯ç”Ÿæ•ˆ
set global transaction isolation level serializable; -- å…¨å±€ç”Ÿæ•ˆ
```

#### 6.4.1 Read uncommitted

è„è¯»æ¼”ç¤º

```sql
-- session 1
set transaction isolation level read uncommitted;
select points from customers where customer_id = 1;

-- session 2
start transaction;
update customers set points = points + 10 where customer_id = 1;
commit;
```

#### 6.4.2 Read Committed

ä¸å¯é‡å¤è¯»æ¼”ç¤ºï¼š

```sql
-- session 1
set transaction isolation level read committed;
start transaction;
select points from customers where customer_id = 1;
select points from customers where customer_id = 1;
commit;

-- session 2
start transaction;
update customers set points = points + 10 where customer_id = 1;
commit;
```

#### 6.4.3  Repeatable Reads

å¹»è¯»æ¼”ç¤ºï¼ˆMySQL 8.0çš„RRè§£å†³äº†å¹»è¯»ï¼‰ï¼š

```sql
-- session 1
set transaction isolation level repeatable read;
start transaction;
select * from customers where state = 'VA';
commit;

-- session 2
start transaction;
update customers set state = 'VA' where customer_id = 1;
commit;
```

#### 6.4.4 Serializable

```sql
-- session 1
set transaction isolation level serializable;
start transaction;
select * from customers where state = 'VA';
commit;

-- session 2
start transaction;
update customers set state = 'VA' where customer_id = 1;
commit;
```

### 6.5 æ­»é”

`Dead Lock`ï¼Œæ­»é”å‘ç”Ÿåœ¨æ‰€æœ‰äº‹åŠ¡éƒ½æ— æ³•å®Œæˆçš„æƒ…å†µä¸‹ï¼Œå› ä¸ºæ¯ä¸€ä¸ªäº‹åŠ¡éƒ½æŒæœ‰å¦ä¸€ä¸ªäº‹åŠ¡æ‰€éœ€è¦çš„é”ã€‚æ‰€æœ‰äº‹åŠ¡éƒ½è®©å¯¹æ–¹ç­‰å¾…ï¼Œä¸ä¼šé‡Šæ”¾è‡ªå·±çš„é”ã€‚

```sql
-- session 1
start transaction;
update customers set state = 'VA' where customer_id = 1;
update orders set status = 1 where order_id = 1;
commit;

-- session 2
start transaction;
update orders set status = 1 where order_id = 1;
update customers set state = 'VA' where customer_id = 1;
commit;

-- MySQLåœ¨é‡åˆ°deadlockçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å›æ»š2ä¸ªäº‹åŠ¡
```



## 7ã€æ•°æ®åº“è®¾è®¡

### 71 æ•°æ®å»ºæ¨¡

è®¾è®¡ä¸€ä¸ªæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“çš„è¿‡ç¨‹ï¼ŒåŒ…å«ä»¥ä¸‹4ä¸ªæ­¥éª¤ï¼š

1. ç†è§£å¹¶åˆ†æéœ€æ±‚ï¼ˆå……åˆ†ä¸äº§å“ç»ç†ã€è¡Œä¸šä¸“å®¶ã€ç»ˆç«¯å®¢æˆ·è¿›è¡Œäº¤æµï¼‰
2. æ¦‚å¿µæ€§å»ºæ¨¡ï¼šå°†ä¸šåŠ¡ä¸­çš„äº‹ç‰©å’Œäº‹æƒ…å…·ä½“åŒ–ï¼Œå¹¶å°†å®ƒä»¬çš„å…³ç³»ç¡®å®šä¸‹æ¥ã€‚æ¦‚å¿µæ€§å»ºæ¨¡æ˜¯ä¸šåŠ¡çš„ä¸€ä¸ªå¯è§†åŒ–è¡¨ç°ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä½ å’Œå„ç§ä¸šåŠ¡éœ€æ±‚ä¿æŒä¸€è‡´ã€‚
3. é€»è¾‘åŒ–å»ºæ¨¡ï¼šä¸å—æ•°æ®åº“è¯­è¨€çº¦æŸçš„æŠ½è±¡æ¨¡å‹ï¼Œå®ƒåªå±•ç¤ºè¡¨å’Œåˆ—
4. å®ä½“å»ºæ¨¡ï¼šæŸä¸ªç‰¹å®šæ•°æ®åº“ç³»ç»Ÿä¸­ç”¨æ¥å®ç°é€»è¾‘å»ºæ¨¡çš„å®è·µï¼Œå®ƒéœ€è¦ç”¨åˆ°å…·ä½“çš„æ•°æ®ç±»å‹

### 7.2 æ¦‚å¿µæ€§å»ºæ¨¡

åˆ›å»ºä¸€ä¸ªç½‘ç«™ç”¨æ¥é”€å”®åœ¨çº¿è¯¾ç¨‹ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥åˆ›å»ºè´¦æˆ·ï¼Œå¹¶ä¸”è®¢è´­è‹¥å¹²è¯¾ç¨‹ï¼›æ¯é—¨è¯¾æœ‰å„ç§æ ‡ç­¾ï¼Œæ¯”å¦‚å‰æ®µæˆ–è€…åç«¯ã€‚

é¦–å…ˆç”¨æ¦‚å¿µæ€§æ¨¡å‹æ¥è¡¨ç¤ºå®ä½“ã€æˆ–è€…äº‹ç‰©ã€éœ€æ±‚ä¸­çš„æ¦‚å¿µä»¥åŠä»–ä»¬å½¼æ­¤çš„å…³ç³»ã€‚

è¿™æ ·çš„æ¦‚å¿µï¼Œæ¯”å¦‚æœ‰ï¼šå­¦ç”Ÿ / è¯¾ç¨‹ç­‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹å¼æ¥å°†è¿™äº›å®ä½“å¯è§†åŒ–ï¼Œå¯ä»¥ä½¿ç”¨`ERå›¾`æˆ–è€…`UML`

Entityï¼šå®ä½“

Relationï¼šå…³ç³»

![image-20210725210958278](images/image-20210725210958278.png)

æˆ‘ä»¬ç”¨å®ƒæ¥ç†è§£éœ€æ±‚ï¼Œå¹¶å’Œäº§å“ç»ç†æ²Ÿé€š

> å»ºæ¨¡æ˜¯ä¸€ä¸ªè¿­ä»£çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ç¬¬ä¸€æ¬¡å°±è®¾è®¡å‡ºå®Œç¾çš„ç»“æ„ï¼Œéœ€è¦åœ¨éœ€æ±‚å’Œè®¾è®¡ä¹‹é—´å¾€å¤å¹¶ä¸æ–­è°ƒæ•´

### 7.3 é€»è¾‘åŒ–å»ºæ¨¡

é€»è¾‘åŒ–å»ºæ¨¡ï¼Œæ˜¯ç‹¬ç«‹äºç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿçš„ï¼Œå®ƒæ˜¯ä¸€ç§æŠ½è±¡çš„æè¿°ï¼Œæ¥è¡¨ç¤ºå®ä½“å’Œæ•°æ®ç»“æ„çš„å…³ç³»ï¼Œå› æ­¤æ¯”æ¦‚å¿µæ€§å»ºæ¨¡ç»†èŠ‚æ›´å¤š

![image-20210725212826186](images/image-20210725212826186.png)

### 7.5 å®ä½“å»ºæ¨¡

å®ä½“å»ºæ¨¡ï¼Œå°±æ˜¯æŸä¸ªç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿå¯¹é€»è¾‘å»ºæ¨¡çš„å®ç°

![image-20210725221248319](images/image-20210725221248319.png)

`Primary Key`ä¸»é”®ï¼Œå°±æ˜¯ä¸€ä¸ªå­—æ®µï¼Œå”¯ä¸€æ ‡è¯†äº†è¡¨ä¸­çš„æ¯ä¸€æ¡è®°å½•

`Foreign Key`å¤–é”®ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªè¡¨ä¸­ï¼Œå¼•ç”¨äº†çˆ¶è¡¨çš„æŸä¸€åˆ—ï¼ˆä¸€èˆ¬æ˜¯ä¸»é”®ï¼‰æ•°æ®

`Foreign Key Constraints`å¤–é”®çº¦æŸ

![image-20210725220358813](images/image-20210725220358813.png)

![image-20210725220602390](images/image-20210725220602390.png)

- cascadeï¼šçº§è”ï¼Œè¡¨ç¤ºå½“çˆ¶è¡¨è¢«å¼•ç”¨çš„åˆ—å‘ç”Ÿäº†æ›´æ–°ï¼Œå­è¡¨æ˜¯å¦è·Ÿç€ä¸€èµ·è¿›è¡Œç›¸åº”çš„æ›´æ–°
- no actionï¼šçˆ¶è¡¨å˜åŒ–ï¼Œå­è¡¨ä¸åšä»»ä½•ååº”
- set nullï¼šçˆ¶è¡¨å˜åŒ–ï¼Œå­è¡¨å¯¹åº”çš„å­—æ®µå€¼è®¾ç½®ä¸ºnull



### 7.6 æ•°æ®åº“è§„èŒƒåŒ–

æ•°æ®åº“è§„èŒƒåŒ–/å½’ä¸€åŒ–ï¼Œæ˜¯æ£€æŸ¥æˆ‘ä»¬è®¾è®¡æ•°æ®åº“è®¾è®¡çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œèƒ½ç¡®ä¿æˆ‘ä»¬éµå®ˆäº†æœç»é‡å¤æ•°æ®æ‰€éœ€çš„æŸäº›åŸåˆ™ã€‚é€šå¸¸æœ‰7æ¡è§„åˆ™ï¼Œæˆ–è€…è¯´7ä¸ªèŒƒå¼ï¼Œæ¯ä¸ªè§„åˆ™éƒ½å‡è®¾å·²ç»å®ç°äº†å‰ä¸€è§„åˆ™ï¼Œæˆ‘ä»¬åªéœ€è¦åšåˆ°å‰3ä¸ªèŒƒå¼å°±è¡Œäº†ã€‚

1. ç¬¬ä¸€èŒƒå¼ï¼šæ¯ä¸ªå•å…ƒæ ¼éƒ½åº”è¯¥æ˜¯å•ä¸€å€¼ï¼ˆæ ‡é‡ï¼‰ï¼Œå¹¶ä¸”åˆ—çš„å€¼å°½é‡ä¸é‡å¤

   `courses`çš„tagsåˆ—ä¸å¤ªç¬¦åˆè¿™ä¸ªèŒƒå¼

   ![image-20210727203849407](images/image-20210727203849407.png)

   > æŸ¥è¯¢è¯¾ç¨‹ç¼–å·ä¸º1çš„è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ä»¥åŠå®ƒå¯¹åº”çš„tags

   ```sql
   select * from courses
   	join course_tags using(course_id)
   	join tags using(tag_id)
   	where course_id = 1;
   ```

   

2. ç¬¬äºŒèŒƒå¼ï¼šæ²¡æœ‰ä¾èµ–ä»»ä½•å…³ç³»çš„å…¶å®ƒå­é›†çš„éä¸»é”®å­—æ®µã€‚é€šä¿—æ¥è¯´ï¼Œå³æ˜¯ï¼Œæ¯ä¸ªè¡¨éƒ½åº”è¯¥æ˜¯å•ä¸€åŠŸèƒ½çš„ï¼Œå®ƒèƒ½ä¸”ä»…èƒ½è¡¨ç¤ºä¸€ä¸ªå®ä½“ï¼Œè¿™ä¸ªè¡¨çš„æ‰€æœ‰å­—æ®µéƒ½æ˜¯ç”¨æ¥æè¿°è¿™ä¸ªç‰¹å®šå®ä½“çš„ã€‚

   ![image-20210727205420318](images/image-20210727205420318.png)

3. ç¬¬ä¸‰èŒƒå¼ï¼šæ‰€æœ‰è¡¨ä¸­çš„å­—æ®µéƒ½åªä¾èµ–ä¸»é”®ï¼Œä¸ä»»ä½•å…¶å®ƒçš„å­—æ®µå€¼æ— å…³ã€‚å³ï¼Œä¸€ä¸ªè¡¨ä¸­çš„å­—æ®µä¸åº”è¯¥ç”±è¡¨ä¸­çš„å…¶å®ƒå­—æ®µæ¨å¯¼è€Œæ¥ã€‚

### 7.7 åˆ›å»ºæ•°æ®åº“ç›¸å…³å·¥å…·é›†

åˆ›å»ºæ•°æ®åº“ï¼šDatabase -> Forward Engineer

åŒæ­¥æ¨¡å‹ï¼šDatabase -> Synchronize Model

åè½¬å¼•æ“ï¼šDatabase -> Reverse Engineer

### 7.8 Project

![image-20210727213649998](images/image-20210727213649998.png)

èˆªç­Flight / ä¹˜å®¢Passenger / èˆªç©ºå…¬å¸Airline / æœºåœºAirport / æœºç¥¨Ticket

### 7.9 DDL

#### 7.9.1 åˆ›å»ºæ•°æ®åº“

```sql
create database if not exists sql_store2;

drop database if exists sql_test1;
```

#### 7.9.2 åˆ›å»ºä¸ä¿®æ”¹è¡¨

```sql
drop table if exists customers;
create table if not exists customers
(
  customer_id int primary key auto_increment,
  first_name varchar(50) not null,
  points int not null default 0,
  email varchar(255) not null unique
);

-- ä¿®æ”¹è¡¨
alter table customers
	add last_name varchar(50) not null after first_name,
	add city varchar(50) not null,
	modify column first_name varchar(50) default 'xxx',
	drop points;
	
-- åˆ›å»ºå…³ç³»
create table orders
(
	order_id int primary key,
  customer_id int not null,
  foreign key fk_orders_customers (customer_id) 
  	references customers (customer_id)
  	on update cascade
  	on delete no action
)
```



#### 7.9.3 ä¸»å¤–é”®çº¦æŸ

```sql
alter table orders
	add primary key (order_id),
	drop primary key,
	drop foreign key fk_orders_customers,
	add foreign key fk_orders_customers (customer_id)
		references customers (customer_id)
		on update cascade
		on delete no action;
```

#### 7.9.4 å­—ç¬¦é›†

```sql
show charset;
-- utf8æ”¯æŒç»å¤§å¤šæ•°è¯­è¨€
-- collationçº¦å®šå­—ç¬¦é›†ä¸­çš„å­—ç¬¦æ˜¯å¦‚ä½•æ’åºçš„

create database db_name character set utf8mb4;
alter database db_name character set utf8;

create table tb_name() character set utf8;
alter table tb_name character set utf8;

create table tb_name
(
  name varchar(50) character set utf8 not null
)
```

### 7.10 å­˜å‚¨å¼•æ“

ä¸åŒçš„å¼•æ“å–å†³äºæˆ‘ä»¬è¦ä¿å­˜ä»€ä¹ˆæ•°æ®ï¼Œæˆ–è€…æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä»€ä¹ˆåŠŸèƒ½

```sql
show engines;
```

å¸¸è§çš„2ä¸ªå­˜å‚¨å¼•æ“

- MyISAMï¼šè¾ƒè€ï¼Œ5.5ä»¥å‰ç”¨çš„æ¯”è¾ƒä¸»æµ

- InnoDBï¼šç°ä»Šä¸»æµï¼Œæ”¯æŒäº‹åŠ¡

```sql
alter table customers engine = innodb;
```



### 7.11 DMLã€DDLä»¥åŠDCL

- DMLï¼ˆdata manipulation languageï¼‰æ˜¯æ•°æ®æ“çºµè¯­è¨€ï¼šå®ƒä»¬æ˜¯SELECTã€UPDATEã€INSERTã€DELETEï¼Œå°±è±¡å®ƒçš„åå­—ä¸€æ ·ï¼Œè¿™4æ¡å‘½ä»¤æ˜¯ç”¨æ¥å¯¹æ•°æ®åº“é‡Œçš„æ•°æ®è¿›è¡Œæ“ä½œçš„è¯­è¨€ã€‚

- DDLï¼ˆdata definition languageï¼‰æ˜¯æ•°æ®å®šä¹‰è¯­è¨€ï¼šDDLæ¯”DMLè¦å¤šï¼Œä¸»è¦çš„å‘½ä»¤æœ‰CREATEã€ALTERã€DROPç­‰ï¼ŒDDLä¸»è¦æ˜¯ç”¨åœ¨å®šä¹‰æˆ–æ”¹å˜è¡¨ï¼ˆTABLEï¼‰çš„ç»“æ„ï¼Œæ•°æ®ç±»å‹ï¼Œè¡¨ä¹‹é—´çš„é“¾æ¥å’Œçº¦æŸç­‰åˆå§‹åŒ–å·¥ä½œä¸Šï¼Œä»–ä»¬å¤§å¤šåœ¨å»ºç«‹è¡¨æ—¶ä½¿ç”¨ã€‚

- DCLï¼ˆDataControlLanguageï¼‰æ˜¯æ•°æ®åº“æ§åˆ¶è¯­è¨€ï¼šæ˜¯ç”¨æ¥è®¾ç½®æˆ–æ›´æ”¹æ•°æ®åº“ç”¨æˆ·æˆ–è§’è‰²æƒé™çš„è¯­å¥ï¼ŒåŒ…æ‹¬ï¼ˆgrant,deny,revokeç­‰ï¼‰è¯­å¥ã€‚

















# ğŸ§¨ğŸ§¨ğŸ§¨ğŸ§¨

# ğŸˆğŸˆé—®é¢˜æ”¶çº³

## 1ã€å¦‚ä½•ç†è§£ç±»å’Œå¯¹è±¡

- å®šä¹‰ï¼šç±»æ˜¯å…³äºä¸€ç³»åˆ—ç›¸ä¼¼å¯¹è±¡çš„æ¦‚æ‹¬æè¿°ï¼Œæè¿°å®ƒä»¬å…±æœ‰çš„çŠ¶æ€ã€è¡Œä¸ºï¼Œé€šè¿‡è¿™ç§å…±æ€§çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ„å‡ºè®¸è®¸å¤šå¤šç±»ä¼¼çš„å¯¹è±¡ã€‚

			è€Œå¯¹è±¡ï¼Œå³æ˜¯æ ¹æ®ä¸Šè¿°ç±»çš„å®šä¹‰ï¼Œâ€œå…‹éš†â€äº§ç”Ÿçš„ç›¸å…³å®ä¾‹ï¼Œè¿™äº›å®ä¾‹å¾€å¾€åœ¨æŸäº›å±æ€§æˆ–è¡Œä¸ºä¸Šæ˜¯ç±»ä¼¼ä½†æœ‰ç»†èŠ‚ä¸åŒçš„ï¼Œæ¯”å¦‚éƒ½æœ‰å§“åï¼Œä½†å…·ä½“çš„åå­—ä¸åŒã€‚

- ç»„æˆç±»å¤§ä½“åŒ…å«ä¸¤ç§è¦ç´ ï¼Œæˆ‘ä»¬ç»Ÿç§°ä¸ºæˆå‘˜ï¼š
  - æˆå‘˜å˜é‡ï¼šä½“ç°ä¸ºå±æ€§ã€çŠ¶æ€ã€æ•°æ®
  - æˆå‘˜æ–¹æ³•ï¼šä½“ç°ä¸ºå‡½æ•°æˆ–æ–¹æ³•ï¼Œæˆ–è€…åšæŸä»¶äº‹æƒ…çš„èƒ½åŠ›

- å…³ç³»ï¼šç±»ä¸å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼šå½“æˆ‘ä»¬ä¾ç…§ç±»Aåˆ›å»ºäº†a1å®ä¾‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ a1 is a member of A



## 2ã€å¦‚ä½•ç†è§£å°è£…å’ŒæŠ½è±¡

- å°è£…ï¼ˆåŠ¨è¯ï¼‰ï¼Œæ—¢å¯ä»¥ç”¨äºå°è£…ç±»å‹ï¼Œä¹Ÿå¯ä»¥ç”¨äºå°è£…æ–¹æ³•ã€‚

- åœ¨å°è£…ç±»å‹çš„æ—¶å€™ï¼Œå³æ˜¯æŠŠè¿™ä¸ªç±»å‹çš„2è¦ç´ ï¼ˆæˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼‰åŒ…è£…åˆ°ä¸€ä¸ªå•å…ƒï¼ˆclass æ–‡ä»¶ï¼‰é‡Œé¢

- åœ¨å°è£…æ–¹æ³•çš„æ—¶å€™ï¼Œå³æ˜¯æŠŠä¸“æ³¨åšâ€œæŸä»¶äº‹æƒ…â€ï¼ˆæ‰§è¡ŒæŸä¸€ä¸ªç‰¹å®šç®—æ³•ï¼‰çš„ä»£ç æ®µç”¨æ–¹æ³•ä½“åŒ…å«èµ·æ¥

- åœ¨å°è£…çš„æ—¶å€™ï¼Œè¦ç”¨â€œæŠ½è±¡â€è¿™ç§æ€ç»´èƒ½åŠ›ï¼Œåšåˆ°å…³æ³¨ä¸»è¦çš„ï¼ˆæ‰€æœ‰å®ä¾‹å…±æœ‰çš„ï¼‰ï¼Œå¿½ç•¥æ¬¡è¦çš„ï¼ˆç‰¹åˆ«çš„ï¼Œåªæœ‰æŸäº›ç‰¹æ®Šå®ä¾‹æ‰å…·å¤‡çš„ï¼‰ã€‚

- æŠ½è±¡è¿˜ä½“ç°åœ¨ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç±»å‹çš„å®ä¾‹çš„æ—¶å€™ï¼Œåœ¨è°ƒç”¨å…¶æ–¹æ³•æ—¶ï¼Œåªéœ€è¦å…³æ³¨æœ‰å“ªäº›å…¥å‚ï¼Œå¯ä»¥å¾—åˆ°ä»€ä¹ˆè¿”å›ï¼Œè€Œæ— éœ€å…³æ³¨å†…éƒ¨çš„å…·ä½“å®ç°æ–¹å¼æˆ–ç»†èŠ‚

























 
